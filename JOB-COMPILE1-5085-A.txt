                  CCCCCCCCCC   OOOOOOOOOOOO  MM        MM  PPPPPPPPPPP    IIIIIIIIII   LL            EEEEEEEEEEEE       11
                CCCCCCCCCCCC  OOOOOOOOOOOO  MMM      MMM  PPPPPPPPPPPP   IIIIIIIIII   LL            EEEEEEEEEEEE      111
               CC        CC  OO        OO  MMMM    MMMM  PP        PP       II       LL            EE               1111
              CC            OO        OO  MM MM  MM MM  PP        PP       II       LL            EE                 11
             CC            OO        OO  MM  MMMM  MM  PP        PP       II       LL            EE                 11
            CC            OO        OO  MM   MM   MM  PPPPPPPPPPPP       II       LL            EEEEEEEE           11
           CC            OO        OO  MM        MM  PPPPPPPPPPP        II       LL            EEEEEEEE           11
          CC            OO        OO  MM        MM  PP                 II       LL            EE                 11
         CC            OO        OO  MM        MM  PP                 II       LL            EE                 11
        CC        CC  OO        OO  MM        MM  PP                 II       LL            EE                 11
       CCCCCCCCCCCC  OOOOOOOOOOOO  MM        MM  PP             IIIIIIIIII   LLLLLLLLLLLL  EEEEEEEEEEEE   1111111111
       CCCCCCCCCC   OOOOOOOOOOOO  MM        MM  PP             IIIIIIIIII   LLLLLLLLLLLL  EEEEEEEEEEEE   1111111111



                    JJJJJJJJJJ  555555555555    00000000     8888888888   555555555555                 AAAAAAAAAA
                    JJJJJJJJJJ  555555555555   0000000000   888888888888  555555555555                AAAAAAAAAAAA
                        JJ      55            00      0000  88        88  55                          AA        AA
                        JJ      55            00     00 00  88        88  55                          AA        AA
                        JJ      55            00    00  00   88      88   55                          AA        AA
                        JJ      555555555     00   00   00    88888888    555555555                   AAAAAAAAAAAA
                        JJ      5555555555    00  00    00    88888888    5555555555                  AAAAAAAAAAAA
                        JJ               55   00 00     00   88      88            55                 AA        AA
                  JJ    JJ                55  0000      00  88        88            55                AA        AA
                  JJ    JJ                55  000       00  88        88            55                AA        AA
                  JJJJJJJJ      555555555555   0000000000   888888888888  555555555555                AA        AA
                   JJJJJJ       55555555555     00000000     8888888888   55555555555                 AA        AA


****A  START  JOB 5085  COMPILE1                        ROOM        1.22.42 PM 02 OCT 21  PRINTER1  SYS BSP1  JOB 5085  START  A****
****A  START  JOB 5085  COMPILE1                        ROOM        1.22.42 PM 02 OCT 21  PRINTER1  SYS BSP1  JOB 5085  START  A****
****A  START  JOB 5085  COMPILE1                        ROOM        1.22.42 PM 02 OCT 21  PRINTER1  SYS BSP1  JOB 5085  START  A****
****A  START  JOB 5085  COMPILE1                        ROOM        1.22.42 PM 02 OCT 21  PRINTER1  SYS BSP1  JOB 5085  START  A****
                                                J E S 2   J O B   L O G


13.22.39 JOB 5085  IEF677I WARNING MESSAGE(S) FOR JOB COMPILE1 ISSUED
13.22.39 JOB 5085  $HASP373 COMPILE1 STARTED - INIT  4 - CLASS S - SYS BSP1
13.22.39 JOB 5085  IEF403I COMPILE1 - STARTED - TIME=13.22.39
13.22.40 JOB 5085  IEFACTRT - Stepname  Procstep  Program   Retcode
13.22.40 JOB 5085  COMPILE1   STEP01    PL1L      IEMAA     RC= 0004
13.22.40 JOB 5085  COMPILE1   STEP01    LKED      IEWL      RC= 0000
13.22.40 JOB 5085  COMPILE1   STEP02    MAP3270   MAP3270   RC= 0000
13.22.41 JOB 5085  COMPILE1   STEP03    ASM       IFOX00    RC= 0000
13.22.41 JOB 5085  COMPILE1   STEP03    LKED      IEWL      RC= 0000
13.22.41 JOB 5085  COMPILE1   STEP04    ASM       IFOX00    RC= 0000
13.22.41 JOB 5085  COMPILE1   STEP04    LKED      IEWL      RC= 0000
13.22.41 JOB 5085  COMPILE1   STEP05    ASM       IFOX00    RC= 0000
13.22.41 JOB 5085  COMPILE1   STEP05    LKED      IEWL      RC= 0000
13.22.42 JOB 5085  COMPILE1   STEP06    ASM       IFOX00    RC= 0000
13.22.42 JOB 5085  COMPILE1   STEP06    LKED      IEWL      RC= 0000
13.22.42 JOB 5085  COMPILE1   STEP07    ASM       IFOX00    RC= 0000
13.22.42 JOB 5085  COMPILE1   STEP07    LKED      IEWL      RC= 0000
13.22.42 JOB 5085  IEF404I COMPILE1 - ENDED - TIME=13.22.42
13.22.42 JOB 5085  $HASP395 COMPILE1 ENDED


------ JES2 JOB STATISTICS ------


 02 OCT 21 JOB EXECUTION DATE


       107 CARDS READ


     8,475 SYSOUT PRINT RECORDS


         0 SYSOUT PUNCH RECORDS


      0.04 MINUTES EXECUTION TIME
    1     //COMPILE1 JOB 'ME',MSGLEVEL=(1,1),NOTIFY=HERC01,CLASS=S,               JOB 5085
          //            MSGCLASS=A                                                00020000
          **********************************************************************  00030000
          ***                                                                     00040000
          ***  THIS JOB COMPILES AND LINKS THE ENTIRE MAP3270 PACKAGE             00050000
          ***                                                                     00060000
          ***  THE SOFTWARE RESIDES IN 9 DATASETS.  BY DEFAULT, THE DATASETS      00070000
          ***  ARE PREFIXED WITH 'HERC01.MAP3270' ON VOLSER PUB002.               00080000
          ***                                                                     00090000
          ***    .LOADLIB CONTAINS THE EXECUTABLE CODE IS THE ONLY ONE CHANGED.   00100000
          ***                                                                     00110000
          **********************************************************************  00120000
          //MAP3270 PROC PAN=,                                                    00130000
          //             LIB='HERC01.MAP3270.LOADLIB',                            00140000
          //             SOUT='*',                                                00150000
          //             QUAL='HERC01.MAP3270'                                    00160000
          //MAP3270 EXEC PGM=MAP3270,REGION=1024K                                 00170000
          //STEPLIB  DD DSN=&LIB,DISP=SHR                                         00180000
          //         DD DSN=SYS1.PL1LIB,DISP=SHR                                  00190000
          //SYSPRINT DD SYSOUT=&SOUT                                              00200000
          //MAP      DD DSN=&QUAL..MAP(&PAN),DISP=SHR                             00210000
          //ASM      DD DSN=&QUAL..ASM(&PAN),DISP=SHR                             00220000
          //COB      DD DSN=&QUAL..COB(&PAN),DISP=SHR                             00230000
          //PL1      DD DSN=&QUAL..PLI(&PAN),DISP=SHR                             00240000
          //SYSIN    DD DSN=&QUAL..PANEL(&PAN),DISP=SHR                           00250000
          // PEND                                                                 00260000
          **********************************************************************  00270000
          ***                                                                     00280000
          ***  COMPILE THE MAP3270 PROGRAM                                        00290000
          ***                                                                     00300000
          **********************************************************************  00310000
    2     //STEP01 EXEC PL1LFCL,REGION.PL1L=1024K,                                00320000
          //  PARM.PL1L=('LOAD,NODECK,ATR,NEST,MACRO',                            00330000
          //             'XREF,SORMGIN=(2,72,1)')                                 00340000
    3     XXPL1L   EXEC  PGM=IEMAA,PARM='LOAD,NODECK',REGION=52K                  05000001
    4     XXSYSPRINT DD  SYSOUT=A                                                 10000001
    5     XXSYSLIN   DD  DSNAME=&&LOADSET,DISP=(MOD,PASS),UNIT=SYSSQ,            *15000001
          XX             SPACE=(80,(250,100))                                     20000001
    6     XXSYSUT3  DD  DSNAME=&&SYSUT3,UNIT=SYSDA,SPACE=(80,(250,250)),         *23000019
          XX             DCB=BLKSIZE=80                                           26000019
    7     XXSYSUT1   DD  DSNAME=&&SYSUT1,UNIT=SYSDA,SPACE=(1024,(60,60),,CONTIG),*30000001
          XX             SEP=(SYSUT3,SYSLIN),DCB=BLKSIZE=1024                     35000019
    8     //PL1L.SYSIN DD DSN=HERC01.MAP3270.SOURCE(MAP3270),DISP=SHR             00350000
    9     //PL1L.SYSLIB DD DSN=HERC01.MAP3270.SOURCE,DISP=SHR                     00360000
   10     //            DD DSN=HERC01.MAP3270.PLI,DISP=SHR                        00370000
   11     XXLKED   EXEC  PGM=IEWL,PARM='XREF,LIST',COND=(9,LT,PL1L),             *40000001
          XX             REGION=96K                                               45000001
   12     XXSYSLIB   DD  DSNAME=SYS1.PL1LIB,DISP=SHR                              50000001
   13     //LKED.SYSLMOD DD DSN=HERC01.MAP3270.LOADLIB(MAP3270),DISP=SHR          00380000
          **********************************************************************  00390000
          ***                                                                     00400000
          ***  COMPILE THE TTYRTN PANEL TTY3270                                   00410000
          ***                                                                     00420000
          **********************************************************************  00430000
          X/SYSLMOD  DD  DSNAME=&&GOSET(GO),DISP=(MOD,PASS),                     *55000001
          XX             UNIT=SYSDA,SPACE=(1024,(50,20,1),RLSE)                   60000001
   14     XXSYSUT1   DD  DSNAME=&&SYSUT1,UNIT=SYSDA,SPACE=(1024,(200,20)),       *65000001
          XX             SEP=(SYSLMOD,SYSLIB),DCB=BLKSIZE=1024                    70000019
   15     XXSYSPRINT DD  SYSOUT=A                                                 75000001
   16     XXSYSLIN   DD  DSNAME=&&LOADSET,DISP=(OLD,DELETE)                       80000001
   17     XX         DD  DDNAME=SYSIN                                             85000001
   18     //STEP02 EXEC MAP3270,PAN=TTY3270                                       00440000
   19     ++MAP3270 PROC PAN=,                                                    00130000
          ++             LIB='HERC01.MAP3270.LOADLIB',                            00140000
          ++             SOUT='*',                                                00150000
          ++             QUAL='HERC01.MAP3270'                                    00160000
   20     ++MAP3270 EXEC PGM=MAP3270,REGION=1024K                                 00170000
   21     ++STEPLIB  DD DSN=&LIB,DISP=SHR                                         00180000
   22     ++         DD DSN=SYS1.PL1LIB,DISP=SHR                                  00190000
   23     ++SYSPRINT DD SYSOUT=&SOUT                                              00200000
   24     ++MAP      DD DSN=&QUAL..MAP(&PAN),DISP=SHR                             00210000
   25     ++ASM      DD DSN=&QUAL..ASM(&PAN),DISP=SHR                             00220000
   26     //MAP3270.COB DD DUMMY,DCB=BLKSIZE=80                                   00450000
          +/COB      DD DSN=&QUAL..COB(&PAN),DISP=SHR                             00230000
   27     ++PL1      DD DSN=&QUAL..PLI(&PAN),DISP=SHR                             00240000
   28     ++SYSIN    DD DSN=&QUAL..PANEL(&PAN),DISP=SHR                           00250000
   29     //MAP3270.PLI DD DUMMY,DCB=BLKSIZE=80                                   00460000
          **********************************************************************  00470000
          ***                                                                     00480000
          ***  ASSEMBLE THE TTY3270 MAP                                           00490000
          ***                                                                     00500000
          **********************************************************************  00510000
   30     //STEP03 EXEC ASMFCL,PARM.ASM='OBJ,NODECK',PARM.LKED='XREF,LET,LIST'    00520000
   31     XXASMFCL   PROC MAC='SYS1.MACLIB',MAC1='SYS1.MACLIB'                    00050000
   32     XXASM      EXEC PGM=IFOX00,PARM=OBJ,REGION=128K                         00100000
   33     //ASM.SYSLIB DD DSN=HERC01.MAP3270.MACLIB,DISP=SHR,DCB=BUFSIZE=19040    00530000
          X/SYSLIB   DD   DSN=&MAC,DISP=SHR                                       00150000
   34     //           DD DSN=HERC01.MAP3270.ASM,DISP=SHR                         00540000
          X/         DD   DSN=&MAC1,DISP=SHR                                      00200000
   35     //           DD DSN=SYS1.MACLIB,DISP=SHR                                00550000
   36     //           DD DSN=SYS2.MACLIB,DISP=SHR                                00560000
   37     XXSYSUT1   DD   DSN=&&SYSUT1,UNIT=SYSSQ,SPACE=(1700,(600,100)),         00250000
          XX             SEP=(SYSLIB)                                             00300000
   38     XXSYSUT2   DD   DSN=&&SYSUT2,UNIT=SYSSQ,SPACE=(1700,(300,50)),          00350000
          XX             SEP=(SYSLIB,SYSUT1)                                      00400000
   39     XXSYSUT3   DD   DSN=&&SYSUT3,UNIT=SYSSQ,SPACE=(1700,(300,50))           00450000
   40     XXSYSPRINT DD   SYSOUT=A,DCB=BLKSIZE=1089                               00500000
   41     XXSYSPUNCH DD   SYSOUT=B                                                00550000
   42     XXSYSGO    DD   DSN=&&OBJSET,UNIT=SYSSQ,SPACE=(80,(200,50)),            00600000
          XX             DISP=(MOD,PASS)                                          00650000
   43     //ASM.SYSIN DD DSN=HERC01.MAP3270.MAP(TTY3270),DISP=SHR                 00570000
   44     XXLKED     EXEC PGM=IEWL,PARM=(XREF,LET,LIST,NCAL),REGION=128K,         00700000
          XX             COND=(8,LT,ASM)                                          00750000
   45     XXSYSLIN   DD   DSN=&&OBJSET,DISP=(OLD,DELETE)                          00800000
   46     XX         DD   DDNAME=SYSIN                                            00850000
   47     //LKED.SYSLMOD DD DSN=HERC01.MAP3270.LOADLIB(TTY3270),DISP=SHR          00580000
          **********************************************************************  00590000
          ***                                                                     00600000
          ***  ASSEMBLE THE MAP3270 INTERFACE                                     00610000
          ***                                                                     00620000
          **********************************************************************  00630000
          X/SYSLMOD  DD   DSN=&&GOSET(GO),UNIT=SYSDA,SPACE=(1024,(50,20,1)),      00900000
          XX             DISP=(MOD,PASS)                                          00950000
   48     XXSYSUT1   DD   DSN=&&SYSUT1,UNIT=(SYSDA,SEP=(SYSLIN,SYSLMOD)),         01000000
          XX             SPACE=(1024,(50,20))                                     01050000
   49     XXSYSPRINT DD   SYSOUT=A                                                01100000
   50     //STEP04 EXEC ASMFCL,PARM.ASM='OBJ,NODECK',PARM.LKED='XREF,LET,LIST'    00640000
   51     XXASMFCL   PROC MAC='SYS1.MACLIB',MAC1='SYS1.MACLIB'                    00050000
   52     XXASM      EXEC PGM=IFOX00,PARM=OBJ,REGION=128K                         00100000
   53     //ASM.SYSLIB DD DSN=HERC01.MAP3270.MACLIB,DISP=SHR,DCB=BUFSIZE=19040    00650000
          X/SYSLIB   DD   DSN=&MAC,DISP=SHR                                       00150000
   54     //           DD DSN=HERC01.MAP3270.ASM,DISP=SHR                         00660000
          X/         DD   DSN=&MAC1,DISP=SHR                                      00200000
   55     //           DD DSN=SYS1.MACLIB,DISP=SHR                                00670000
   56     //           DD DSN=SYS2.MACLIB,DISP=SHR                                00680000
   57     XXSYSUT1   DD   DSN=&&SYSUT1,UNIT=SYSSQ,SPACE=(1700,(600,100)),         00250000
          XX             SEP=(SYSLIB)                                             00300000
   58     XXSYSUT2   DD   DSN=&&SYSUT2,UNIT=SYSSQ,SPACE=(1700,(300,50)),          00350000
          XX             SEP=(SYSLIB,SYSUT1)                                      00400000
   59     XXSYSUT3   DD   DSN=&&SYSUT3,UNIT=SYSSQ,SPACE=(1700,(300,50))           00450000
   60     XXSYSPRINT DD   SYSOUT=A,DCB=BLKSIZE=1089                               00500000
   61     XXSYSPUNCH DD   SYSOUT=B                                                00550000
   62     XXSYSGO    DD   DSN=&&OBJSET,UNIT=SYSSQ,SPACE=(80,(200,50)),            00600000
          XX             DISP=(MOD,PASS)                                          00650000
   63     //ASM.SYSIN DD *                                                        00690000
   64     XXLKED     EXEC PGM=IEWL,PARM=(XREF,LET,LIST,NCAL),REGION=128K,         00700000
          XX             COND=(8,LT,ASM)                                          00750000
   65     XXSYSLIN   DD   DSN=&&OBJSET,DISP=(OLD,DELETE)                          00800000
   66     XX         DD   DDNAME=SYSIN                                            00850000
   67     //LKED.SYSLMOD DD DSN=HERC01.MAP3270.LOADLIB(T3270IO),DISP=SHR          00720000
          ***                                                                     00730000
          X/SYSLMOD  DD   DSN=&&GOSET(GO),UNIT=SYSDA,SPACE=(1024,(50,20,1)),      00900000
          XX             DISP=(MOD,PASS)                                          00950000
   68     XXSYSUT1   DD   DSN=&&SYSUT1,UNIT=(SYSDA,SEP=(SYSLIN,SYSLMOD)),         01000000
          XX             SPACE=(1024,(50,20))                                     01050000
   69     XXSYSPRINT DD   SYSOUT=A                                                01100000
   70     //STEP05 EXEC ASMFCL,PARM.ASM='OBJ,NODECK',PARM.LKED='XREF,LET,LIST'    00740000
   71     XXASMFCL   PROC MAC='SYS1.MACLIB',MAC1='SYS1.MACLIB'                    00050000
   72     XXASM      EXEC PGM=IFOX00,PARM=OBJ,REGION=128K                         00100000
   73     //ASM.SYSLIB DD DSN=HERC01.MAP3270.MACLIB,DISP=SHR,DCB=BUFSIZE=19040    00750000
          X/SYSLIB   DD   DSN=&MAC,DISP=SHR                                       00150000
   74     //           DD DSN=HERC01.MAP3270.ASM,DISP=SHR                         00760000
          X/         DD   DSN=&MAC1,DISP=SHR                                      00200000
   75     //           DD DSN=SYS1.MACLIB,DISP=SHR                                00770000
   76     //           DD DSN=SYS2.MACLIB,DISP=SHR                                00780000
   77     XXSYSUT1   DD   DSN=&&SYSUT1,UNIT=SYSSQ,SPACE=(1700,(600,100)),         00250000
          XX             SEP=(SYSLIB)                                             00300000
   78     XXSYSUT2   DD   DSN=&&SYSUT2,UNIT=SYSSQ,SPACE=(1700,(300,50)),          00350000
          XX             SEP=(SYSLIB,SYSUT1)                                      00400000
   79     XXSYSUT3   DD   DSN=&&SYSUT3,UNIT=SYSSQ,SPACE=(1700,(300,50))           00450000
   80     XXSYSPRINT DD   SYSOUT=A,DCB=BLKSIZE=1089                               00500000
   81     XXSYSPUNCH DD   SYSOUT=B                                                00550000
   82     XXSYSGO    DD   DSN=&&OBJSET,UNIT=SYSSQ,SPACE=(80,(200,50)),            00600000
          XX             DISP=(MOD,PASS)                                          00650000
   83     //ASM.SYSIN DD *                                                        00790000
   84     XXLKED     EXEC PGM=IEWL,PARM=(XREF,LET,LIST,NCAL),REGION=128K,         00700000
          XX             COND=(8,LT,ASM)                                          00750000
   85     XXSYSLIN   DD   DSN=&&OBJSET,DISP=(OLD,DELETE)                          00800000
   86     XX         DD   DDNAME=SYSIN                                            00850000
   87     //LKED.SYSLMOD DD DSN=HERC01.MAP3270.LOADLIB(TTYRTN),DISP=SHR           00820000
          **********************************************************************  00830000
          ***                                                                     00840000
          ***  ASSEMBLE THE MAP3270 INTERFACE FOR PL/I (F).                       00850000
          ***  YOU MAY SKIP STEP12 AND STEP13 IF YOU DO NOT PLAN ON USING PL/I    00860000
          ***                                                                     00870000
          **********************************************************************  00880000
          X/SYSLMOD  DD   DSN=&&GOSET(GO),UNIT=SYSDA,SPACE=(1024,(50,20,1)),      00900000
          XX             DISP=(MOD,PASS)                                          00950000
   88     XXSYSUT1   DD   DSN=&&SYSUT1,UNIT=(SYSDA,SEP=(SYSLIN,SYSLMOD)),         01000000
          XX             SPACE=(1024,(50,20))                                     01050000
   89     XXSYSPRINT DD   SYSOUT=A                                                01100000
   90     //STEP06 EXEC ASMFCL,PARM.ASM='OBJ,NODECK',PARM.LKED='XREF,LET,LIST'    00890000
   91     XXASMFCL   PROC MAC='SYS1.MACLIB',MAC1='SYS1.MACLIB'                    00050000
   92     XXASM      EXEC PGM=IFOX00,PARM=OBJ,REGION=128K                         00100000
   93     //ASM.SYSLIB DD DSN=HERC01.MAP3270.MACLIB,DISP=SHR,DCB=BUFSIZE=19040    00900000
          X/SYSLIB   DD   DSN=&MAC,DISP=SHR                                       00150000
   94     //           DD DSN=HERC01.MAP3270.ASM,DISP=SHR                         00910000
          X/         DD   DSN=&MAC1,DISP=SHR                                      00200000
   95     //           DD DSN=SYS1.MACLIB,DISP=SHR                                00920000
   96     //           DD DSN=SYS2.MACLIB,DISP=SHR                                00930000
   97     XXSYSUT1   DD   DSN=&&SYSUT1,UNIT=SYSSQ,SPACE=(1700,(600,100)),         00250000
          XX             SEP=(SYSLIB)                                             00300000
   98     XXSYSUT2   DD   DSN=&&SYSUT2,UNIT=SYSSQ,SPACE=(1700,(300,50)),          00350000
          XX             SEP=(SYSLIB,SYSUT1)                                      00400000
   99     XXSYSUT3   DD   DSN=&&SYSUT3,UNIT=SYSSQ,SPACE=(1700,(300,50))           00450000
  100     XXSYSPRINT DD   SYSOUT=A,DCB=BLKSIZE=1089                               00500000
  101     XXSYSPUNCH DD   SYSOUT=B                                                00550000
  102     XXSYSGO    DD   DSN=&&OBJSET,UNIT=SYSSQ,SPACE=(80,(200,50)),            00600000
          XX             DISP=(MOD,PASS)                                          00650000
  103     //ASM.SYSIN DD *                                                        00940000
  104     XXLKED     EXEC PGM=IEWL,PARM=(XREF,LET,LIST,NCAL),REGION=128K,         00700000
          XX             COND=(8,LT,ASM)                                          00750000
  105     XXSYSLIN   DD   DSN=&&OBJSET,DISP=(OLD,DELETE)                          00800000
  106     XX         DD   DDNAME=SYSIN                                            00850000
  107     //LKED.SYSLMOD DD DSN=HERC01.MAP3270.LOADLIB(T3270IOP),DISP=SHR         00970000
          ***                                                                     00980000
          X/SYSLMOD  DD   DSN=&&GOSET(GO),UNIT=SYSDA,SPACE=(1024,(50,20,1)),      00900000
          XX             DISP=(MOD,PASS)                                          00950000
  108     XXSYSUT1   DD   DSN=&&SYSUT1,UNIT=(SYSDA,SEP=(SYSLIN,SYSLMOD)),         01000000
          XX             SPACE=(1024,(50,20))                                     01050000
  109     XXSYSPRINT DD   SYSOUT=A                                                01100000
  110     //STEP07 EXEC ASMFCL,PARM.ASM='OBJ,NODECK',PARM.LKED='XREF,LET,LIST'    00990000
  111     XXASMFCL   PROC MAC='SYS1.MACLIB',MAC1='SYS1.MACLIB'                    00050000
  112     XXASM      EXEC PGM=IFOX00,PARM=OBJ,REGION=128K                         00100000
  113     //ASM.SYSLIB DD DSN=HERC01.MAP3270.MACLIB,DISP=SHR,DCB=BUFSIZE=19040    01000000
          X/SYSLIB   DD   DSN=&MAC,DISP=SHR                                       00150000
  114     //           DD DSN=HERC01.MAP3270.ASM,DISP=SHR                         01010000
          X/         DD   DSN=&MAC1,DISP=SHR                                      00200000
  115     //           DD DSN=SYS1.MACLIB,DISP=SHR                                01020000
  116     //           DD DSN=SYS2.MACLIB,DISP=SHR                                01030000
  117     XXSYSUT1   DD   DSN=&&SYSUT1,UNIT=SYSSQ,SPACE=(1700,(600,100)),         00250000
          XX             SEP=(SYSLIB)                                             00300000
  118     XXSYSUT2   DD   DSN=&&SYSUT2,UNIT=SYSSQ,SPACE=(1700,(300,50)),          00350000
          XX             SEP=(SYSLIB,SYSUT1)                                      00400000
  119     XXSYSUT3   DD   DSN=&&SYSUT3,UNIT=SYSSQ,SPACE=(1700,(300,50))           00450000
  120     XXSYSPRINT DD   SYSOUT=A,DCB=BLKSIZE=1089                               00500000
  121     XXSYSPUNCH DD   SYSOUT=B                                                00550000
  122     XXSYSGO    DD   DSN=&&OBJSET,UNIT=SYSSQ,SPACE=(80,(200,50)),            00600000
          XX             DISP=(MOD,PASS)                                          00650000
  123     //ASM.SYSIN DD *                                                        01040000
  124     XXLKED     EXEC PGM=IEWL,PARM=(XREF,LET,LIST,NCAL),REGION=128K,         00700000
          XX             COND=(8,LT,ASM)                                          00750000
  125     XXSYSLIN   DD   DSN=&&OBJSET,DISP=(OLD,DELETE)                          00800000
  126     XX         DD   DDNAME=SYSIN                                            00850000
  127     //LKED.SYSLMOD DD DSN=HERC01.MAP3270.LOADLIB(TTYRTNP),DISP=SHR          01070000
          X/SYSLMOD  DD   DSN=&&GOSET(GO),UNIT=SYSDA,SPACE=(1024,(50,20,1)),      00900000
          XX             DISP=(MOD,PASS)                                          00950000
  128     XXSYSUT1   DD   DSN=&&SYSUT1,UNIT=(SYSDA,SEP=(SYSLIN,SYSLMOD)),         01000000
          XX             SPACE=(1024,(50,20))                                     01050000
  129     XXSYSPRINT DD   SYSOUT=A                                                01100000
 STMT NO. MESSAGE
-
   21     IEF653I SUBSTITUTION JCL - DSN=HERC01.MAP3270.LOADLIB,DISP=SHR
   23     IEF653I SUBSTITUTION JCL - SYSOUT=*
   24     IEF653I SUBSTITUTION JCL - DSN=HERC01.MAP3270.MAP(TTY3270),DISP=SHR
   25     IEF653I SUBSTITUTION JCL - DSN=HERC01.MAP3270.ASM(TTY3270),DISP=SHR
   26     IEF653I SUBSTITUTION JCL - DSN=HERC01.MAP3270.COB(TTY3270),DISP=SHR
   27     IEF653I SUBSTITUTION JCL - DSN=HERC01.MAP3270.PLI(TTY3270),DISP=SHR
   28     IEF653I SUBSTITUTION JCL - DSN=HERC01.MAP3270.PANEL(TTY3270),DISP=SHR
   33     IEF653I SUBSTITUTION JCL - DSN=SYS1.MACLIB,DISP=SHR
   34     IEF653I SUBSTITUTION JCL - DSN=SYS1.MACLIB,DISP=SHR
   53     IEF653I SUBSTITUTION JCL - DSN=SYS1.MACLIB,DISP=SHR
   54     IEF653I SUBSTITUTION JCL - DSN=SYS1.MACLIB,DISP=SHR
   73     IEF653I SUBSTITUTION JCL - DSN=SYS1.MACLIB,DISP=SHR
   74     IEF653I SUBSTITUTION JCL - DSN=SYS1.MACLIB,DISP=SHR
   93     IEF653I SUBSTITUTION JCL - DSN=SYS1.MACLIB,DISP=SHR
   94     IEF653I SUBSTITUTION JCL - DSN=SYS1.MACLIB,DISP=SHR
  113     IEF653I SUBSTITUTION JCL - DSN=SYS1.MACLIB,DISP=SHR
  114     IEF653I SUBSTITUTION JCL - DSN=SYS1.MACLIB,DISP=SHR
   18     IEF686I DDNAME REFERRED TO ON DDNAME KEYWORD IN PRIOR STEP WAS NOT RESOLVED
   50     IEF686I DDNAME REFERRED TO ON DDNAME KEYWORD IN PRIOR STEP WAS NOT RESOLVED
   70     IEF686I DDNAME REFERRED TO ON DDNAME KEYWORD IN PRIOR STEP WAS NOT RESOLVED
   90     IEF686I DDNAME REFERRED TO ON DDNAME KEYWORD IN PRIOR STEP WAS NOT RESOLVED
  110     IEF686I DDNAME REFERRED TO ON DDNAME KEYWORD IN PRIOR STEP WAS NOT RESOLVED
  129     IEF686I DDNAME REFERRED TO ON DDNAME KEYWORD IN PRIOR STEP WAS NOT RESOLVED
IEF236I ALLOC. FOR COMPILE1 PL1L STEP01
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF237I 14A  ALLOCATED TO SYSLIN
IEF237I 149  ALLOCATED TO SYSUT3
IEF237I 180  ALLOCATED TO SYSUT1
IEF237I 280  ALLOCATED TO SYSIN
IEF237I 240  ALLOCATED TO SYS00002
IEF237I 280  ALLOCATED TO SYSLIB
IEF237I 280  ALLOCATED TO
IEF142I COMPILE1 PL1L STEP01 - STEP WAS EXECUTED - COND CODE 0004
IEF285I   JES2.JOB05085.SO0105                         SYSOUT
IEF285I   SYS21275.T132239.RA000.COMPILE1.LOADSET      PASSED        *----1,069
IEF285I   VOL SER NOS= SMP002.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT3       DELETED       *----1,643
IEF285I   VOL SER NOS= SMP001.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *--------0
IEF285I   VOL SER NOS= WORK02.
IEF285I   HERC01.MAP3270.SOURCE                        KEPT          *------286
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   HERC01.MAP3270.SOURCE                        KEPT          *-------46
IEF285I   VOL SER NOS= PUB002.
IEF285I   HERC01.MAP3270.PLI                           KEPT          *--------0
IEF285I   VOL SER NOS= PUB002.
IEF373I STEP /PL1L    / START 21275.1322
IEF374I STEP /PL1L    / STOP  21275.1322 CPU    0MIN 00.73SEC SRB    0MIN 00.14SEC VIRT  1036K SYS   240K
************************************************************************************************************************************
*     1. Jobstep of job: COMPILE1    Stepname: PL1L        Program name: IEMAA      Executed on 02.10.21 from 13.22.39 to 13.22.40 *
*         elapsed time  24:00:00,99                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,87               Virtual Storage used:   1036K         Page-out:      0                           *
*           corr. CPU:  00:00:00,87   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      0                                                                           *
*     DMY.......0 14A....1069 149....1643 180.......0 280.....286 240.......0 280......46 280.......0                              *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          1,45                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 LKED STEP01
IEF237I 148  ALLOCATED TO SYSLIB
IEF237I 280  ALLOCATED TO SYSLMOD
IEF237I 240  ALLOCATED TO SYS00004
IEF237I 190  ALLOCATED TO SYSUT1
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF237I 14A  ALLOCATED TO SYSLIN
IEF237I DMY  ALLOCATED TO
IEF142I COMPILE1 LKED STEP01 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   SYS1.PL1LIB                                  KEPT          *------235
IEF285I   VOL SER NOS= MVSRES.
IEF285I   HERC01.MAP3270.LOADLIB                       KEPT          *------171
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *------154
IEF285I   VOL SER NOS= WORK03.
IEF285I   JES2.JOB05085.SO0106                         SYSOUT
IEF285I   SYS21275.T132239.RA000.COMPILE1.LOADSET      DELETED       *----1,070
IEF285I   VOL SER NOS= SMP002.
IEF373I STEP /LKED    / START 21275.1322
IEF374I STEP /LKED    / STOP  21275.1322 CPU    0MIN 00.17SEC SRB    0MIN 00.05SEC VIRT    96K SYS   248K
************************************************************************************************************************************
*     2. Jobstep of job: COMPILE1    Stepname: LKED        Program name: IEWL       Executed on 02.10.21 from 13.22.40 to 13.22.40 *
*         elapsed time  24:00:00,28                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,22               Virtual Storage used:     96K         Page-out:      0                           *
*           corr. CPU:  00:00:00,22   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      0                                                                           *
*     148.....235 280.....171 240.......0 190.....154 DMY.......0 14A....1070 DMY.......0                                          *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,36                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 MAP3270 STEP02
IEF237I 280  ALLOCATED TO STEPLIB
IEF237I 148  ALLOCATED TO
IEF237I 240  ALLOCATED TO SYS00006
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF237I 280  ALLOCATED TO MAP
IEF237I 280  ALLOCATED TO ASM
IEF237I DMY  ALLOCATED TO COB
IEF237I 280  ALLOCATED TO PL1
IEF237I 280  ALLOCATED TO SYSIN
IEF237I DMY  ALLOCATED TO PLI
IEF142I COMPILE1 MAP3270 STEP02 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   HERC01.MAP3270.LOADLIB                       KEPT          *--------0
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.PL1LIB                                  KEPT          *--------0
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   JES2.JOB05085.SO0107                         SYSOUT
IEF285I   HERC01.MAP3270.MAP                           KEPT          *--------7
IEF285I   VOL SER NOS= PUB002.
IEF285I   HERC01.MAP3270.ASM                           KEPT          *--------6
IEF285I   VOL SER NOS= PUB002.
IEF285I   HERC01.MAP3270.PLI                           KEPT          *-------32
IEF285I   VOL SER NOS= PUB002.
IEF285I   HERC01.MAP3270.PANEL                         KEPT          *--------2
IEF285I   VOL SER NOS= PUB002.
IEF373I STEP /MAP3270 / START 21275.1322
IEF374I STEP /MAP3270 / STOP  21275.1322 CPU    0MIN 00.05SEC SRB    0MIN 00.01SEC VIRT   284K SYS   252K
************************************************************************************************************************************
*     3. Jobstep of job: COMPILE1    Stepname: MAP3270     Program name: MAP3270    Executed on 02.10.21 from 13.22.40 to 13.22.40 *
*         elapsed time  24:00:00,09                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,06               Virtual Storage used:    284K         Page-out:      0                           *
*           corr. CPU:  00:00:00,06   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      0                                                                           *
*     280.......0 148.......0 240.......0 DMY.......0 280.......7 280.......6 DMY.......0 280......32 280.......2 DMY.......0      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,10                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 ASM STEP03
IEF237I 280  ALLOCATED TO SYSLIB
IEF237I 280  ALLOCATED TO
IEF237I 148  ALLOCATED TO
IEF237I 148  ALLOCATED TO
IEF237I 240  ALLOCATED TO SYS00008
IEF237I 180  ALLOCATED TO SYSUT1
IEF237I 14A  ALLOCATED TO SYSUT2
IEF237I 149  ALLOCATED TO SYSUT3
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF237I JES2 ALLOCATED TO SYSPUNCH
IEF237I 140  ALLOCATED TO SYSGO
IEF237I 280  ALLOCATED TO SYSIN
IEF142I COMPILE1 ASM STEP03 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   HERC01.MAP3270.MACLIB                        KEPT          *-------35
IEF285I   VOL SER NOS= PUB002.
IEF285I   HERC01.MAP3270.ASM                           KEPT          *--------0
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.MACLIB                                  KEPT          *--------0
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS2.MACLIB                                  KEPT          *--------0
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *----1,818
IEF285I   VOL SER NOS= WORK02.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT2       DELETED       *-------17
IEF285I   VOL SER NOS= SMP002.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT3       DELETED       *-------10
IEF285I   VOL SER NOS= SMP001.
IEF285I   JES2.JOB05085.SO0108                         SYSOUT
IEF285I   JES2.JOB05085.SO0109                         SYSOUT
IEF285I   SYS21275.T132239.RA000.COMPILE1.OBJSET       PASSED        *-------45
IEF285I   VOL SER NOS= WORK00.
IEF285I   HERC01.MAP3270.MAP                           KEPT          *--------5
IEF285I   VOL SER NOS= PUB002.
IEF373I STEP /ASM     / START 21275.1322
IEF374I STEP /ASM     / STOP  21275.1322 CPU    0MIN 00.26SEC SRB    0MIN 00.07SEC VIRT   128K SYS   244K
************************************************************************************************************************************
*     4. Jobstep of job: COMPILE1    Stepname: ASM         Program name: IFOX00     Executed on 02.10.21 from 13.22.40 to 13.22.41 *
*         elapsed time  24:00:00,41                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,33               Virtual Storage used:    128K         Page-out:      0                           *
*           corr. CPU:  00:00:00,33   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      0                                                                           *
*     280......35 280.......0 148.......0 148.......0 240.......0 180....1818 14A......17 149......10 DMY.......0 DMY.......0      *
*     140......45 280.......5                                                                                                      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,55                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 LKED STEP03
IEF237I 140  ALLOCATED TO SYSLIN
IEF237I DMY  ALLOCATED TO
IEF237I 280  ALLOCATED TO SYSLMOD
IEF237I 240  ALLOCATED TO SYS00010
IEF237I 14A  ALLOCATED TO SYSUT1
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF142I COMPILE1 LKED STEP03 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   SYS21275.T132239.RA000.COMPILE1.OBJSET       DELETED       *-------46
IEF285I   VOL SER NOS= WORK00.
IEF285I   HERC01.MAP3270.LOADLIB                       KEPT          *-------10
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *--------0
IEF285I   VOL SER NOS= SMP002.
IEF285I   JES2.JOB05085.SO0110                         SYSOUT
IEF373I STEP /LKED    / START 21275.1322
IEF374I STEP /LKED    / STOP  21275.1322 CPU    0MIN 00.02SEC SRB    0MIN 00.00SEC VIRT   128K SYS   248K
************************************************************************************************************************************
*     5. Jobstep of job: COMPILE1    Stepname: LKED        Program name: IEWL       Executed on 02.10.21 from 13.22.41 to 13.22.41 *
*         elapsed time  24:00:00,04                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,02               Virtual Storage used:    128K         Page-out:      0                           *
*           corr. CPU:  00:00:00,02   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      0                                                                           *
*     140......46 DMY.......0 280......10 240.......0 14A.......0 DMY.......0                                                      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,03                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 ASM STEP04
IEF237I 280  ALLOCATED TO SYSLIB
IEF237I 280  ALLOCATED TO
IEF237I 148  ALLOCATED TO
IEF237I 148  ALLOCATED TO
IEF237I 240  ALLOCATED TO SYS00012
IEF237I 149  ALLOCATED TO SYSUT1
IEF237I 190  ALLOCATED TO SYSUT2
IEF237I 14A  ALLOCATED TO SYSUT3
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF237I JES2 ALLOCATED TO SYSPUNCH
IEF237I 140  ALLOCATED TO SYSGO
IEF237I JES2 ALLOCATED TO SYSIN
IEF142I COMPILE1 ASM STEP04 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   HERC01.MAP3270.MACLIB                        KEPT          *-------39
IEF285I   VOL SER NOS= PUB002.
IEF285I   HERC01.MAP3270.ASM                           KEPT          *--------0
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.MACLIB                                  KEPT          *-------20
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS2.MACLIB                                  KEPT          *--------0
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *------150
IEF285I   VOL SER NOS= SMP001.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT2       DELETED       *-------23
IEF285I   VOL SER NOS= WORK03.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT3       DELETED       *-------12
IEF285I   VOL SER NOS= SMP002.
IEF285I   JES2.JOB05085.SO0111                         SYSOUT
IEF285I   JES2.JOB05085.SO0112                         SYSOUT
IEF285I   SYS21275.T132239.RA000.COMPILE1.OBJSET       PASSED        *-------25
IEF285I   VOL SER NOS= WORK00.
IEF285I   JES2.JOB05085.SI0101                         SYSIN
IEF373I STEP /ASM     / START 21275.1322
IEF374I STEP /ASM     / STOP  21275.1322 CPU    0MIN 00.11SEC SRB    0MIN 00.01SEC VIRT   128K SYS   248K
************************************************************************************************************************************
*     6. Jobstep of job: COMPILE1    Stepname: ASM         Program name: IFOX00     Executed on 02.10.21 from 13.22.41 to 13.22.41 *
*         elapsed time  24:00:00,16                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,12               Virtual Storage used:    128K         Page-out:      0                           *
*           corr. CPU:  00:00:00,12   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      2                                                                           *
*     280......39 280.......0 148......20 148.......0 240.......0 149.....150 190......23 14A......12 DMY.......0 DMY.......0      *
*     140......25 DMY.......0                                                                                                      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,20                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 LKED STEP04
IEF237I 140  ALLOCATED TO SYSLIN
IEF237I DMY  ALLOCATED TO
IEF237I 280  ALLOCATED TO SYSLMOD
IEF237I 240  ALLOCATED TO SYS00014
IEF237I 149  ALLOCATED TO SYSUT1
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF142I COMPILE1 LKED STEP04 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   SYS21275.T132239.RA000.COMPILE1.OBJSET       DELETED       *-------26
IEF285I   VOL SER NOS= WORK00.
IEF285I   HERC01.MAP3270.LOADLIB                       KEPT          *--------9
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *--------0
IEF285I   VOL SER NOS= SMP001.
IEF285I   JES2.JOB05085.SO0113                         SYSOUT
IEF373I STEP /LKED    / START 21275.1322
IEF374I STEP /LKED    / STOP  21275.1322 CPU    0MIN 00.02SEC SRB    0MIN 00.00SEC VIRT   128K SYS   248K
************************************************************************************************************************************
*     7. Jobstep of job: COMPILE1    Stepname: LKED        Program name: IEWL       Executed on 02.10.21 from 13.22.41 to 13.22.41 *
*         elapsed time  24:00:00,03                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,02               Virtual Storage used:    128K         Page-out:      0                           *
*           corr. CPU:  00:00:00,02   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      0                                                                           *
*     140......26 DMY.......0 280.......9 240.......0 149.......0 DMY.......0                                                      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,03                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 ASM STEP05
IEF237I 280  ALLOCATED TO SYSLIB
IEF237I 280  ALLOCATED TO
IEF237I 148  ALLOCATED TO
IEF237I 148  ALLOCATED TO
IEF237I 240  ALLOCATED TO SYS00016
IEF237I 14A  ALLOCATED TO SYSUT1
IEF237I 140  ALLOCATED TO SYSUT2
IEF237I 190  ALLOCATED TO SYSUT3
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF237I JES2 ALLOCATED TO SYSPUNCH
IEF237I 149  ALLOCATED TO SYSGO
IEF237I JES2 ALLOCATED TO SYSIN
IEF142I COMPILE1 ASM STEP05 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   HERC01.MAP3270.MACLIB                        KEPT          *-------43
IEF285I   VOL SER NOS= PUB002.
IEF285I   HERC01.MAP3270.ASM                           KEPT          *--------0
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.MACLIB                                  KEPT          *-------15
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS2.MACLIB                                  KEPT          *--------0
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *------120
IEF285I   VOL SER NOS= SMP002.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT2       DELETED       *-------21
IEF285I   VOL SER NOS= WORK00.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT3       DELETED       *-------12
IEF285I   VOL SER NOS= WORK03.
IEF285I   JES2.JOB05085.SO0114                         SYSOUT
IEF285I   JES2.JOB05085.SO0115                         SYSOUT
IEF285I   SYS21275.T132239.RA000.COMPILE1.OBJSET       PASSED        *-------78
IEF285I   VOL SER NOS= SMP001.
IEF285I   JES2.JOB05085.SI0102                         SYSIN
IEF373I STEP /ASM     / START 21275.1322
IEF374I STEP /ASM     / STOP  21275.1322 CPU    0MIN 00.10SEC SRB    0MIN 00.01SEC VIRT   128K SYS   252K
************************************************************************************************************************************
*     8. Jobstep of job: COMPILE1    Stepname: ASM         Program name: IFOX00     Executed on 02.10.21 from 13.22.41 to 13.22.41 *
*         elapsed time  24:00:00,16                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,11               Virtual Storage used:    128K         Page-out:      0                           *
*           corr. CPU:  00:00:00,11   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      2                                                                           *
*     280......43 280.......0 148......15 148.......0 240.......0 14A.....120 140......21 190......12 DMY.......0 DMY.......0      *
*     149......78 DMY.......0                                                                                                      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,18                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 LKED STEP05
IEF237I 149  ALLOCATED TO SYSLIN
IEF237I DMY  ALLOCATED TO
IEF237I 280  ALLOCATED TO SYSLMOD
IEF237I 240  ALLOCATED TO SYS00018
IEF237I 190  ALLOCATED TO SYSUT1
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF142I COMPILE1 LKED STEP05 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   SYS21275.T132239.RA000.COMPILE1.OBJSET       DELETED       *-------79
IEF285I   VOL SER NOS= SMP001.
IEF285I   HERC01.MAP3270.LOADLIB                       KEPT          *-------10
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *--------0
IEF285I   VOL SER NOS= WORK03.
IEF285I   JES2.JOB05085.SO0116                         SYSOUT
IEF373I STEP /LKED    / START 21275.1322
IEF374I STEP /LKED    / STOP  21275.1322 CPU    0MIN 00.02SEC SRB    0MIN 00.00SEC VIRT   128K SYS   252K
************************************************************************************************************************************
*     9. Jobstep of job: COMPILE1    Stepname: LKED        Program name: IEWL       Executed on 02.10.21 from 13.22.41 to 13.22.41 *
*         elapsed time  24:00:00,05                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,02               Virtual Storage used:    128K         Page-out:      0                           *
*           corr. CPU:  00:00:00,02   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      0                                                                           *
*     149......79 DMY.......0 280......10 240.......0 190.......0 DMY.......0                                                      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,03                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 ASM STEP06
IEF237I 280  ALLOCATED TO SYSLIB
IEF237I 280  ALLOCATED TO
IEF237I 148  ALLOCATED TO
IEF237I 148  ALLOCATED TO
IEF237I 240  ALLOCATED TO SYS00020
IEF237I 149  ALLOCATED TO SYSUT1
IEF237I 180  ALLOCATED TO SYSUT2
IEF237I 14A  ALLOCATED TO SYSUT3
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF237I JES2 ALLOCATED TO SYSPUNCH
IEF237I 140  ALLOCATED TO SYSGO
IEF237I JES2 ALLOCATED TO SYSIN
IEF142I COMPILE1 ASM STEP06 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   HERC01.MAP3270.MACLIB                        KEPT          *-------39
IEF285I   VOL SER NOS= PUB002.
IEF285I   HERC01.MAP3270.ASM                           KEPT          *--------0
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.MACLIB                                  KEPT          *-------20
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS2.MACLIB                                  KEPT          *--------0
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *------150
IEF285I   VOL SER NOS= SMP001.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT2       DELETED       *-------23
IEF285I   VOL SER NOS= WORK02.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT3       DELETED       *-------12
IEF285I   VOL SER NOS= SMP002.
IEF285I   JES2.JOB05085.SO0117                         SYSOUT
IEF285I   JES2.JOB05085.SO0118                         SYSOUT
IEF285I   SYS21275.T132239.RA000.COMPILE1.OBJSET       PASSED        *-------26
IEF285I   VOL SER NOS= WORK00.
IEF285I   JES2.JOB05085.SI0103                         SYSIN
IEF373I STEP /ASM     / START 21275.1322
IEF374I STEP /ASM     / STOP  21275.1322 CPU    0MIN 00.12SEC SRB    0MIN 00.01SEC VIRT   128K SYS   252K
************************************************************************************************************************************
*    10. Jobstep of job: COMPILE1    Stepname: ASM         Program name: IFOX00     Executed on 02.10.21 from 13.22.41 to 13.22.42 *
*         elapsed time  24:00:00,18                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,13               Virtual Storage used:    128K         Page-out:      0                           *
*           corr. CPU:  00:00:00,13   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      2                                                                           *
*     280......39 280.......0 148......20 148.......0 240.......0 149.....150 180......23 14A......12 DMY.......0 DMY.......0      *
*     140......26 DMY.......0                                                                                                      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,21                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 LKED STEP06
IEF237I 140  ALLOCATED TO SYSLIN
IEF237I DMY  ALLOCATED TO
IEF237I 280  ALLOCATED TO SYSLMOD
IEF237I 240  ALLOCATED TO SYS00022
IEF237I 14A  ALLOCATED TO SYSUT1
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF142I COMPILE1 LKED STEP06 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   SYS21275.T132239.RA000.COMPILE1.OBJSET       DELETED       *-------27
IEF285I   VOL SER NOS= WORK00.
IEF285I   HERC01.MAP3270.LOADLIB                       KEPT          *-------11
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *--------0
IEF285I   VOL SER NOS= SMP002.
IEF285I   JES2.JOB05085.SO0119                         SYSOUT
IEF373I STEP /LKED    / START 21275.1322
IEF374I STEP /LKED    / STOP  21275.1322 CPU    0MIN 00.02SEC SRB    0MIN 00.00SEC VIRT   128K SYS   252K
************************************************************************************************************************************
*    11. Jobstep of job: COMPILE1    Stepname: LKED        Program name: IEWL       Executed on 02.10.21 from 13.22.42 to 13.22.42 *
*         elapsed time  24:00:00,04                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,02               Virtual Storage used:    128K         Page-out:      0                           *
*           corr. CPU:  00:00:00,02   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      0                                                                           *
*     140......27 DMY.......0 280......11 240.......0 14A.......0 DMY.......0                                                      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,03                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 ASM STEP07
IEF237I 280  ALLOCATED TO SYSLIB
IEF237I 280  ALLOCATED TO
IEF237I 148  ALLOCATED TO
IEF237I 148  ALLOCATED TO
IEF237I 240  ALLOCATED TO SYS00024
IEF237I 170  ALLOCATED TO SYSUT1
IEF237I 190  ALLOCATED TO SYSUT2
IEF237I 149  ALLOCATED TO SYSUT3
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF237I JES2 ALLOCATED TO SYSPUNCH
IEF237I 180  ALLOCATED TO SYSGO
IEF237I JES2 ALLOCATED TO SYSIN
IEF142I COMPILE1 ASM STEP07 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   HERC01.MAP3270.MACLIB                        KEPT          *-------43
IEF285I   VOL SER NOS= PUB002.
IEF285I   HERC01.MAP3270.ASM                           KEPT          *--------0
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.MACLIB                                  KEPT          *-------15
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS2.MACLIB                                  KEPT          *--------0
IEF285I   VOL SER NOS= MVSRES.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *------119
IEF285I   VOL SER NOS= WORK01.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT2       DELETED       *-------21
IEF285I   VOL SER NOS= WORK03.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT3       DELETED       *-------10
IEF285I   VOL SER NOS= SMP001.
IEF285I   JES2.JOB05085.SO0120                         SYSOUT
IEF285I   JES2.JOB05085.SO0121                         SYSOUT
IEF285I   SYS21275.T132239.RA000.COMPILE1.OBJSET       PASSED        *-------79
IEF285I   VOL SER NOS= WORK02.
IEF285I   JES2.JOB05085.SI0104                         SYSIN
IEF373I STEP /ASM     / START 21275.1322
IEF374I STEP /ASM     / STOP  21275.1322 CPU    0MIN 00.11SEC SRB    0MIN 00.01SEC VIRT   128K SYS   256K
************************************************************************************************************************************
*    12. Jobstep of job: COMPILE1    Stepname: ASM         Program name: IFOX00     Executed on 02.10.21 from 13.22.42 to 13.22.42 *
*         elapsed time  24:00:00,17                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,12               Virtual Storage used:    128K         Page-out:      0                           *
*           corr. CPU:  00:00:00,12   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      2                                                                           *
*     280......43 280.......0 148......15 148.......0 240.......0 170.....119 190......21 149......10 DMY.......0 DMY.......0      *
*     180......79 DMY.......0                                                                                                      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,20                                             *
************************************************************************************************************************************
IEF236I ALLOC. FOR COMPILE1 LKED STEP07
IEF237I 180  ALLOCATED TO SYSLIN
IEF237I DMY  ALLOCATED TO
IEF237I 280  ALLOCATED TO SYSLMOD
IEF237I 240  ALLOCATED TO SYS00026
IEF237I 190  ALLOCATED TO SYSUT1
IEF237I JES2 ALLOCATED TO SYSPRINT
IEF142I COMPILE1 LKED STEP07 - STEP WAS EXECUTED - COND CODE 0000
IEF285I   SYS21275.T132239.RA000.COMPILE1.OBJSET       DELETED       *-------80
IEF285I   VOL SER NOS= WORK02.
IEF285I   HERC01.MAP3270.LOADLIB                       KEPT          *-------10
IEF285I   VOL SER NOS= PUB002.
IEF285I   SYS1.UCAT.TSO                                KEPT          *--------0
IEF285I   VOL SER NOS= PUB000.
IEF285I   SYS21275.T132239.RA000.COMPILE1.SYSUT1       DELETED       *--------0
IEF285I   VOL SER NOS= WORK03.
IEF285I   JES2.JOB05085.SO0122                         SYSOUT
IEF373I STEP /LKED    / START 21275.1322
IEF374I STEP /LKED    / STOP  21275.1322 CPU    0MIN 00.02SEC SRB    0MIN 00.00SEC VIRT   128K SYS   256K
************************************************************************************************************************************
*    13. Jobstep of job: COMPILE1    Stepname: LKED        Program name: IEWL       Executed on 02.10.21 from 13.22.42 to 13.22.42 *
*         elapsed time  24:00:00,05                      CPU-Identifier:  BSP1           Page-in:      0                           *
*             CPU time  00:00:00,02               Virtual Storage used:    128K         Page-out:      0                           *
*           corr. CPU:  00:00:00,02   CPU time has been corrected by  1 / 1,0  multiplier                                          *
*                                                                                                                                  *
*     I/O Operation                                                                                                                *
*     Number of records read via DD * or DD DATA:      0                                                                           *
*     180......80 DMY.......0 280......10 240.......0 190.......0 DMY.......0                                                      *
*                                                                                                                                  *
*                                          Charge for step (w/o SYSOUT):          0,03                                             *
************************************************************************************************************************************
IEF375I  JOB /COMPILE1/ START 21275.1322
IEF376I  JOB /COMPILE1/ STOP  21275.1322 CPU    0MIN 01.75SEC SRB    0MIN 00.31SEC
                                                                                                            PAGE      1
VERSION 5.5                                     OS/360 PL/I COMPILER (F)                                    DATE 21.275


PL/I F COMPILER OPTIONS SPECIFIED ARE AS FOLLOWS--

     LOAD,NODECK,ATR,NEST,MACRO,XREF,SORMGIN=(2,72,1)


THE COMPLETE LIST OF OPTIONS USED DURING THIS COMPILATION IS--   EBCDIC
                                                                 CHAR60
                                                                 MACRO
                                                                 SOURCE2
                                                               NOMACDCK
                                                                 COMP
                                                                 SOURCE
                                                                 ATR
                                                                 XREF
                                                               NOEXTREF
                                                               NOLIST
                                                                 LOAD
                                                               NODECK
                                                                 FLAGW
                                                               NOSTMT
                                                                 SIZE=1049152
                                                                 LINECNT=050
                                                                 OPT=01
                                                                 SORMGIN=(002,072,001)
                                                               NOEXTDIC
                                                                 NEST
                                                                 OPLIST
                                                                 SYNCHKT


*OPTIONS IN EFFECT*     EBCDIC,CHAR60,MACRO,SOURCE2,NOMACDCK,COMP,SOURCE,ATR,XREF,NOEXTREF,NOLIST,LOAD,
*OPTIONS IN EFFECT*     NODECK,FLAGW,NOSTMT,SIZE=1049152,LINECNT=050,OPT=01,SORMGIN=(002,072,001),NOEXTDIC,
*OPTIONS IN EFFECT*     NEST,OPLIST,SYNCHKT
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE      2


   COMPILE-TIME MACRO PROCESSOR
   MACRO SOURCE2 LISTING

     1    /********************** MAP3270 V2.2.0********************************/00010000
     2    /**********************************************************************00020000
     3    **                                                                   **00030000
     4    ** MAP3270 V2.2.0 - SOFTWARE PACKAGE TO IMPLEMENT FULL SCREEN        **00040000
     5    ** IO FOR IBM 3270 CLASS TERMINALS.                                  **00050000
     6    **                                                                   **00060000
     7    **             COPYRIGHT (C) 2021  EDWARD G LISS                     **00070000
     8    **                     EGLISS4024@GMAIL.COM                          **00080000
     9    **                                                                   **00090000
    10    ** THIS PROGRAM IS FREE SOFTWARE: YOU CAN REDISTRIBUTE IT            **00100000
    11    ** AND/OR MODIFY IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC        **00110000
    12    ** LICENSE AS PUBLISHED BY THE FREE SOFTWARE FOUNDATION,             **00120000
    13    ** EITHER VERSION 3 OF THE LICENSE, OR ANY LATER VERSION.            **00130000
    14    **                                                                   **00140000
    15    ** THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE           **00150000
    16    ** USEFUL, BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED        **00160000
    17    ** WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR           **00170000
    18    ** PURPOSE.  SEE THE GNU GENERAL PUBLIC LICENSE FOR MORE             **00180000
    19    ** DETAILS.                                                          **00190000
    20    **                                                                   **00200000
    21    ** PLEASE SEE HTTPS://WWW.GNU.ORG/LICENSES/ FOR A COPY OF THE        **00210000
    22    ** GNU GENERAL PUBLIC LICENSE.                                       **00220000
    23    **                                                                   **00230000
    24    **********************************************************************/00240000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE      3


   MACRO SOURCE2 LISTING

    25    /*********************************************************************/00250000
    26    /*                                                                   */00260000
    27    /* NAME: MAP3270 - SCREEN COMPILER                                   */00270000
    28    /*                                                                   */00280000
    29    /*********************************************************************/00290000
    30    /*                                                                   */00300000
    31    /* THIS IS A PROGRAM TO PROCESS A SCREEN DEFINITION FILE AND CREATES */00310000
    32    /* A PANEL FOR THE MAP3270 SYSTEM.                                   */00320000
    33    /*                                                                   */00330000
    34    /* A PANEL FOR THE MAP3270 SYSTEM CONSISTS OF 2 COMPONENTS - A       */00340000
    35    /* PHYSICAL MAP AND A USER MAP.  CONCEPTUALLY THESE ARE LIKE CICS    */00350000
    36    /* PHYSICAL AND SYMBOLIC MAPS.  HOWEVER, THERE IS NO COMPATABILITY.  */00360000
    37    /*                                                                   */00370000
    38    /* THE PHYSICAL MAP IS CONSISTS OF AN INDEX, THE ACTUAL 3270 MAP     */00380000
    39    /* AND THE CROSS REFERENCE FROM THE PHYSICAL MAP TO A USER MAP.      */00390000
    40    /* THE USER MAP IS THE AREA THAT USER'S APPLICATION SENDS AND        */00400000
    41    /* RECEIVES DATA FROM MAP3270 RUNTIME MODULES.                       */00410000
    42    /*                                                                   */00420000
    43    /* USER MAPS ARE GENERATED FOR ASSEMBLER, COBOL, AND PL/I (F).       */00430000
    44    /* THE PHYSICAL MAP IS GENERATED AND MUST BE ASSEMLED AND LINKED.    */00440000
    45    /*                                                                   */00450000
    46    /* REVISION HISTORY                                                  */00460000
    47    /* ------  --------------------------------------------------------  */00470000
    48    /* V2.0.0  "DOWNGRADED" FROM PL/1 OPTIMIZING COMPILER TO PL/1 (F)    */00480000
    49    /*         SEPT 2008                                                 */00490000
    50    /* V2.1.0  ADDED SUPPORT FOR THE EXTENTED ATTRIBUTES HIGHLITE AND    */00500000
    51    /*         COLOR.                                                    */00510000
    52    /*         REWORKED CODE TO USE THE SELECT...WHEN  MACRO, WHICH      */00520000
    53    /*         SIMULATES THE SELECT STATEMENT.                           */00530000
    54    /*         AUGUST 2010                                               */00540000
    55    /* V2.2.0 -REVISED TO MAKE GENERATION OF ASM,COB,PLI AND MAP CODE    */00550000
    56    /*         OPTIONAL.                                                 */00560000
    57    /*        -REVISED TO ALLOW 28 CHARACTER FIELD NAMES IN .VAR         */00570000
    58    /*        -REVISED TO GENERATE COBOL AND PLI CODE WITH THE           */00580000
    59    /*         28 CHARACTER NAMES.                                       */00590000
    60    /*        -REVIDED ASM CODE GENERATION TO ONLY USE THE INTERNAL      */00600000
    61    /*         NAMES (R__C__).  FIELD NAMES ARE INCLUDED AS COMMENTS.    */00610000
    62    /*                                                                   */00620000
    63    /*********************************************************************/00630000
    64    %INCLUDE SELECT;                                                       00640000
    65    %INCLUDE FIX2STR;                                                      00650000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE      4


   MACRO SOURCE2 LISTING

    66    MAPGEN:PROC(EXEC_PARM) OPTIONS(MAIN);                                  00660000
    67       DECLARE EXEC_PARM               CHAR(100) VARYING;                  00670000
    68       DECLARE (GEN_ASM,GEN_COB,GEN_PLI,GEN_MAP)                           00680000
    69                                       BIT(1) ALIGNED INIT('1'B);          00690000
    70       DECLARE (PANEL,ASM,COB,PL1)                                         00700000
    71                STREAM OUTPUT FILE;                                        00710000
    72       DECLARE  PANEL_SEQ              FIXED DEC(9,2) INIT(1);             00720000
    73       DECLARE  NOT_E_O_F              BIT(1) ALIGNED;                     00730000
    74       DECLARE  NO_ATTRIB              BIT(1) ALIGNED;                     00740000
    75       DECLARE  PANEL_NAME             CHAR(7) VARYING INIT('PANELNM');    00750000
    76       DECLARE  MY_REC                 CHAR(80);                           00760000
    77       DECLARE  PROCESS_STATUS         CHAR(7);                            00770000
    78       DECLARE  SCR_IMG(26)            CHAR(82);                           00780000
    79       DECLARE  ERROR_FOUND            BIT(1) ALIGNED INIT('0'B),          00790000
    80                IHESARC                ENTRY(FIXED BIN(31,0)),             00800000
    81                RETURN_CODE            FIXED BIN(31,0) ALIGNED INIT(0);    00810000


    82    /*********************************************************************/00820000
    83    /*                                                                   */00830000
    84    /* ATTR_TBL HOLDS ALL ATTRIBUTES FOR THE ATTR_CHR PARSED FROM .ATTR  */00840000
    85    /*                                                                   */00850000
    86    /*********************************************************************/00860000
    87       DECLARE  1 ATTR_REC,                                                00870000
    88                  2 ATTR_CHR           CHAR(1),                            00880000
    89                  2 ATTR_A             CHAR(80) VARYING,                   00890000
    90                  2 PROT               BIT(1) ALIGNED,                     00900000
    91                  2 BRIGHT             BIT(1) ALIGNED,                     00910000
    92                  2 NUM                BIT(1) ALIGNED,                     00920000
    93                  2 TITLE              BIT(1) ALIGNED,                     00930000
    94                  2 STOP_BIT           BIT(1) ALIGNED,                     00940000
    95                  2 CUR                BIT(1) ALIGNED,                     00950000
    96                  2 HI_LIGHT           CHAR(1),                            00960000
    97                  2 COLOR              CHAR(3);                            00970000
    98       DECLARE  1 ATTR_TBL(9) LIKE ATTR_REC;                               00980000


    99    /*********************************************************************/00990000
   100    /*                                                                   */01000000
   101    /* FLDS HOLDS ALL THE FIELD INFORMATION PARSED FROM THE .SCREEN      */01010000
   102    /* THE ATTRS ARE REPEATED SO THE ATTRIBUTES FOR FIELDS CAN BE        */01020000
   103    /* OVERRIDEN IN THE .VARS SECTION.                                   */01030000
   104    /*                                                                   */01040000
   105    /*********************************************************************/01050000
   106       DECLARE  1 FLD(500),                                                01060000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE      5


   MACRO SOURCE2 LISTING

   107                  2 FLD_ROW            FIXED BINARY(15),                   01070000
   108                  2 FLD_COL            FIXED BINARY(15),                   01080000
   109                  2 FLD_ATTR           FIXED BINARY(15),                   01090000
   110                  2 FLD_REC  LIKE ATTR_REC,                                01100000
   111                  2 FLD_DATA           CHAR(80) VARYING,                   01110000
   112                  2 FLD_INT_NAME       CHAR(6),                            01120000
   113                  2 FLD_NAME           CHAR(28) VARYING;                   01130000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE      6


   MACRO SOURCE2 LISTING

   114    /*********************************************************************/01140000
   115    /*                                                                   */01150000
   116    /* VARS HOLDS ALL THE FIELD INFORMATION PARSED FROM THE .VARS        */01160000
   117    /*                                                                   */01170000
   118    /*********************************************************************/01180000
   119       DECLARE  1 VAR(500),                                                01190000
   120                  2 VAR_NAME           CHAR(6),                            01200000
   121                  2 VAR_FLD            CHAR(28) VARYING;                   01210000


   122    /*********************************************************************/01220000
   123    /*                                                                   */01230000
   124    /*   STATIC FIELDS DEFINED HERE                                      */01240000
   125    /*                                                                   */01250000
   126    /*********************************************************************/01260000
   127       DECLARE PAGE_TITLE              CHAR(45) STATIC INIT(               01270000
   128            'M A P 3 2 7 0   S C R E E N   C O M P I L E R'),              01280000
   129               PGM_VER                 CHAR(8) STATIC INIT('V2.2.0  ');    01290000
   130       DECLARE (TRUE    INITIAL('1'B),                                     01300000
   131                FALSE   INITIAL('0'B)) BIT(1) ALIGNED STATIC,              01310000
   132                ONE     INITIAL(1)     FIXED BIN(15)  STATIC;              01320000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE      7


   MACRO SOURCE2 LISTING

   133    /*********************************************************************/01330000
   134    /*                                                                   */01340000
   135    /*   GLOBAL VARIABLES DEFINED HERE                                   */01350000
   136    /*                                                                   */01360000
   137    /*********************************************************************/01370000


   138       DECLARE  FLD_DEF                CHAR(80) VARYING;                   01380000
   139       DECLARE (B,ROW,COL,A,REC_CTR)   FIXED BINARY(15);                   01390000
   140       DECLARE (FLD_CTR,M,FLD_A      ) FIXED BINARY(15);                   01400000
   141       DECLARE VAR_CTR                 FIXED BINARY(15);                   01410000
   142       DECLARE LBL                     CHAR(7) VARYING,                    01420000
   143               PAGE_NO                 FIXED DEC(3,0) INIT(0),             01430000
   144               DT_TIME_STAMP           CHAR(60) VARYING,                   01440000
   145               TITLE_STAMP             CHAR(50) VARYING;                   01450000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE      8


   MACRO SOURCE2 LISTING

   146    /*********************************************************************/01460000
   147    /*                                                                   */01470000
   148    /* READ AND LIST THE INPUT STATEMENTS.  SET UP THE PAGE HEADING      */01480000
   149    /*    SET UP THE PAGE HEADING.  THEN THE INPUT IS LISTED AND PARSED  */01490000
   150    /*    INPUT CONSISTS OF SECTIONS AND COMMAND.  EACH SECTION STARTS   */01500000
   151    /*    WITH '.NAME ' IN COL 1.  VALID NAMES ARE LISTED BELOW.         */01510000
   152    /*    COMMAND START WITH '.KW=' IN COL 1.                            */01520000
   153    /*                                                                   */01530000
   154    /* THERE ARE 3 SECTIONS                                              */01540000
   155    /* 1.  ATTR - THIS IS WHERE THE ATTRIBUTES ARE DEFINED. THESE MUST   */01550000
   156    /*     BE DEFINED BEFORE USE IN THE SCREEN SECTION.                  */01560000
   157    /* 2.  SCREEN - THIS IS WHERE THE 'DRAWING' OF THE SCREEN IS         */01570000
   158    /*     IS DEFINED.  EACH FIELD BEGIN WITH AN ATTRIBUTED AS DEFINED   */01580000
   159    /*     IN THE ATTR SECTION.                                          */01590000
   160    /* 3.  VARS - THIS OPTIONAL SECTION MAPS ANY USER DEFINED FIELD      */01600000
   161    /*     NAME TO BE DEFINED.  THESE NAME REPLACE THE DEFAULT NAME OF   */01610000
   162    /*     R99C99.                                                       */01620000
   163    /*                                                                   */01630000
   164    /* THE FOLLOWING IS A LIST OF COMMAND CURRENTLY SUPPORTED:           */01640000
   165    /*                                                                   */01650000
   166    /* 1.  .NAME= THIS COMMAND SETS THE NAME FOR THE PANEL.  NAME CAN    */01660000
   167    /*     BE ANY VALID NAME 1-7 CHARACTERS.  MAP3270 GENERATES SOME     */01670000
   168    /*     INTERNAL NAMES USING 'NAME' PLUS 1 CHARACTER.                 */01680000
   169    /*                                                                   */01690000
   170    /*********************************************************************/01700000
   171                                                                           01710000
   172       DT_TIME_STAMP = '** GENERATED BY MAP3270 ' || PGM_VER || ' ON ' ||  01720000
   173                       DATE || ' AT ' || TIME;                             01730000
   174       TITLE_STAMP = ' GENERATED BY MAP3270 V2.2.0';                       01740000
   175       CALL INITIALIZE;                                                    01750000
   176       ON ENDPAGE(SYSPRINT)                                                01760000
   177       BEGIN;                                                              01770000
   178          PAGE_NO = PAGE_NO + 1;                                           01780000
   179          PUT PAGE EDIT(PAGE_TITLE,PGM_VER,'PAGE ',PAGE_NO)                01790000
   180                       (A,COL(100),A,COL(111),A,F(3));                     01800000
   181          IF PAGE_NO = 1 THEN                                              01810000
   182             CALL PROCESS_PARM;                                            01820000
   183          PUT SKIP(2) EDIT('INPUT STATEMENTS')(A)                          01830000
   184                          (' LINE:   STATEMENT') (SKIP(2),A)               01840000
   185                          ('------   ---------') (SKIP,A);                 01850000
   186       END;                                                                01860000
   187                                                                           01870000
   188       SIGNAL ENDPAGE(SYSPRINT);                                           01880000
   189       PROCESS_STATUS = '.NONE';                                           01890000
   190       ON ENDFILE(SYSIN)                                                   01900000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE      9


   MACRO SOURCE2 LISTING

   191          NOT_E_O_F = FALSE;                                               01910000
   192       NOT_E_O_F = TRUE;                                                   01920000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     10


   MACRO SOURCE2 LISTING

   193    /*********************************************************************/01930000
   194    /*                                                                   */01940000
   195    /*  PPPP    AAA    SSS    SSS     1                                  */01950000
   196    /*  P   P  A   A  S      S       11                                  */01960000
   197    /*  PPPP   A   A  S      S        1                                  */01970000
   198    /*  P      AAAAA   SSS    SSS     1                                  */01980000
   199    /*  P      A   A      S      S    1                                  */01990000
   200    /*  P      A   A      S      S    1                                  */02000000
   201    /*  P      A   A   SSS    SSS   11111                                */02010000
   202    /*                                                                   */02020000
   203    /*  READ AND PRINT THE INPUT STATEMENTS                              */02030000
   204    /*    DETERMINE THE SECTION AND PASS TO THE APPROPRIATE SECTION      */02040000
   205    /*    FOR PROCESSING.                                                */02050000
   206    /*    COMMANDS ARE PARSED AND PROCESSED IMMEDIATELY.                 */02060000
   207    /*                                                                   */02070000
   208    /*********************************************************************/02080000
   209       GET EDIT(MY_REC) (A(80));                                           02090000
   210       DO WHILE (NOT_E_O_F);                                               02100000
   211          REC_CTR = REC_CTR + 1;                                           02110000
   212          PUT SKIP EDIT(REC_CTR,':',MY_REC) (F(5),A(4),A);                 02120000
   213          IF SUBSTR(MY_REC,1,5) = '.ATTR' THEN                             02130000
   214          DO;                                                              02140000
   215               PROCESS_STATUS = '.ATTR  ';                                 02150000
   216               A = 0;                                                      02160000
   217               ATTRLIST='';                                                02170000
   218          END;                                                             02180000
   219          ELSE                                                             02190000
   220          IF SUBSTR(MY_REC,1,7) = '.SCREEN' THEN                           02200000
   221          DO;                                                              02210000
   222               PROCESS_STATUS = '.SCREEN';                                 02220000
   223               B = 0;                                                      02230000
   224               FLD_DEF = '';                                               02240000
   225               FLD_A = 0;                                                  02250000
   226               ROW = 0;                                                    02260000
   227               COL = 0;                                                    02270000
   228               NO_ATTRIB = TRUE;                                           02280000
   229          END;                                                             02290000
   230          ELSE                                                             02300000
   231          IF SUBSTR(MY_REC,1,5) = '.VARS' THEN                             02310000
   232               PROCESS_STATUS = '.VARS  ';                                 02320000
   233          ELSE                                                             02330000
   234          IF SUBSTR(MY_REC,1,6) = '.NAME=' THEN                            02340000
   235          BEGIN;                                                           02350000
   236               DCL I FIXED BINARY(15);                                     02360000
   237               PANEL_NAME = SUBSTR(MY_REC,7,7);                            02370000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     11


   MACRO SOURCE2 LISTING

   238               I = INDEX(PANEL_NAME,' ');                                  02380000
   239               IF I > 0 THEN PANEL_NAME=SUBSTR(PANEL_NAME,1,I-1);          02390000
   240          END;                                                             02400000
   241          ELSE                                                             02410000
   242          IF SUBSTR(MY_REC,1,1) = '*' THEN; /* DO NOT PROCESS COMMENT */   02420000
   243          ELSE                                                             02430000
   244               CALL PROCESS_MYREC;                                         02440000
   245          GET EDIT(MY_REC) (A(80));                                        02450000
   246       END; /* OF LOOP */                                                  02460000
   247       IF FLD_DEF ^= '' THEN             /* IF WE STILL HAVE DATA      */  02470000
   248       DO;                                                                 02480000
   249          CALL SAVE_FIELD(ONE);          /* WRITE DATA FOR LAST FIELD  */  02490000
   250          FLD_DEF = '';                                                    02500000
   251       END;                                                                02510000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     12


   MACRO SOURCE2 LISTING

   252    /*********************************************************************/02520000
   253    /*                                                                   */02530000
   254    /*  PPPP    AAA    SSS    SSS    222                                 */02540000
   255    /*  P   P  A   A  S      S      2   2                                */02550000
   256    /*  PPPP   A   A  S      S          2                                */02560000
   257    /*  P      AAAAA   SSS    SSS      2                                 */02570000
   258    /*  P      A   A      S      S    2                                  */02580000
   259    /*  P      A   A      S      S   2                                   */02590000
   260    /*  P      A   A   SSS    SSS   22222                                */02600000
   261    /*                                                                   */02610000
   262    /*  SET UP THE PAGE HEADINGS FOR THE SECOND PASS.                    */02620000
   263    /*    DURING THE SECOND PASS, SOME ERROR CHECKING IS PERFORMED TO    */02630000
   264    /*    ENSURE THE MAP DOES NOT VIOLATE HARDWARE PROTOCOL.             */02640000
   265    /*                                                                   */02650000
   266    /*   -THE SCREEN IMAGE WILL BE PRINTED.                              */02660000
   267    /*   -THE INPUT ATTRIBUTES AND THE GENERATED ATTRIBUTES WILL BE      */02670000
   268    /*    PRINTED.  THIS SHOWS WHAT WAS SPECIFIED VS WHAT WILL BE        */02680000
   269    /*    GENERATED.                                                     */02690000
   270    /*   -ALL VARIABLE NAMES ARE CORRECT AND EXIST                       */02700000
   271    /*   -THE MACROS TO DEFINE THE PHYSICAL MAP (NOT RELATED TO CICS)    */02710000
   272    /*   -THE USER INTERFACE(S) FOR ASSEMBLER, COBOL AND PL1 PROGRAMS.   */02720000
   273    /*                                                                   */02730000
   274    /*********************************************************************/02740000
   275                                                                           02750000
   276       ON ENDPAGE(SYSPRINT)                                                02760000
   277       BEGIN;                                                              02770000
   278          PAGE_NO = PAGE_NO + 1;                                           02780000
   279          PUT PAGE EDIT(PAGE_TITLE,'PANEL ',PANEL_NAME,                    02790000
   280                        PGM_VER,'PAGE ',PAGE_NO)                           02800000
   281                       (A,COL(70),A,A,COL(100),A,COL(111),A,F(3));         02810000
   282          PUT SKIP(2);                                                     02820000
   283       END;                                                                02830000
   284       SIGNAL ENDPAGE(SYSPRINT);                                           02840000
   285                                                                           02850000
   286          /*  PRINT THE SCREEN IMAGE */                                    02860000
   287                                                                           02870000
   288       PUT SKIP EDIT('* ', (29)'>',                                        02880000
   289                     ' SAMPLE SCREEN LAYOUT ',                             02890000
   290                     (29)'<') (X(10),(4)A);                                02900000
   291       PUT SKIP EDIT('*') (X(10),A);                                       02910000
   292       PUT SKIP EDIT('* ----+----1----+----2----+----3',                   02920000
   293                       '----+----4----+----5----+----6',                   02930000
   294                       '----+----7----+----8') (X(10),(3)A);               02940000
   295       DO I = 1 TO B;                                                      02950000
   296          PUT SKIP EDIT(I,SCR_IMG(I)) (F(9),X(1),A);                       02960000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     13


   MACRO SOURCE2 LISTING

   297       END;                                                                02970000
   298       PUT SKIP EDIT('* ----+----1----+----2----+----3',                   02980000
   299                       '----+----4----+----5----+----6',                   02990000
   300                       '----+----7----+----8') (X(10),(3)A);               03000000
   301                                                                           03010000
   302          /*  PRINT THE ATTRIBUTE LIST */                                  03020000
   303                                                                           03030000
   304       PUT SKIP(2) EDIT('CHAR ATTR')(X(10),A);                             03040000
   305       DO I = 1 TO A;                                                      03050000
   306          PUT SKIP EDIT(ATTR_TBL(I).ATTR_CHR,                              03060000
   307                        ATTR_TBL(I).ATTR_A) (X(12),A,X(2),A);              03070000
   308          PUT SKIP EDIT(' ') (X(15),A);                                    03080000
   309          CALL PRINT_ATTR(ATTR_TBL(I));                                    03090000
   310       END; /* OF LOOP */                                                  03100000
   311                                                                           03110000
   312          /*  VERIFY THE FIELDS LIST  */                                   03120000
   313                                                                           03130000
   314       DECLARE VAR_FLD_MATCH  BIT(1) ALIGNED;                              03140000
   315       DO I=1 TO VAR_CTR;                                                  03150000
   316         VAR_FLD_MATCH = FALSE;                                            03160000
   317         DO J=1 TO FLD_CTR;                                                03170000
   318            IF VAR(I).VAR_NAME = FLD(J).FLD_NAME THEN                      03180000
   319            DO;                                                            03190000
   320               VAR_FLD_MATCH = TRUE;                                       03200000
   321           /** IF ATTR_TBL(FLD(J).FLD_ATTR).TITLE THEN                     03210000
   322               DO;                                                         03220000
   323                  PUT SKIP EDIT('*** VAR ',VAR(I).VAR_NAME,                03230000
   324                                ' IS LISTED IN THE .VAR SECTION. THE ',    03240000
   325                                'FIELD IS A TITLE. NAME NOT ALLOWED.')     03250000
   326                                (A,A,A,A);                                 03260000
   327                  ERROR_FOUND = TRUE;                                      03270000
   328               END;                                                        03280000
   329               ELSE                                                        03290000
   330           **/    FLD(J).FLD_NAME = VAR(I).VAR_FLD;                        03300000
   331            END;                                                           03310000
   332         END;                                                              03320000
   333         IF VAR_FLD_MATCH  THEN ;                                          03330000
   334         ELSE                                                              03340000
   335         DO;                                                               03350000
   336            PUT SKIP EDIT('*** VAR ',VAR(I).VAR_NAME,' IS LISTED IN THE',  03360000
   337                          ' .VAR SECTION BUT IS NOT DEFINED ***')          03370000
   338                         (A,A,A,A);                                        03380000
   339            ERROR_FOUND = TRUE;                                            03390000
   340         END;                                                              03400000
   341       END;                                                                03410000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     14


   MACRO SOURCE2 LISTING

   342                                                                           03420000
   343          /*  PRINT THE FIELDS LIST  */                                    03430000
   344                                                                           03440000
   345       PUT SKIP(2) EDIT('  ROW  COL NAME')(X(5),A);                        03450000
   346       DO I=1 TO FLD_CTR;                                                  03460000
   347      /*  IF ^ATTR_TBL(FLD(I).FLD_ATTR).TITLE THEN  */                     03470000
   348          DO;                                                              03480000
   349             PUT SKIP EDIT(FLD(I).FLD_ROW,FLD(I).FLD_COL,                  03490000
   350                           FLD(I).FLD_NAME) (X(5),F(5),F(5),X(1),A(28));   03500000
   351             CALL PRINT_ATTR(FLD(I).FLD_REC);                              03510000
   352          /* PUT SKIP DATA(FLD(I)); */                                     03520000
   353          END;                                                             03530000
   354       END;                                                                03540000

   355       IF GEN_MAP THEN                                                     03550000
   356       DO;                                                                 03560000
   357          CALL WRITE_PANEL;                                                03570000
   358          CALL WRITE_MAPPING;                                              03580000
   359          PUT FILE(PANEL) EDIT('END',PANEL_SEQ)                            03590000
   360                                       (COL(10),A,COL(73),P'999999V99');   03600000
   361          PANEL_SEQ=PANEL_SEQ+1;                                           03610000
   362       END;                                                                03620000
   363       IF GEN_ASM THEN                                                     03630000
   364          CALL WRITE_ASM;                                                  03640000
   365       IF GEN_COB THEN                                                     03650000
   366          CALL WRITE_COB;                                                  03660000
   367       IF GEN_PLI THEN                                                     03670000
   368          CALL WRITE_PL1;                                                  03680000
   369       /*                                                                  03690000
   370         END OF EXECUTION - SET RETURN CODE                                03700000
   371       */                                                                  03710000
   372       IF ERROR_FOUND THEN RETURN_CODE=16;                                 03720000
   373       PUT SKIP(3) EDIT('END OF MAPGEN EXECUTION - RETURN CODE IS ',       03730000
   374                        RETURN_CODE) (A,P'9999');                          03740000
   375       CALL IHESARC(RETURN_CODE);                                          03750000
   376    /***************** END OF MAINLINE ****************/                   03760000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     15


   MACRO SOURCE2 LISTING

   377    /*********************************************************************/03770000
   378    /*                                                                   */03780000
   379    /*   THIS IS WHERE THE EXEC CARD PARM IS PARSED.                     */03790000
   380    /*   THE ALLOWABLE OPTIONS ARE 'ASM COB PLI MAP' AND THE 'NO'        */03800000
   381    /*   PREFIX.  DEFAULT WILL BE 'ASM,COB,PLI,MAP'                      */03810000
   382    /*                                                                   */03820000
   383    /*********************************************************************/03830000
   384    PROCESS_PARM:PROC;                                                     03840000
   385       DECLARE WORK_PARM            CHAR(100) VARYING;                     03850000
   386       DECLARE NEXT_CHAR            FIXED BIN(15) ALIGNED;                 03860000
   387       IF LENGTH(EXEC_PARM) = 0 THEN                                       03870000
   388       DO;                             /* USE THE DEFAULTS */              03880000
   389          PUT SKIP(2) EDIT('*** USING DEFAULT EXEC PARM ',                 03890000
   390                           '''ASM,COB,PLI,MAP''')                          03900000
   391                    (A,A);                                                 03910000
   392          RETURN;                                                          03920000
   393       END;                                                                03930000
   394       PUT SKIP(2) EDIT('*** USING EXEC PARM ''',EXEC_PARM, '''')          03940000
   395                    (A,A,A);                                               03950000
   396       IF LENGTH(EXEC_PARM) < 3 THEN                                       03960000
   397       DO;                             /* USE THE DEFAULTS */              03970000
   398          PUT SKIP(2) EDIT('*** INVALID EXEC PARM ***')                    03980000
   399                    (A);                                                   03990000
   400          PUT SKIP EDIT('*** USING DEFAULT EXEC PARM ',                    04000000
   401                           '''ASM,COB,PLI,MAP''')                          04010000
   402                    (A,A);                                                 04020000
   403          RETURN;                                                          04030000
   404       END;                                                                04040000
   405       WORK_PARM = EXEC_PARM;                                              04050000
   406       DO WHILE(LENGTH(WORK_PARM)>0);                                      04060000
   407       SELECT (TRUE)                                                       04070000
   408          WHEN (SUBSTR(WORK_PARM,1,3) = 'ASM')                             04080000
   409             GEN_ASM = TRUE;                                               04090000
   410             NEXT_CHAR = 4;                                                04100000
   411          WHEN (SUBSTR(WORK_PARM,1,3) = 'COB')                             04110000
   412             GEN_COB = TRUE;                                               04120000
   413             NEXT_CHAR = 4;                                                04130000
   414          WHEN (SUBSTR(WORK_PARM,1,3) = 'PLI')                             04140000
   415             GEN_PLI = TRUE;                                               04150000
   416             NEXT_CHAR = 4;                                                04160000
   417          WHEN (SUBSTR(WORK_PARM,1,3) = 'MAP')                             04170000
   418             GEN_MAP = TRUE;                                               04180000
   419             NEXT_CHAR = 4;                                                04190000
   420          WHEN (SUBSTR(WORK_PARM,1,5) = 'NOASM')                           04200000
   421             GEN_ASM = FALSE;                                              04210000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     16


   MACRO SOURCE2 LISTING

   422             NEXT_CHAR = 6;                                                04220000
   423          WHEN (SUBSTR(WORK_PARM,1,5) = 'NOCOB')                           04230000
   424             GEN_COB = FALSE;                                              04240000
   425             NEXT_CHAR = 6;                                                04250000
   426          WHEN (SUBSTR(WORK_PARM,1,5) = 'NOPLI')                           04260000
   427             GEN_PLI = FALSE;                                              04270000
   428             NEXT_CHAR = 6;                                                04280000
   429          WHEN (SUBSTR(WORK_PARM,1,5) = 'NOMAP')                           04290000
   430             GEN_MAP = FALSE;                                              04300000
   431             NEXT_CHAR = 6;                                                04310000
   432       OTHERWISE                                                           04320000
   433       DO;                                                                 04330000
   434          PUT SKIP EDIT('*** UNRECOGNIZED PARM FOUND ***') (A);            04340000
   435          ERROR_FOUND=TRUE;                                                04350000
   436          RETURN;                                                          04360000
   437       END;                                                                04370000
   438       ENDSELECT                                                           04380000
   439       IF NEXT_CHAR > LENGTH(WORK_PARM) THEN                               04390000
   440          WORK_PARM = '';                                                  04400000
   441       ELSE                                                                04410000
   442       IF SUBSTR(WORK_PARM,NEXT_CHAR,1) = ',' THEN                         04420000
   443          WORK_PARM = SUBSTR(WORK_PARM,NEXT_CHAR+1);                       04430000
   444     /*PUT SKIP DATA(WORK_PARM,GEN_ASM,GEN_COB,GEN_PLI,GEN_MAP);*/         04440000
   445       END; /* OF DO */                                                    04450000
   446    END PROCESS_PARM;                                                      04460000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     17


   MACRO SOURCE2 LISTING

   447    /*********************************************************************/04470000
   448    /*                                                                   */04480000
   449    /*   THIS IS THE INITIALIZATION.  ALL THE FLD (FIELD) AND ATTRS ARE  */04490000
   450    /*   INITIALIZED.                                                    */04500000
   451    /*                                                                   */04510000
   452    /*********************************************************************/04520000
   453    INITIALIZE:PROC;                                                       04530000
   454       FLD_CTR = 0;                                                        04540000
   455       FLD(*).FLD_ROW = 0;                                                 04550000
   456       FLD(*).FLD_COL = 0;                                                 04560000
   457       FLD(*).FLD_ATTR = 0;                                                04570000
   458       FLD(*).FLD_DATA='';                                                 04580000
   459       FLD(*).FLD_NAME='';                                                 04590000
   460       FLD(*).FLD_INT_NAME=(6)' ';                                         04600000
   461       FLD(*).ATTR_CHR = ' ';                                              04610000
   462       FLD(*).ATTR_A = '';                                                 04620000
   463       FLD(*).PROT = FALSE;                                                04630000
   464       FLD(*).NUM = FALSE;                                                 04640000
   465       FLD(*).BRIGHT = FALSE;                                              04650000
   466       FLD(*).TITLE = FALSE;                                               04660000
   467       FLD(*).STOP_BIT = FALSE;                                            04670000
   468       FLD(*).CUR = FALSE;                                                 04680000
   469       FLD(*).HI_LIGHT = ' ';                                              04690000
   470       FLD(*).COLOR = ' ';                                                 04700000
   471       VAR_CTR = 0;                                                        04710000
   472       VAR(*).VAR_NAME=' ';                                                04720000
   473       VAR(*).VAR_FLD='';                                                  04730000
   474       REC_CTR = 0;                                                        04740000
   475       ATTR_TBL(*).ATTR_CHR = ' ';                                         04750000
   476       ATTR_TBL(*).ATTR_A = '';                                            04760000
   477       ATTR_TBL(*).PROT = FALSE;                                           04770000
   478       ATTR_TBL(*).NUM = FALSE;                                            04780000
   479       ATTR_TBL(*).BRIGHT = FALSE;                                         04790000
   480       ATTR_TBL(*).TITLE = FALSE;                                          04800000
   481       ATTR_TBL(*).STOP_BIT = FALSE;                                       04810000
   482       ATTR_TBL(*).CUR = FALSE;                                            04820000
   483       ATTR_TBL(*).HI_LIGHT = ' ';                                         04830000
   484       ATTR_TBL(*).COLOR = ' ';                                            04840000
   485    END INITIALIZE;                                                        04850000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     18


   MACRO SOURCE2 LISTING

   486    /*********************************************************************/04860000
   487    /*                                                                   */04870000
   488    /*   THIS IS THE MAIN INPUT PROCESS CONTROL.  NOTE THAT THERE IS     */04880000
   489    /*   NO ENFORCMENT OF THE SEQUENCE OF THE INPUT SECTIONS.            */04890000
   490    /*   THE CORRECT SEQUENCE IS .ATTR, .SCREEN, .VARS                   */04900000
   491    /*                                                                   */04910000
   492    /*********************************************************************/04920000

   493    PROCESS_MYREC:PROC;                                                    04930000
   494                                                                           04940000
   495      IF PROCESS_STATUS = '.ATTR  '        THEN CALL PROCESS_ATTRIBUTE;    04950000
   496      ELSE IF  PROCESS_STATUS = '.SCREEN'  THEN CALL PROCESS_SCREEN;       04960000
   497      ELSE IF  PROCESS_STATUS = '.VARS  '  THEN CALL PROCESS_VARS;         04970000
   498                                                                           04980000
   499    END PROCESS_MYREC;                                                     04990000
   500                                                                           05000000
   501    PROCESS_ATTRIBUTE:PROC;                                                05010000
   502       DECLARE ATTRIB              CHAR(1);                                05020000
   503       DECLARE (TEMP,TEMP2)        CHAR(78) VARYING;                       05030000
   504       DECLARE I                   FIXED BINARY(15);                       05040000
   505       I = 3;                                                              05050000
   506       DO WHILE (I<80 & SUBSTR(MY_REC,I,1)^=' ');                          05060000
   507          I=I+1;                                                           05070000
   508       END;                                                                05080000
   509       TEMP,TEMP2 = SUBSTR(MY_REC,3,I-3);                                  05090000
   510       A = A + 1;                                                          05100000
   511       ATTR_TBL(A).ATTR_A = '('||TEMP2||')';                               05110000
   512       ATTR_TBL(A).ATTR_CHR = SUBSTR(MY_REC,1,1);                          05120000
   513       I=1;                                                                05130000
   514       DO WHILE(I>0);                                                      05140000
   515          I=INDEX(TEMP,',');                                               05150000
   516          IF I>0 THEN                                                      05160000
   517          DO;                                                              05170000
   518             CALL CHECK_ATTR(SUBSTR(TEMP,1,I-1),ATTR_TBL(A));              05180000
   519             TEMP=SUBSTR(TEMP,I+1);                                        05190000
   520          END;                                                             05200000
   521          ELSE                                                             05210000
   522             CALL CHECK_ATTR(TEMP,ATTR_TBL(A));                            05220000
   523       END;                                                                05230000
   524       IF ATTR_TBL(A).TITLE THEN          /* OVERRIDE SOME ATTRS  */       05240000
   525       DO;                                /* FOR TYPE TITLE       */       05250000
   526          ATTR_TBL(A).TITLE = TRUE;                                        05260000
   527          ATTR_TBL(A).PROT = TRUE;                                         05270000
   528       /**ATTR_TBL(A).BRIGHT = FALSE;  DO NOT OVERRIDE BRIGHT   **/        05280000
   529          ATTR_TBL(A).NUM = FALSE;                                         05290000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     19


   MACRO SOURCE2 LISTING

   530          ATTR_TBL(A).STOP_BIT = FALSE;                                    05300000
   531          ATTR_TBL(A).CUR = FALSE;                                         05310000
   532       END;                                                                05320000
   533     /*PUT SKIP DATA(A,ATTR_TBL(A));*/                                     05330000
   534    END PROCESS_ATTRIBUTE;                                                 05340000

   535    /*********************************************************************/05350000
   536    /*                                                                   */05360000
   537    /*   THIS ROUTINE PROCESSES ALL OF THE ATTRIBUTES.  THEY CAN BE      */05370000
   538    /*   SPECIFIED IN THE .ATTR OR .VARS SECTION.  THE MAP DEFAULTS      */05380000
   539    /*   CAN BE SET IN THE .ATTR AND OVERRIDEN FOR EACH FIELD IN THE     */05390000
   540    /*   .VARS SECTION.                                                  */05400000
   541    /*                                                                   */05410000
   542    /*********************************************************************/05420000

   543    CHECK_ATTR:PROC(AT,ATTR);                                              05430000
   544       DCL AT CHAR(*) VARYING,                                             05440000
   545           ATTR LIKE ATTR_REC;                                             05450000
   546       SELECT (AT);                                                        05460000
   547         WHEN ('TITLE')     ATTR.TITLE = TRUE;                             05470000
   548         WHEN ('BRIGHT')    ATTR.BRIGHT = TRUE;                            05480000
   549         WHEN ('NORMAL')    ATTR.BRIGHT = FALSE;                           05490000
   550         WHEN ('NUM')       ATTR.NUM = TRUE;                               05500000
   551         WHEN ('ALPHA')     ATTR.NUM = FALSE;                              05510000
   552         WHEN ('PROT')      ATTR.PROT = TRUE;                              05520000
   553         WHEN ('UNPROT')    ATTR.PROT = FALSE;                             05530000
   554         WHEN ('CUR')       ATTR.CUR = TRUE;                               05540000
   555         WHEN ('STOP')      ATTR.STOP_BIT = TRUE;                          05550000
   556         WHEN ('HIDEF')     ATTR.HI_LIGHT = 'D';                           05560000
   557         WHEN ('BLINK')     ATTR.HI_LIGHT = 'B';                           05570000
   558         WHEN ('REVERSE')   ATTR.HI_LIGHT = 'R';                           05580000
   559         WHEN ('ULINE')     ATTR.HI_LIGHT = 'U';                           05590000
   560                                              /* COLOR CODE */             05600000
   561         WHEN ('DEFAULT')   ATTR.COLOR = 'DEF';  /* 40 */                  05610000
   562         WHEN ('BLUE')      ATTR.COLOR = 'BLU';  /* F1 */                  05620000
   563         WHEN ('RED')       ATTR.COLOR = 'RED';  /* F2 */                  05630000
   564         WHEN ('PINK')      ATTR.COLOR = 'PNK';  /* F3 */                  05640000
   565         WHEN ('GREEN')     ATTR.COLOR = 'GRN';  /* F4 */                  05650000
   566         WHEN ('TURQ')      ATTR.COLOR = 'TUR';  /* F5 */                  05660000
   567         WHEN ('YELLOW')    ATTR.COLOR = 'YEL';  /* F6 */                  05670000
   568         WHEN ('WHITE')     ATTR.COLOR = 'WHI';  /* F7 */                  05680000
   569         WHEN ('BLACK')     ATTR.COLOR = 'BLK';  /* F8 */                  05690000
   570         WHEN ('DBLUE')     ATTR.COLOR = 'DBL';  /* F9 */                  05700000
   571         WHEN ('ORANGE')    ATTR.COLOR = 'ORA';  /* FA */                  05710000
   572         WHEN ('PURPLE')    ATTR.COLOR = 'PUR';  /* FB */                  05720000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     20


   MACRO SOURCE2 LISTING

   573         WHEN ('PGREEN')    ATTR.COLOR = 'PGR';  /* FC */                  05730000
   574         WHEN ('PTURQ')     ATTR.COLOR = 'PTQ';  /* FD */                  05740000
   575         WHEN ('GREY')      ATTR.COLOR = 'GRY';  /* FE */                  05750000
   576         WHEN ('NEUTRAL')   ATTR.COLOR = 'NEU';  /* FF */                  05760000
   577       OTHERWISE                                                           05770000
   578       DO;                                                                 05780000
   579          PUT SKIP EDIT('*** INVALID ATTRIBUTE ''',AT,''' DETECTED ***')   05790000
   580                       (A,A,A);                                            05800000
   581          ERROR_FOUND = TRUE;                                              05810000
   582       END;                                                                05820000
   583       ENDSELECT                                                           05830000
   584     /*PUT SKIP LIST(ATTR.COLOR);*/                                        05840000
   585    END CHECK_ATTR;                                                        05850000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     21


   MACRO SOURCE2 LISTING

   586    /*********************************************************************/05860000
   587    /*                                                                   */05870000
   588    /*   THIS ROUTINE PROCESSES ALL OF THE VARS LINES.  THE GENERAL      */05880000
   589    /*   FORMAT IS:                                                      */05890000
   590    /*   R99C99=NAME123,ATTR,ATTR COMMENTS                               */05900000
   591    /*   R99C99 IS THE NAME GENERATED BY MAP3270.                        */05910000
   592    /*   NAME IS 1 TO 28 CHARACTER NAME ASSIGNED BY THE PROGRAMMER.      */05920000
   593    /*   ,ATTR IS AN ADDITIONAL OR OVERRIDE ATTRIBUTE FOR THIS FIELD.    */05930000
   594    /*         0 OR MORE ATTRS MAY BE SPECIFIED.  THE LIST ENDS WHEN     */05940000
   595    /*         THE FIRST SPACE IS ENCOUNTERED.                           */05950000
   596    /*                                                                   */05960000
   597    /*********************************************************************/05970000
   598                                                                           05980000
   599    PROCESS_VARS:PROC;                                                     05990000
   600       DECLARE (MATCH_INI_NAME,MATCH_NAME) BIT(1) ALIGNED;                 06000000
   601       DECLARE (TEMP,TEMP2)        CHAR(78) VARYING;                       06010000
   602       DECLARE (I,COMMA,BLANK,NST,NLEN) FIXED BINARY(15) ALIGNED;          06020000
   603       DECLARE (FLD_NAME_PTR)           FIXED BINARY(15) ALIGNED;          06030000
   604       IF SUBSTR(MY_REC,7,1)^='=' THEN                                     06040000
   605       DO;                                                                 06050000
   606          PUT SKIP EDIT('*** EXPECTED ''='' NOT FOUND ***') (A);           06060000
   607          ERROR_FOUND = TRUE;                                              06070000
   608          RETURN;                                                          06080000
   609       END;                                                                06090000
   610       COMMA=INDEX(MY_REC,',');                                            06100000
   611       BLANK=INDEX(MY_REC,' ');                                            06110000
   612       NST=8;                                                              06120000
   613       SELECT (TRUE);                                                      06130000
   614          WHEN (COMMA=0 & BLANK>0)  /* NO COMMA FOUND BUT A BLANK WAS */   06140000
   615              NLEN=BLANK-NST;                                              06150000
   616          WHEN (BLANK=0 & COMMA>0)    /* NO BLANK FOUND BUT A COMMA WAS */ 06160000
   617              NLEN=COMMA-NST;                                              06170000
   618          WHEN (COMMA<BLANK)    /* ATTR STARTS BEFORE BLANK       */       06180000
   619              NLEN=COMMA-NST;                                              06190000
   620          WHEN (COMMA>BLANK)    /* BLANK APPEARS BEFORE COMMA     */       06200000
   621              NLEN=BLANK-NST;                                              06210000
   622          OTHERWISE                                                        06220000
   623          DO;                                                              06230000
   624             PUT SKIP EDIT('*** LOGIC ERROR 1 ***') (A);                   06240000
   625             ERROR_FOUND = TRUE;                                           06250000
   626             RETURN;                                                       06260000
   627          END;                                                             06270000
   628       ENDSELECT                                                           06280000
   629       IF NLEN>26 THEN                                                     06290000
   630       DO;                                                                 06300000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     22


   MACRO SOURCE2 LISTING

   631          PUT SKIP EDIT('*** INCORRECT FIELD LENGTHS ***') (A);            06310000
   632          ERROR_FOUND = TRUE;                                              06320000
   633          RETURN;                                                          06330000
   634       END;                                                                06340000
   635       DO I = 1 TO VAR_CTR;                                                06350000
   636          IF VAR(I).VAR_NAME = SUBSTR(MY_REC,1,6) THEN                     06360000
   637          DO;                                                              06370000
   638              PUT SKIP EDIT('*** DUPLICATE VAR NAME ',VAR(I).VAR_NAME,     06380000
   639                           ' ***') (A,A,A);                                06390000
   640              ERROR_FOUND = TRUE;                                          06400000
   641              RETURN;                                                      06410000
   642          END;                                                             06420000
   643          IF VAR(I).VAR_FLD = SUBSTR(MY_REC,NST,NLEN) THEN                 06430000
   644          DO;                                                              06440000
   645              PUT SKIP EDIT('*** DUPLICATE VAR FIELD ',                    06450000
   646                            SUBSTR(MY_REC,NST,NLEN),' ***') (A,A,A);       06460000
   647              ERROR_FOUND = TRUE;                                          06470000
   648              RETURN;                                                      06480000
   649          END;                                                             06490000
   650       END;                                                                06500000
   651       MATCH_INI_NAME=FALSE;                                               06510000
   652       MATCH_NAME=FALSE;                                                   06520000
   653       FLD_NAME_PTR=0;                                                     06530000
   654       DO WHILE(FLD_NAME_PTR<FLD_CTR & ^MATCH_INI_NAME);                   06540000
   655          FLD_NAME_PTR=FLD_NAME_PTR+1;                                     06550000
   656          MATCH_INI_NAME =                                                 06560000
   657                (FLD(FLD_NAME_PTR).FLD_INT_NAME = SUBSTR(MY_REC,1,6));     06570000
   658       END;                                                                06580000
   659       IF MATCH_INI_NAME THEN ;                                            06590000
   660       ELSE                                                                06600000
   661       DO;                                                                 06610000
   662          PUT SKIP EDIT('*** INTERNAL NAME NOT DEFINED ',                  06620000
   663                        SUBSTR(MY_REC,1,6),                                06630000
   664                        ' ***') (A,A,A);                                   06640000
   665          ERROR_FOUND = TRUE;                                              06650000
   666          RETURN;                                                          06660000
   667       END;                                                                06670000
   668       VAR_CTR=VAR_CTR+1;                                                  06680000
   669       VAR(VAR_CTR).VAR_NAME=SUBSTR(MY_REC,1,6);                           06690000
   670       VAR(VAR_CTR).VAR_FLD=SUBSTR(MY_REC,NST,NLEN);                       06700000
   671    /* PUT SKIP DATA(VAR(VAR_CTR).VAR_FLD,NLEN); */                        06710000
   672       I=INDEX(VAR(VAR_CTR).VAR_FLD,' ');                                  06720000
   673       IF I=0 THEN ;               /* NAME HAS NO SPACES - IT IS OK */     06730000
   674       ELSE                                                                06740000
   675       IF I=1 THEN                                                         06750000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     23


   MACRO SOURCE2 LISTING

   676       DO;                                                                 06760000
   677          PUT SKIP EDIT('*** USER DEFINED NAME IS BLANK ***') (A);         06770000
   678          ERROR_FOUND = TRUE;                                              06780000
   679          RETURN;                                                          06790000
   680       END;                                                                06800000
   681       IF COMMA=0 | BLANK<COMMA THEN    /* NO ATTRIBUTES */                06810000
   682           RETURN;                                                         06820000
   683       TEMP,TEMP2 = SUBSTR(MY_REC,NST+NLEN+1);  /* GET RID OF NAME */      06830000
   684       BLANK=INDEX(TEMP,' ');                                              06840000
   685       IF BLANK>0 THEN TEMP,TEMP2=SUBSTR(TEMP,1,BLANK-1);                  06850000
   686       FLD(FLD_NAME_PTR).ATTR_A=FLD(FLD_NAME_PTR).ATTR_A||'<'||TEMP2||'>'; 06860000
   687       I=1;                                                                06870000
   688       DO WHILE(I>0);                                                      06880000
   689          I=INDEX(TEMP,',');                                               06890000
   690          IF I>0 THEN                                                      06900000
   691          DO;                                                              06910000
   692             CALL CHECK_ATTR(SUBSTR(TEMP,1,I-1),FLD(FLD_NAME_PTR).FLD_REC);06920000
   693             TEMP=SUBSTR(TEMP,I+1);                                        06930000
   694          END;                                                             06940000
   695          ELSE                                                             06950000
   696             CALL CHECK_ATTR(TEMP,FLD(FLD_NAME_PTR).FLD_REC);              06960000
   697       END;                                                                06970000
   698     /*PUT SKIP LIST ('INPUT=>',VAR_CTR,VAR(VAR_CTR).VAR_NAME,             06980000
   699                                  ''''||VAR(VAR_CTR).VAR_FLD||'''');       06990000
   700       PUT SKIP DATA (FLD(FLD_NAME_PTR));*/                                07000000
   701    END PROCESS_VARS;                                                      07010000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     24


   MACRO SOURCE2 LISTING

   702    /****************************************************************/     07020000
   703    PROCESS_SCREEN:PROC;                                                   07030000
   704                                                                           07040000
   705       DECLARE (C,I               ) FIXED BINARY(15),                      07050000
   706                K                   CHAR(1);                               07060000
   707       NO_ATTRIB = TRUE;                                                   07070000
   708       ROW = ROW + 1;                               /* COUNT ROW WE ARE  */07080000
   709       B = B + 1; SCR_IMG(B) = '* ' || MY_REC;                             07090000
   710       COL = 1;                                                            07100000
   711       FLD_A = 1;                                                          07110000
   712       DO C = 1 TO 80;                              /* PROCESS ONE BY ONE*/07120000
   713          K = SUBSTR(MY_REC,C,1);                   /* GET NEXT BYTE     */07130000
   714          DO I = 1 TO A;                            /* TEST IF ATTRIBUTE */07140000
   715             IF ATTR_TBL(I).ATTR_CHR = K THEN       /* IF WE FIND AN     */07150000
   716             DO;                                    /*  ATTRIBUTE        */07160000
   717                NO_ATTRIB = FALSE;                                         07170000
   718                IF FLD_DEF  ^= '' THEN              /* AND WE ALREADY    */07180000
   719                DO;                                                        07190000
   720                    CALL SAVE_FIELD(FLD_A);         /*  HAVE DATA        */07200000
   721                    FLD_DEF = '';                                          07210000
   722                END;                                                       07220000
   723                COL = C;                                                   07230000
   724                FLD_A = I;                                                 07240000
   725             END; /* IF */                                                 07250000
   726          END; /* DO */                                                    07260000
   727       /* IF NO_ATTRIB THEN  ;                                             07270000
   728          ELSE                                                             07280000
   729       */ DO;                                                              07290000
   730             FLD_DEF = FLD_DEF  || K;                                      07300000
   731            /*  IF SUBSTR(X,C,1)= '''' THEN DATA = DATA  ''''  */        07310000
   732          END;                                                             07320000
   733       END; /* DO */                                                       07330000
   734       IF LENGTH(FLD_DEF)>0 THEN                                           07340000
   735       DO;                                                                 07350000
   736          CALL SAVE_FIELD(FLD_A);                                          07360000
   737          FLD_DEF = '';                                                    07370000
   738       END;                                                                07380000
   739    END PROCESS_SCREEN;                                                    07390000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     25


   MACRO SOURCE2 LISTING

   740    /****************************************************************/     07400000
   741    SAVE_FIELD:PROC(I);                                                    07410000
   742       DECLARE I FIXED BINARY(15);                                         07420000
   743       DECLARE (R,C) PICTURE '99';                                         07430000
   744       FLD_CTR = FLD_CTR + 1;                                              07440000
   745       FLD(FLD_CTR).FLD_DATA = FLD_DEF;                                    07450000
   746       R=ROW;                                                              07460000
   747       C=COL;                                                              07470000
   748       FLD(FLD_CTR).FLD_INT_NAME,                                          07480000
   749       FLD(FLD_CTR).FLD_NAME = 'R'||R||'C'||C;                             07490000
   750       FLD(FLD_CTR).FLD_ROW  = ROW;                                        07500000
   751       FLD(FLD_CTR).FLD_COL  = COL;                                        07510000
   752       FLD(FLD_CTR).FLD_ATTR = I;                                          07520000
   753       FLD(FLD_CTR).FLD_REC = ATTR_TBL(I);                                 07530000
   754     /*PUT SKIP DATA(FLD(FLD_CTR));*/                                      07540000
   755    END SAVE_FIELD;                                                        07550000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     26


   MACRO SOURCE2 LISTING

   756    /*********************************************************************/07560000
   757    /*                                                                   */07570000
   758    /* PRINT_ATTR - PRINT ATTRIBUTES FOR A GIVEN FIELD                   */07580000
   759    /*                                                                   */07590000
   760    /*********************************************************************/07600000
   761    PRINT_ATTR:PROC(ATTR);                                                 07610000
   762       DECLARE ATTR LIKE ATTR_REC;                                         07620000
   763          IF ATTR.TITLE THEN                                               07630000
   764             PUT EDIT('TITLE ') (A);                                       07640000
   765                                                                           07650000
   766          IF ATTR.NUM THEN PUT EDIT('NUM ') (A);                           07660000
   767          ELSE PUT EDIT('ALPHA ') (A);                                     07670000
   768                                                                           07680000
   769          IF ATTR.PROT THEN PUT EDIT('PROT ') (A);                         07690000
   770          ELSE PUT EDIT('UNPROT ') (A);                                    07700000
   771                                                                           07710000
   772          IF ATTR.BRIGHT THEN PUT EDIT('BRIGHT ') (A);                     07720000
   773          ELSE PUT EDIT('NORMAL ') (A);                                    07730000
   774                                                                           07740000
   775          SELECT (ATTR.HI_LIGHT)                                           07750000
   776              WHEN (' ')  ;                                                07760000
   777              WHEN ('D')  PUT EDIT('HI DEFAULT ') (A);                     07770000
   778              WHEN ('U')  PUT EDIT('UNDERLINE ') (A);                      07780000
   779              WHEN ('R')  PUT EDIT('REVERSE ') (A);                        07790000
   780              WHEN ('B')  PUT EDIT('BLINK ') (A);                          07800000
   781              OTHERWISE                                                    07810000
   782              DO;                                                          07820000
   783                  PUT SKIP(2) EDIT('*** ERROR *** INVALID ATTRIBUTE ',     07830000
   784                                   'VALUE ***') (A,A);                     07840000
   785                  ERROR_FOUND = TRUE;                                      07850000
   786              END;                                                         07860000
   787          ENDSELECT                                                        07870000
   788                                                                           07880000
   789          IF ATTR.CUR  THEN PUT EDIT('CUR ') (A);                          07890000
   790                                                                           07900000
   791          IF ATTR.STOP_BIT THEN PUT EDIT('STOP ') (A);                     07910000
   792          PUT EDIT(ATTR.COLOR,' ') (A,A);                                  07920000
   793    END PRINT_ATTR;                                                        07930000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     27


   MACRO SOURCE2 LISTING

   794    /*********************************************************************/07940000
   795    /*                                                                   */07950000
   796    /* WRITE_PANEL - WRITE THE MACROS TO GENERATE THE PANEL              */07960000
   797    /*                                                                   */07970000
   798    /* IN THE MAP3270 SYSTEM, THE PANEL IS A LOAD MODULE GENERATED FROM  */07980000
   799    /* ASSEMBLER CODE GENERATED BY THIS PROGRAM.  THE PANEL HAS 3        */07990000
   800    /* SECTIONS:                                                         */08000000
   801    /*    1) INDEX TO THE  DATA STREAM, CROSS REFERENCE AND INSERT       */08010000
   802    /*       CURSOR AREAS.                                               */08020000
   803    /*    2) 3270 DATA STEAM WHICH CONTAINS THE INSERT CURSOR STUFF.     */08030000
   804    /*    3) CROSS REFERENCE WHICH MAPS THE FIELDS IN THE DATA STREAM    */08040000
   805    /*       TO THE USER MAP.                                            */08050000
   806    /*                                                                   */08060000
   807    /*********************************************************************/08070000
   808    WRITE_PANEL:PROC;                                                      08080000
   809       DECLARE M FIXED BIN(15);                                            08090000
   810       DECLARE IC_WRITTEN  BIT(1) ALIGNED;                                 08100000
   811                                                                           08110000
   812       OPEN FILE(PANEL) TITLE('MAP');                                      08120000
   813                                                                           08130000
   814       PUT FILE(PANEL) EDIT('TITLE ''PANEL ',PANEL_NAME,' ',               08140000
   815                            TITLE_STAMP,'''')     (COL(10),A,A,A,A,A)      08150000
   816                           (PANEL_SEQ)            (COL(73),P'999999V99');  08160000
   817       PANE_SEQ=PANEL_SEQ+1;                                               08170000
   818       PUT FILE(PANEL) EDIT(DT_TIME_STAMP)                    (COL(1),A)   08180000
   819                           (PANEL_SEQ)            (COL(73),P'999999V99')   08190000
   820                           (PANEL_NAME,'TSECT')            (A,COL(10),A)   08200000
   821                           (PANEL_SEQ+1)          (COL(73),P'999999V99')   08210000
   822                           ('DC    A(', PANEL_NAME||'P)' ) (COL(10),A,A)   08220000
   823                           (PANEL_SEQ+2)          (COL(73),P'999999V99')   08230000
   824                           ('DC    A(', PANEL_NAME||'M)' ) (COL(10),A,A)   08240000
   825                           (PANEL_SEQ+3)          (COL(73),P'999999V99')   08250000
   826                           ('DC    A(', PANEL_NAME||'C)' ) (COL(10),A,A)   08260000
   827                           (PANEL_SEQ+4)          (COL(73),P'999999V99');  08270000
   828       PANEL_SEQ=PANEL_SEQ+5;                                              08280000
   829       PUT FILE(PANEL)                                                     08290000
   830                  EDIT(PANEL_NAME,'TSTPAN',PANEL_SEQ)                      08300000
   831                                       (A,COL(10),A,COL(73),P'999999V99')  08310000
   832                      ('TWCC  RESET=YES,RSTMDT=YES',PANEL_SEQ+1)           08320000
   833                                         (COL(10),A,COL(73),P'999999V99'); 08330000
   834       PANEL_SEQ=PANEL_SEQ+2;                                              08340000
   835       IC_WRITTEN=FALSE;                                                   08350000
   836       M = FLD_CTR;                                                        08360000
   837       DO WHILE (M>0);                                                     08370000
   838          IF ATTR_TBL(FLD(M).FLD_ATTR).CUR THEN                            08380000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     28


   MACRO SOURCE2 LISTING

   839          DO;                                                              08390000
   840             CALL WRITE_IC(FLD(M).FLD_ROW,FLD(M).FLD_COL);                 08400000
   841             IC_WRITTEN=TRUE;                                              08410000
   842             M = 0;                                                        08420000
   843          END;                                                             08430000
   844          M=M-1;                                                           08440000
   845       END;  /* DO */                                                      08450000
   846       IF ^IC_WRITTEN THEN                                                 08460000
   847          CALL WRITE_IC(ONE,ONE);                                          08470000
   848       DO M = 1 TO FLD_CTR;                                                08480000
   849          CALL WRITE_FIELD(M);                                             08490000
   850       END;                                                                08500000
   851       PUT FILE(PANEL) EDIT('TENDPAN',PANEL_SEQ)                           08510000
   852                                       (COL(10),A,COL(73),P'999999V99');   08520000
   853       PANEL_SEQ=PANEL_SEQ+1;                                              08530000
   854    /****************************************************************/     08540000
   855    WRITE_IC:PROC(R,C);                                                    08550000
   856       DECLARE (R,C)  FIXED BIN(15);                                       08560000
   857                                                                           08570000
   858       PUT FILE(PANEL)                                                     08580000
   859                EDIT(PANEL_NAME||'C',                                      08590000
   860                            'TCMD  CMD=SBA,ROW=',R,',COL=',C,PANEL_SEQ)    08600000
   861                         (A,COL(10),A,P'99',A,P'99',COL(73),P'999999V99')  08610000
   862                    ('         TCMD  CMD=IC',PANEL_SEQ+1)                  08620000
   863                                                (A,COL(73),P'999999V99');  08630000
   864       PANEL_SEQ=PANEL_SEQ+2;                                              08640000
   865                                                                           08650000
   866    END WRITE_IC;                                                          08660000
   867    /****************************************************************/     08670000
   868    WRITE_FIELD:PROC(F);                                                   08680000
   869       DECLARE F FIXED BIN(15);                                            08690000
   870       DECLARE A FIXED BIN(15);                                            08700000
   871       DECLARE I FIXED BIN(15);                                            08710000
   872       DECLARE MACRO_LN CHAR(160) VARYING;                                 08720000
   873       DECLARE LN_PIC   PIC '99';                                          08730000
   874       DECLARE FLD_NAME CHAR(8) VARYING;   /* FORMAT R99C99 */             08740000
   875       A = FLD(F).FLD_ATTR;                                                08750000
   876     /*****                                                                08760000
   877       PUT SKIP DATA(FLD(F));                                              08770000
   878       PUT SKIP DATA(ATTR_TBL(A));                                         08780000
   879     *****/                                                                08790000
   880       FLD_DEF=SUBSTR(FLD(F).FLD_DATA,2);                                  08800000
   881       I = LENGTH(FLD_DEF);                                                08810000
   882       DO WHILE(SUBSTR(FLD_DEF,I,1)=' ' & I>0);                            08820000
   883          I=I-1;                                                           08830000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     29


   MACRO SOURCE2 LISTING

   884       END;                                                                08840000
   885       IF I=0 THEN FLD_DEF='';                                             08850000
   886       ELSE FLD_DEF=SUBSTR(FLD_DEF,1,I);                                   08860000
   887    /* PUT SKIP DATA(FLD_DEF); */                                          08870000
   888       /* MAKE SURE THAT FIELDS DON'T GO PAST COL 80 */                    08880000
   889       IF LENGTH(FLD_DEF)+FLD(F).FLD_COL   > 80 THEN                       08890000
   890       DO;                                                                 08900000
   891          PUT SKIP EDIT('*** ERROR PROCESSING ROW ',FLD(F).FLD_ROW,        08910000
   892                        ' COL ',FLD(F).FLD_COL,': FIELD EXCEEDS COL 80')   08920000
   893                        (A,F(3),A,F(3),A);                                 08930000
   894          RETURN;                                                          08940000
   895       END;                                                                08950000
   896       FLD_NAME = SUBSTR(FLD(F).FLD_INT_NAME||(6)' ',1,6);                 08960000
   897       PUT FILE(PANEL)                                                     08970000
   898           SKIP EDIT('TCMD  CMD=SBA,ROW=',                                 08980000
   899                                   FLD(F).FLD_ROW,',COL=',                 08990000
   900                                   FLD(F).FLD_COL,PANEL_SEQ)               09000000
   901                    (COL(10),A,P'99',A,P'99',COL(73),P'999999V99');        09010000
   902       PANEL_SEQ=PANEL_SEQ+1;                                              09020000
   903       LN_PIC = LENGTH(FLD_DEF);                                           09030000
   904       IF LN_PIC = '00' | ATTR_TBL(A).TITLE THEN                           09040000
   905          MACRO_LN = '         TCMD  CMD=SF,MDT=NO';                       09050000
   906       ELSE                                                                09060000
   907       DO;                                                                 09070000
   908          MACRO_LN = FLD_NAME ||'   TCMD  CMD=SF,MDT=YES,LN=' || LN_PIC;   09080000
   909          PUT SKIP FILE(PANEL) EDIT ('***',FLD(F).FLD_NAME,PANEL_SEQ)      09090000
   910                                    (A,A,COL(73),P'999999V99');            09100000
   911          PANEL_SEQ=PANEL_SEQ+1;                                           09110000
   912       END;                                                                09120000
   913       IF FLD(F).PROT THEN                                                 09130000
   914           MACRO_LN = MACRO_LN || ',PROT=YES';                             09140000
   915       ELSE                                                                09150000
   916           MACRO_LN = MACRO_LN || ',PROT=NO';                              09160000
   917       IF FLD(F).BRIGHT THEN                                               09170000
   918           MACRO_LN = MACRO_LN || ',BRIGHT=YES';                           09180000
   919       ELSE                                                                09190000
   920           MACRO_LN = MACRO_LN || ',BRIGHT=NO';                            09200000
   921       IF FLD(F).NUM THEN                                                  09210000
   922           MACRO_LN = MACRO_LN || ',NUM=YES';                              09220000
   923       ELSE                                                                09230000
   924           MACRO_LN = MACRO_LN || ',NUM=NO';                               09240000
   925       IF FLD(F).STOP_BIT &                                                09250000
   926          LENGTH(FLD_DEF)+FLD(F).FLD_COL < 80 THEN                         09260000
   927           MACRO_LN = MACRO_LN || ',STOP=YES';                             09270000
   928       ELSE                                                                09280000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     30


   MACRO SOURCE2 LISTING

   929           MACRO_LN = MACRO_LN || ',STOP=NO';                              09290000

   930                                                                           09300000
   931       IF FLD(F).HI_LIGHT ^= ' ' | FLD(F).COLOR ^= ' ' THEN                09310000
   932       DO;                                                                 09320000
   933          MACRO_LN = MACRO_LN || ',';                                      09330000
   934          PUT FILE(PANEL)                                                  09340000
   935                  EDIT(MACRO_LN,'*',PANEL_SEQ) (A,COL(72),A,P'999999V99'); 09350000
   936          PANEL_SEQ=PANEL_SEQ+1;                                           09360000
   937          MACRO_LN = (15)' ';                                              09370000
   938          IF FLD(F).HI_LIGHT = 'U' THEN                                    09380000
   939             MACRO_LN = MACRO_LN || 'HILITE=ULN';                          09390000
   940          ELSE                                                             09400000
   941          IF FLD(F).HI_LIGHT = 'R' THEN                                    09410000
   942             MACRO_LN = MACRO_LN || 'HILITE=REV';                          09420000
   943          ELSE                                                             09430000
   944          IF FLD(F).HI_LIGHT = 'B' THEN                                    09440000
   945             MACRO_LN = MACRO_LN || 'HILITE=BLN';                          09450000
   946          ELSE                                                             09460000
   947          IF FLD(F).HI_LIGHT = 'D' THEN                                    09470000
   948             MACRO_LN = MACRO_LN || 'HILITE=DEF';                          09480000
   949          IF FLD(F).HI_LIGHT ^= ' ' & FLD(F).COLOR ^= ' ' THEN             09490000
   950             MACRO_LN = MACRO_LN || ',';                                   09500000
   951          IF FLD(F).COLOR ^= ' ' THEN                                      09510000
   952             MACRO_LN = MACRO_LN || 'COLOR=' || FLD(F).COLOR;              09520000
   953       END;                                                                09530000

   954                                                                           09540000
   955       IF LN_PIC = '00' THEN                                               09550000
   956       DO;                                                                 09560000
   957          PUT FILE(PANEL)                                                  09570000
   958                   EDIT(MACRO_LN,PANEL_SEQ) (A,COL(73),P'999999V99');      09580000
   959          PANEL_SEQ=PANEL_SEQ+1;                                           09590000
   960       END;                                                                09600000
   961       ELSE                                                                09610000
   962       DO;                                                                 09620000
   963          MACRO_LN = MACRO_LN || ',';                                      09630000
   964          PUT FILE(PANEL)                                                  09640000
   965                  EDIT(MACRO_LN,'*',PANEL_SEQ) (A,COL(72),A,P'999999V99'); 09650000
   966          PANEL_SEQ=PANEL_SEQ+1;                                           09660000
   967          MACRO_LN = (15)' ' ||'DATA='''||FLD_DEF||'''';                   09670000
   968          IF LENGTH(MACRO_LN)>71 THEN                                      09680000
   969          DO;                                                              09690000
   970             PUT FILE(PANEL)                                               09700000
   971                      EDIT(MACRO_LN,'*',PANEL_SEQ) (A(71),A,P'999999V99')  09710000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     31


   MACRO SOURCE2 LISTING

   972                        (SUBSTR(MACRO_LN,72),PANEL_SEQ+1)                  09720000
   973                                             (COL(16),A(57),P'999999V99'); 09730000
   974             PANEL_SEQ=PANEL_SEQ+2;                                        09740000
   975          END;                                                             09750000
   976          ELSE                                                             09760000
   977          DO;                                                              09770000
   978             PUT FILE(PANEL)                                               09780000
   979                      EDIT(MACRO_LN,PANEL_SEQ) (A,COL(73),P'999999V99');   09790000
   980          PANEL_SEQ=PANEL_SEQ+1;                                           09800000
   981          END;                                                             09810000
   982       END;                                                                09820000
   983       FLD_DEF='';                                                         09830000
   984    END WRITE_FIELD;                                                       09840000
   985    END WRITE_PANEL;                                                       09850000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     32


   MACRO SOURCE2 LISTING

   986    /*********************************************************************/09860000
   987    /*                                                                   */09870000
   988    /* WRITE_MAPPING - WRITE THE PANEL TO USER FIELD MAPPING             */09880000
   989    /*                                                                   */09890000
   990    /*********************************************************************/09900000
   991    WRITE_MAPPING:PROC;                                                    09910000
   992       DECLARE M FIXED BIN(15);                                            09920000
   993       PUT FILE(PANEL)                                                     09930000
   994                  EDIT(PANEL_NAME||'M','TINPST') (A,COL(10),A)             09940000
   995                      (PANEL_SEQ) (COL(73),P'999999V99');                  09950000
   996       PANEL_SEQ=PANEL_SEQ+1;                                              09960000
   997       DO M = 1 TO FLD_CTR;                                                09970000
   998          CALL WRITE_FIELD(M);                                             09980000
   999       END;                                                                09990000
  1000       PUT FILE(PANEL)                                                     10000000
  1001               EDIT('TINPEND',PANEL_SEQ) (COL(10),A,COL(73),P'999999V99'); 10010000
  1002       PANEL_SEQ=PANEL_SEQ+1;                                              10020000
  1003       PUT FILE(PANEL) EDIT(DT_TIME_STAMP)                    (COL(1),A)   10030000
  1004                           (PANEL_SEQ)            (COL(73),P'999999V99');  10040000
  1005       PANEL_SEQ=PANEL_SEQ+1;                                              10050000
  1006    /****************************************************************/     10060000
  1007    WRITE_FIELD:PROC(F);                                                   10070000
  1008       DECLARE F FIXED BIN(15);                                            10080000
  1009       DECLARE A FIXED BIN(15);                                            10090000
  1010       DECLARE MACRO_LN CHAR(160) VARYING;                                 10100000
  1011       DECLARE FLD_DEF  CHAR(160) VARYING;                                 10110000
  1012       DECLARE FLD_NAME CHAR(8)  VARYING;   /* FORMAT R99C99 */            10120000
  1013       A = FLD(F).FLD_ATTR;                                                10130000
  1014     /*****                                                                10140000
  1015       PUT SKIP DATA(FLD(F));                                              10150000
  1016       PUT SKIP DATA(ATTR_TBL(A));                                         10160000
  1017     *****/                                                                10170000
  1018       FLD_DEF=SUBSTR(FLD(F).FLD_DATA,2);                                  10180000
  1019       I = LENGTH(FLD_DEF);                                                10190000
  1020       DO WHILE(SUBSTR(FLD_DEF,I,1)=' ' & I>0);                            10200000
  1021          I=I-1;                                                           10210000
  1022       END;                                                                10220000
  1023       IF I=0 THEN FLD_DEF='';                                             10230000
  1024       ELSE FLD_DEF=SUBSTR(FLD_DEF,1,I);                                   10240000
  1025       IF ^ATTR_TBL(A).TITLE THEN                                          10250000
  1026       DO;                                                                 10260000
  1027          PUT FILE(PANEL)                                                  10270000
  1028                   EDIT(FLD(F).FLD_INT_NAME) (A)                           10280000
  1029                       ('TINPMAP ',FLD(F).FLD_ROW,',') (COL(10),A,P'99',A) 10290000
  1030                                  (FLD(F).FLD_COL,',',                     10300000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     33


   MACRO SOURCE2 LISTING

  1031                                   LENGTH(FLD_DEF)) (P'99',A,P'99')        10310000
  1032                                  (FLD(F).FLD_NAME) (COL(40),A)            10320000
  1033                         (PANEL_SEQ) (COL(73),P'999999V99');               10330000
  1034          PANEL_SEQ=PANEL_SEQ+1;                                           10340000
  1035       END;                                                                10350000
  1036    END WRITE_FIELD;                                                       10360000
  1037    END WRITE_MAPPING;                                                     10370000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     34


   MACRO SOURCE2 LISTING

  1038    /*********************************************************************/10380000
  1039    /*                                                                   */10390000
  1040    /* WRITE_ASM - GENERATE THE USER COMM AREA - ASSEMBLER FORMAT        */10400000
  1041    /*                                                                   */10410000
  1042    /*********************************************************************/10420000
  1043    WRITE_ASM:PROC;                                                        10430000
  1044       DECLARE SEQ_NO            FIXED DEC(8,2) INIT(9);                   10440000
  1045       PUT FILE(ASM)  EDIT                                                 10450000
  1046           (DT_TIME_STAMP,1)               (COL(1),A,COL(73),P'999999V99') 10460000
  1047           ('TPARM    DS    0F',2)                (A,COL(73),P'999999V99') 10470000
  1048           ('TNAME    DC    CL8''',PANEL_NAME,'''',3)                      10480000
  1049                                                       (A,A,A,COL(73),     10490000
  1050                                                             P'999999V99') 10500000
  1051           ('TADDR    DC    A(0)',4)                   (A,COL(73),         10510000
  1052                                                             P'999999V99') 10520000
  1053           ('TRC      DC    H''0''',5)                 (A,COL(73),         10530000
  1054                                                             P'999999V99') 10540000
  1055           ('TAID     DC    X''0''',6)                 (A,COL(73),         10550000
  1056                                                             P'999999V99') 10560000
  1057           ('TSBA     DC    XL2''0000''',7)            (A,COL(73),         10570000
  1058                                                             P'999999V99') 10580000
  1059           ('         DC    X''0''',8)                 (A,COL(73),         10590000
  1060                                                             P'999999V99');10600000
  1061       DO M = 1 TO FLD_CTR;                                                10610000
  1062          CALL WRITE_PARM(M);                                              10620000
  1063       END;                                                                10630000
  1064       PUT FILE(ASM) EDIT                                                  10640000
  1065           ('         DC    C'' ''',SEQ_NO)       (A,COL(73),P'999999V99') 10650000
  1066           ('         DC    AL2(0)',SEQ_NO+1)     (A,COL(73),P'999999V99') 10660000
  1067           (DT_TIME_STAMP,SEQ_NO+2)        (COL(1),A,COL(73),P'999999V99');10670000
  1068       SEQ_NO=SEQ_NO+3;                                                    10680000
  1069    WRITE_PARM:PROC(F);                                                    10690000
  1070       DECLARE F FIXED BIN(15);                                            10700000
  1071       DECLARE A FIXED BIN(15);                                            10710000
  1072       DECLARE I FIXED BIN(15);                                            10720000
  1073       DECLARE MACRO_LN CHAR(160) VARYING;                                 10730000
  1074       DECLARE LN_PIC   PIC '99';                                          10740000
  1075       DECLARE FLD_DEF  CHAR(160) VARYING;                                 10750000
  1076       DECLARE FLD_NAME CHAR(160) VARYING;                                 10760000
  1077       A = FLD(F).FLD_ATTR;                                                10770000
  1078     /*****                                                                10780000
  1079       PUT SKIP DATA(FLD(F));                                              10790000
  1080       PUT SKIP DATA(ATTR_TBL(A));                                         10800000
  1081     *****/                                                                10810000
  1082       FLD_DEF=SUBSTR(FLD(F).FLD_DATA,2);                                  10820000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     35


   MACRO SOURCE2 LISTING

  1083       I = LENGTH(FLD_DEF);                                                10830000
  1084       DO WHILE(SUBSTR(FLD_DEF,I,1)=' ' & I>0);                            10840000
  1085          I=I-1;                                                           10850000
  1086       END;                                                                10860000
  1087       IF I=0 THEN FLD_DEF='';                                             10870000
  1088       ELSE FLD_DEF=SUBSTR(FLD_DEF,1,I);                                   10880000
  1089       /* MAKE SURE THAT FIELDS DON'T GO PAST COL 80 */                    10890000
  1090       IF LENGTH(FLD_DEF)+FLD(F).FLD_COL   > 80 THEN                       10900000
  1091       DO;                                                                 10910000
  1092          PUT SKIP EDIT('*** ERROR PROCESSING ROW ',FLD(F).FLD_ROW,        10920000
  1093                        ' COL ',FLD(F).FLD_COL,': FIELD EXCEEDS COL 80')   10930000
  1094                        (A,F(3),A,F(3),A);                                 10940000
  1095          RETURN;                                                          10950000
  1096       END;                                                                10960000
  1097       FLD_NAME = FLD(F).FLD_INT_NAME;                                     10970000
  1098       LN_PIC = LENGTH(FLD_DEF);                                           10980000
  1099       IF LN_PIC ^= '00' & ^ATTR_TBL(A).TITLE THEN                         10990000
  1100       DO;                                                                 11000000
  1101          PUT FILE(ASM) EDIT                                               11010000
  1102                  (FLD_NAME||'C','DC    C'' ''',FLD(F).FLD_NAME,SEQ_NO)    11020000
  1103                              (A,COL(10),A,COL(40),A,COL(73),P'999999V99') 11030000
  1104                  (FLD_NAME||'L','DC    AL2(',LN_PIC,')',SEQ_NO+1)         11040000
  1105                                    (A,COL(10),A,A,A,COL(73),P'999999V99');11050000
  1106          SEQ_NO=SEQ_NO+2;                                                 11060000
  1107          MACRO_LN = SUBSTR(FLD_NAME||'D        ',1,9)                     11070000
  1108                             ||  'DC    CL' || LN_PIC                      11080000
  1109                                               || ''''||FLD_DEF||'''';     11090000
  1110          IF LENGTH(MACRO_LN)>71 THEN                                      11100000
  1111          DO;                                                              11110000
  1112             PUT FILE(ASM)                                                 11120000
  1113                      EDIT(MACRO_LN,'*',SEQ_NO) (A(71),A,P'999999V99')     11130000
  1114                        (SUBSTR(MACRO_LN,72),SEQ_NO+1)                     11140000
  1115                           (COL(16),A(57),P'999999V99');                   11150000
  1116             SEQ_NO=SEQ_NO+2;                                              11160000
  1117          END;                                                             11170000
  1118          ELSE                                                             11180000
  1119          DO;                                                              11190000
  1120             PUT FILE(ASM)                                                 11200000
  1121                      EDIT(MACRO_LN,SEQ_NO) (A(72),P'999999V99');          11210000
  1122             SEQ_NO=SEQ_NO+1;                                              11220000
  1123           END;                                                            11230000
  1124       END;                                                                11240000
  1125       FLD_DEF='';                                                         11250000
  1126    END WRITE_PARM;                                                        11260000
  1127    END WRITE_ASM;                                                         11270000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     36


   MACRO SOURCE2 LISTING

  1128    /*********************************************************************/11280000
  1129    /*                                                                   */11290000
  1130    /* WRITE_COB - GENERATE THE USER COMM AREA FOR COBOL                 */11300000
  1131    /*                                                                   */11310000
  1132    /*********************************************************************/11320000
  1133    WRITE_COB:PROC;                                                        11330000
  1134       DECLARE SEQ_NO      FIXED DEC(8,2)  INIT(9);                        11340000
  1135       PUT FILE(COB)                                                       11350000
  1136                  EDIT(DT_TIME_STAMP) (COL(7),A)                           11360000
  1137                      (1)                           (COL(73),P'999999V99') 11370000
  1138                      ('01  ',PANEL_NAME,'-PARM.')  (COL(8),A,A,A)         11380000
  1139                      (2)                           (COL(73),P'999999V99') 11390000
  1140                      ('05  ',PANEL_NAME,'-NAME','PIC X(8) VALUE ''',      11400000
  1141                              PANEL_NAME,'''.')                            11410000
  1142                                             (COL(12),(3)A,COL(47),(3)A)   11420000
  1143                      (3)                           (COL(73),P'999999V99') 11430000
  1144                      ('05  FILLER','PIC S9(8) COMP VALUE ZERO.')          11440000
  1145                                             (COL(12),A,COL(47),A)         11450000
  1146                      (4)                           (COL(73),P'999999V99') 11460000
  1147                      ('05  ',PANEL_NAME,'-RET','PIC S9(4) COMP.')         11470000
  1148                                             (COL(12),A,A,A,COL(47),A)     11480000
  1149                      (5)                           (COL(73),P'999999V99') 11490000
  1150                      ('05  ',PANEL_NAME,'-AID','PIC X.')                  11500000
  1151                                             (COL(12),A,A,A,COL(47),A)     11510000
  1152                      (6)                           (COL(73),P'999999V99') 11520000
  1153                      ('05  ',PANEL_NAME,'-SBA','PIC XX.')                 11530000
  1154                                             (COL(12),A,A,A,COL(47),A)     11540000
  1155                      (7)                           (COL(73),P'999999V99') 11550000
  1156                      ('05  FILLER','PIC X.')                              11560000
  1157                                             (COL(12),A,COL(47),A)         11570000
  1158                      (8)                           (COL(73),P'999999V99');11580000
  1159       DO M = 1 TO FLD_CTR;                                                11590000
  1160          CALL WRITE_PARM(M);                                              11600000
  1161       END;                                                                11610000
  1162       PUT FILE(COB)                                                       11620000
  1163                   EDIT('05','FILLER.')                                    11630000
  1164                                     (COL(12),A,COL(16),A)                 11640000
  1165                       (SEQ_NO)                   (COL(73),P'999999V99');  11650000
  1166       SEQ_NO=SEQ_NO+1;                                                    11660000
  1167       PUT FILE(COB)                                                       11670000
  1168                   EDIT('10','FILLER','PIC X(01) VALUE '' ''.')            11680000
  1169                                     (COL(16),A,COL(20),A,COL(47),A)       11690000
  1170                       (SEQ_NO)                   (COL(73),P'999999V99');  11700000
  1171       SEQ_NO=SEQ_NO+1;                                                    11710000
  1172       PUT FILE(COB)                                                       11720000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     37


   MACRO SOURCE2 LISTING

  1173                   EDIT('10','FILLER','PIC S9(4) VALUE ZERO COMP.')        11730000
  1174                                     (COL(16),A,COL(20),A,COL(47),A)       11740000
  1175                       (SEQ_NO)                   (COL(73),P'999999V99');  11750000
  1176       SEQ_NO=SEQ_NO+1;                                                    11760000
  1177    WRITE_PARM:PROC(F);                                                    11770000
  1178       DECLARE F FIXED BIN(15);                                            11780000
  1179       DECLARE A FIXED BIN(15);                                            11790000
  1180       DECLARE I FIXED BIN(15);                                            11800000
  1181       DECLARE T FIXED BIN(15);                                            11810000
  1182       DECLARE MACRO_LN CHAR(160) VARYING;                                 11820000
  1183       DECLARE LN_PIC   PIC '99';                                          11830000
  1184       DECLARE FLD_DEF  CHAR(99) VARYING;                                  11840000
  1185       DECLARE FLD_NAME CHAR(99) VARYING;                                  11850000
  1186       A = FLD(F).FLD_ATTR;                                                11860000
  1187     /*****                                                                11870000
  1188       PUT SKIP DATA(FLD(F));                                              11880000
  1189       PUT SKIP DATA(ATTR_TBL(A));                                         11890000
  1190     *****/                                                                11900000
  1191       FLD_DEF=SUBSTR(FLD(F).FLD_DATA,2);                                  11910000
  1192       I = LENGTH(FLD_DEF);                                                11920000
  1193       DO WHILE(SUBSTR(FLD_DEF,I,1)=' ' & I>0);                            11930000
  1194          I=I-1;                                                           11940000
  1195       END;                                                                11950000
  1196       IF I=0 THEN FLD_DEF='';                                             11960000
  1197       ELSE FLD_DEF=SUBSTR(FLD_DEF,1,I);                                   11970000
  1198       /* MAKE SURE THAT FIELDS DON'T GO PAST COL 80 */                    11980000
  1199       IF LENGTH(FLD_DEF)+FLD(F).FLD_COL   > 80 THEN                       11990000
  1200       DO;                                                                 12000000
  1201          PUT SKIP EDIT('*** ERROR PROCESSING ROW ',FLD(F).FLD_ROW,        12010000
  1202                        ' COL ',FLD(F).FLD_COL,': FIELD EXCEEDS COL 80')   12020000
  1203                        (A,F(3),A,F(3),A);                                 12030000
  1204          RETURN;                                                          12040000
  1205       END;                                                                12050000
  1206       FLD_NAME = FLD(F).FLD_NAME;                                         12060000
  1207       DO T=1 TO LENGTH(FLD_NAME);                                         12070000
  1208          IF SUBSTR(FLD_NAME,T,1)='_' THEN                                 12080000
  1209             SUBSTR(FLD_NAME,T,1)='-';                                     12090000
  1210       END;                                                                12100000
  1211       LN_PIC = LENGTH(FLD_DEF);                                           12110000
  1212       IF LN_PIC ^= '00' & ^ATTR_TBL(A).TITLE THEN                         12120000
  1213       DO;                                                                 12130000
  1214          PUT FILE(COB)                                                    12140000
  1215                   EDIT('05',FLD_NAME,'.')                                 12150000
  1216                                     (COL(12),A,COL(16),A,A)               12160000
  1217                       (SEQ_NO)                   (COL(73),P'999999V99');  12170000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     38


   MACRO SOURCE2 LISTING

  1218          SEQ_NO=SEQ_NO+1;                                                 12180000
  1219          PUT FILE(COB)                                                    12190000
  1220                   EDIT('10',FLD_NAME||'-C','PIC X(01) VALUE '' ''.')      12200000
  1221                                     (COL(16),A,COL(20),A,COL(47),A)       12210000
  1222                       (SEQ_NO)                   (COL(73),P'999999V99');  12220000
  1223          SEQ_NO=SEQ_NO+1;                                                 12230000
  1224          PUT FILE(COB)                                                    12240000
  1225                   EDIT('10',FLD_NAME||'-L','PIC S9(4) VALUE ',            12250000
  1226                                               LENGTH(FLD_DEF),' COMP.')   12260000
  1227                                (COL(16),A,COL(20),A,COL(47),A,P'SS9',A)   12270000
  1228                       (SEQ_NO)                   (COL(73),P'999999V99');  12280000
  1229          SEQ_NO=SEQ_NO+1;                                                 12290000
  1230          PUT FILE(COB)                                                    12300000
  1231                   EDIT('10',FLD_NAME||'-D','PIC X(',LN_PIC,')')           12310000
  1232                       (COL(16),A,COL(20),A,COL(47),A,A,A);                12320000
  1233          IF LENGTH(FLD_DEF) <= 6  THEN                                    12330000
  1234          DO;                                                              12340000
  1235              PUT FILE(COB) EDIT(' VALUE ''',FLD_DEF,'''.') (A,A,A)        12350000
  1236                       (SEQ_NO)                   (COL(73),P'999999V99');  12360000
  1237              SEQ_NO=SEQ_NO+1;                                             12370000
  1238          END;                                                             12380000
  1239          ELSE                                                             12390000
  1240          DO;                                                              12400000
  1241              PUT FILE(COB) EDIT(' VALUE',SEQ_NO) (A,COL(73),P'999999V99');12410000
  1242              SEQ_NO=SEQ_NO+1;                                             12420000
  1243              MACRO_LN = '''' || FLD_DEF || '''.';                         12430000
  1244              IF LENGTH(MACRO_LN)>56 THEN                                  12440000
  1245              DO;                                                          12450000
  1246                 PUT FILE(COB)                                             12460000
  1247                          EDIT(MACRO_LN) (COL(16),A(57))                   12470000
  1248                           (SEQ_NO) (P'999999V99')                         12480000
  1249                            ('-','''',SUBSTR(MACRO_LN,58))                 12490000
  1250                                     (COL(7),A,COL(16),A,A)                12500000
  1251                           (SEQ_NO+1) (COL(73),P'999999V99');              12510000
  1252                 SEQ_NO=SEQ_NO+2;                                          12520000
  1253              END;                                                         12530000
  1254              ELSE                                                         12540000
  1255              DO;                                                          12550000
  1256                 PUT FILE(COB)                                             12560000
  1257                     EDIT(MACRO_LN,SEQ_NO) (COL(16),A(57),P'999999V99');   12570000
  1258                 SEQ_NO=SEQ_NO+1;                                          12580000
  1259              END;                                                         12590000
  1260          END;                                                             12600000
  1261       FLD_DEF='';                                                         12610000
  1262    END WRITE_PARM;                                                        12620000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     39


   MACRO SOURCE2 LISTING

  1263    END WRITE_COB;                                                         12630000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     40


   MACRO SOURCE2 LISTING

  1264    /*********************************************************************/12640000
  1265    /*                                                                   */12650000
  1266    /* WRITE_PL1 - GENERATE THE USER COMM AREA FOR PL1                   */12660000
  1267    /*                                                                   */12670000
  1268    /*********************************************************************/12680000
  1269    WRITE_PL1:PROC;                                                        12690000
  1270       DECLARE SEQ_NO      FIXED DEC(8,2)  INIT(9);                        12700000
  1271       PUT FILE(PL1)                                                       12710000
  1272                  EDIT('/* ',DT_TIME_STAMP, ' ** */') (COL(2),A,A,A)       12720000
  1273                      (1)                           (COL(73),P'999999V99') 12730000
  1274                      ('DCL 1 ',PANEL_NAME,'_PARM  UNALIGNED,')            12740000
  1275                                                      (COL(6),A,A,A)       12750000
  1276                      (2)                           (COL(73),P'999999V99') 12760000
  1277                      ('5 ',PANEL_NAME,'_NAME','CHAR(8) INIT(''',          12770000
  1278                              PANEL_NAME,'''),')                           12780000
  1279                                             (COL(12),(3)A,COL(47),(3)A)   12790000
  1280                      (3)                           (COL(73),P'999999V99') 12800000
  1281                      ('5 FILLER1','FIXED BIN(31) INIT(0),')               12810000
  1282                                             (COL(12),A,COL(47),A)         12820000
  1283                      (4)                           (COL(73),P'999999V99') 12830000
  1284                      ('5 ',PANEL_NAME,'_RET','FIXED BIN(15) INIT(0),')    12840000
  1285                                             (COL(12),A,A,A,COL(47),A)     12850000
  1286                      (5)                           (COL(73),P'999999V99') 12860000
  1287                      ('5 ',PANEL_NAME,'_AID','CHAR(1) INIT('' ''),')      12870000
  1288                                             (COL(12),A,A,A,COL(47),A)     12880000
  1289                      (6)                           (COL(73),P'999999V99') 12890000
  1290                      ('5 ',PANEL_NAME,'_SBA','FIXED BIN(15) INIT(0),')    12900000
  1291                                             (COL(12),A,A,A,COL(47),A)     12910000
  1292                      (7)                           (COL(73),P'999999V99') 12920000
  1293                      ('5 FILLER2','CHAR(1),')                             12930000
  1294                                             (COL(12),A,COL(47),A)         12940000
  1295                      (8)                           (COL(73),P'999999V99');12950000
  1296       DO M = 1 TO FLD_CTR;                                                12960000
  1297          CALL WRITE_PARM(M);                                              12970000
  1298       END;                                                                12980000
  1299       PUT FILE(PL1)                                                       12990000
  1300                   EDIT('5 E_O_T_1,')                                      13000000
  1301                                              (COL(12),A)                  13010000
  1302                       (SEQ_NO)                   (COL(73),P'999999V99');  13020000
  1303       SEQ_NO=SEQ_NO+1;                                                    13030000
  1304       PUT FILE(PL1)                                                       13040000
  1305                   EDIT('10 E_O_T_2','CHAR(1) INIT('' ''),')               13050000
  1306                                     (COL(16),A,COL(47),A)                 13060000
  1307                       (SEQ_NO)                   (COL(73),P'999999V99');  13070000
  1308       SEQ_NO=SEQ_NO+1;                                                    13080000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     41


   MACRO SOURCE2 LISTING

  1309       PUT FILE(PL1)                                                       13090000
  1310                   EDIT('10 E_O_T_3','FIXED BIN(15) INIT(0);')             13100000
  1311                                     (COL(16),A,COL(47),A)                 13110000
  1312                       (SEQ_NO)                   (COL(73),P'999999V99');  13120000
  1313       SEQ_NO=SEQ_NO+1;                                                    13130000
  1314    WRITE_PARM:PROC(F);                                                    13140000
  1315       DECLARE F FIXED BIN(15);                                            13150000
  1316       DECLARE A FIXED BIN(15);                                            13160000
  1317       DECLARE I FIXED BIN(15);                                            13170000
  1318       DECLARE T FIXED BIN(15);                                            13180000
  1319       DECLARE MACRO_LN CHAR(160) VARYING;                                 13190000
  1320       DECLARE LN_PIC   PIC '99';                                          13200000
  1321       DECLARE FLD_DEF  CHAR(99) VARYING;                                  13210000
  1322       DECLARE FLD_NAME CHAR(99) VARYING;                                  13220000
  1323       A = FLD(F).FLD_ATTR;                                                13230000
  1324     /*****                                                                13240000
  1325       PUT SKIP DATA(FLD(F));                                              13250000
  1326       PUT SKIP DATA(ATTR_TBL(A));                                         13260000
  1327     *****/                                                                13270000
  1328       FLD_DEF=SUBSTR(FLD(F).FLD_DATA,2);                                  13280000
  1329       I = LENGTH(FLD_DEF);                                                13290000
  1330       DO WHILE(SUBSTR(FLD_DEF,I,1)=' ' & I>0);                            13300000
  1331          I=I-1;                                                           13310000
  1332       END;                                                                13320000
  1333       IF I=0 THEN FLD_DEF='';                                             13330000
  1334       ELSE FLD_DEF=SUBSTR(FLD_DEF,1,I);                                   13340000
  1335       /* MAKE SURE THAT FIELDS DON'T GO PAST COL 80 */                    13350000
  1336       IF LENGTH(FLD_DEF)+FLD(F).FLD_COL   > 80 THEN                       13360000
  1337       DO;                                                                 13370000
  1338          PUT SKIP EDIT('*** ERROR PROCESSING ROW ',FLD(F).FLD_ROW,        13380000
  1339                        ' COL ',FLD(F).FLD_COL,': FIELD EXCEEDS COL 80')   13390000
  1340                        (A,F(3),A,F(3),A);                                 13400000
  1341          RETURN;                                                          13410000
  1342       END;                                                                13420000
  1343       FLD_NAME = FLD(F).FLD_NAME;                                         13430000
  1344       DO T=1 TO LENGTH(FLD_NAME);                                         13440000
  1345          IF SUBSTR(FLD_NAME,T,1)='-' THEN                                 13450000
  1346             SUBSTR(FLD_NAME,T,1)='_';                                     13460000
  1347       END;                                                                13470000
  1348       LN_PIC = LENGTH(FLD_DEF);                                           13480000
  1349       IF LN_PIC ^= '00' & ^ATTR_TBL(A).TITLE THEN                         13490000
  1350       DO;                                                                 13500000
  1351          PUT FILE(PL1)                                                    13510000
  1352                   EDIT('5 ',FLD_NAME,',')                                 13520000
  1353                                     (COL(12),A,A,A)                       13530000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     42


   MACRO SOURCE2 LISTING

  1354                       (SEQ_NO)                   (COL(73),P'999999V99');  13540000
  1355          SEQ_NO=SEQ_NO+1;                                                 13550000
  1356          PUT FILE(PL1)                                                    13560000
  1357                   EDIT('10 ',FLD_NAME||'_C','CHAR(1) INIT('' ''),')       13570000
  1358                                     (COL(16),A,A,COL(47),A)               13580000
  1359                       (SEQ_NO)                   (COL(73),P'999999V99');  13590000
  1360          SEQ_NO=SEQ_NO+1;                                                 13600000
  1361          PUT FILE(PL1)                                                    13610000
  1362                   EDIT('10 ',FLD_NAME||'_L','FIXED BIN(15) INIT(',        13620000
  1363                                               LENGTH(FLD_DEF),'),')       13630000
  1364                                (COL(16),A,A,COL(47),A,P'Z9',A)            13640000
  1365                       (SEQ_NO)                   (COL(73),P'999999V99');  13650000
  1366          SEQ_NO=SEQ_NO+1;                                                 13660000
  1367          PUT FILE(PL1)                                                    13670000
  1368                   EDIT('10 ',FLD_NAME||'_D','CHAR(',LN_PIC,')')           13680000
  1369                       (COL(16),A,A,COL(47),A,A,A);                        13690000
  1370          IF LENGTH(FLD_DEF) <= 6  THEN                                    13700000
  1371          DO;                                                              13710000
  1372              PUT FILE(PL1) EDIT(' INIT(''',FLD_DEF,'''),') (A,A,A)        13720000
  1373                       (SEQ_NO)                   (COL(73),P'999999V99');  13730000
  1374              SEQ_NO=SEQ_NO+1;                                             13740000
  1375          END;                                                             13750000
  1376          ELSE                                                             13760000
  1377          DO;                                                              13770000
  1378              PUT FILE(PL1) EDIT(' INIT(',SEQ_NO) (A,COL(73),P'999999V99');13780000
  1379              SEQ_NO=SEQ_NO+1;                                             13790000
  1380              MACRO_LN = '''' || FLD_DEF || '''),';                        13800000
  1381              IF LENGTH(MACRO_LN)>56 THEN                                  13810000
  1382              DO;                                                          13820000
  1383                 PUT FILE(PL1)                                             13830000
  1384                          EDIT(MACRO_LN) (COL(16),A(57))                   13840000
  1385                           (SEQ_NO) (P'999999V99')                         13850000
  1386                            (SUBSTR(MACRO_LN,58))                          13860000
  1387                                     (COL(2),A)                            13870000
  1388                           (SEQ_NO+1) (COL(73),P'999999V99');              13880000
  1389                 SEQ_NO=SEQ_NO+2;                                          13890000
  1390              END;                                                         13900000
  1391              ELSE                                                         13910000
  1392              DO;                                                          13920000
  1393                 PUT FILE(PL1)                                             13930000
  1394                     EDIT(MACRO_LN,SEQ_NO) (COL(16),A(57),P'999999V99');   13940000
  1395                 SEQ_NO=SEQ_NO+1;                                          13950000
  1396              END;                                                         13960000
  1397          END;                                                             13970000
  1398       FLD_DEF='';                                                         13980000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     43


   MACRO SOURCE2 LISTING

  1399    END WRITE_PARM;                                                        13990000
  1400    END WRITE_PL1;                                                         14000000
  1401    END MAPGEN;                                                            14010000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     44


   MACRO SOURCE2 LISTING

  1402    /**********************************************************************14020000
  1403    **                                                                   **14030000
  1404    ** MAP3270 V2.2.0 - SOFTWARE PACKAGE TO IMPLEMENT FULL SCREEN        **14040000
  1405    ** IO FOR IBM 3270 CLASS TERMINALS.                                  **14050000
  1406    **                                                                   **14060000
  1407    **             COPYRIGHT (C) 2021  EDWARD G LISS                     **14070000
  1408    **                     EGLISS4024@GMAIL.COM                          **14080000
  1409    **                                                                   **14090000
  1410    ** THIS PROGRAM IS FREE SOFTWARE: YOU CAN REDISTRIBUTE IT            **14100000
  1411    ** AND/OR MODIFY IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC        **14110000
  1412    ** LICENSE AS PUBLISHED BY THE FREE SOFTWARE FOUNDATION,             **14120000
  1413    ** EITHER VERSION 3 OF THE LICENSE, OR ANY LATER VERSION.            **14130000
  1414    **                                                                   **14140000
  1415    ** THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE           **14150000
  1416    ** USEFUL, BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED        **14160000
  1417    ** WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR           **14170000
  1418    ** PURPOSE.  SEE THE GNU GENERAL PUBLIC LICENSE FOR MORE             **14180000
  1419    ** DETAILS.                                                          **14190000
  1420    **                                                                   **14200000
  1421    ** PLEASE SEE HTTPS://WWW.GNU.ORG/LICENSES/ FOR A COPY OF THE        **14210000
  1422    ** GNU GENERAL PUBLIC LICENSE.                                       **14220000
  1423    **                                                                   **14230000
  1424    **********************************************************************/14240000


   INCLUDED TEXT FOLLOWS FROM DD.MEMBER =  SYSLIB  .SELECT

  1425    /********************************************************************* 00000001
  1426                                                                           00000002
  1427          THE SELECT, WHEN, BREAK, OTHERWISE AND ENDSELECT MACROS          00000003
  1428                      FOR USE WITH PL/I (F).                               00000004
  1429                                                                           00000005
  1430      THESE MACROS EMULATE THE PL/I SELECT STATEMENT WHICH WAS NOT         00000006
  1431      IMPLEMENTED IN THE PL/I (F) COMPILER.                                00000007
  1432                                                                           00000008
  1433      TO USE, %INCLUDE THIS MEMBER IN YOUR PROGRAM AND COMPILE WITH        00000009
  1434      THE MACRO OPTION. (NOMACRO IS THE DEFAULT).                          00000010
  1435                                                                           00000011
  1436      CODE THE SELECT:                                                     00000012
  1437                                                                           00000013
  1438          SELECT (A)                 SELECT (TRUE)                         00000014
  1439          WHEN(1)                    WHEN(A=1)                             00000015
  1440            CALL SUB1;                 CALL SUB1;                          00000016
  1441          WHEN(X)                    WHEN(A=X)                             00000017
  1442            CALL XRTN(X);              CALL XTRN(X);                       00000018
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     45


   MACRO SOURCE2 LISTING

  1443            X=X+A;                     X=X+A;                              00000019
  1444          ENDSELECT                  OTHERWISE                             00000020
  1445                                       PUT SKIP LIST('ERROR');             00000021
  1446                                     ENDSELECT                             00000022
  1447                                                                           00000023
  1448      NOTE - USING THE MACROS, THE ENDSELECT IS REQUIRED.                  00000024
  1449                                                                           00000025
  1450      THE ALTERNATE SELECT WHEN BREAK IS ALSO SUPPORTED.  THIS ONE IS      00000026
  1451      POPULAR WITH C, C++, JAVA, ETC PROGRAMMERS.                          00000027
  1452                                                                           00000028
  1453      THERE IS A COMPILE TIME VARIABLE DEFINED SELECT_TYPE.  BY DEFAULT    00000029
  1454      IT IS SET TO 0. THIS INDICATES UPON COMPLETION OF A WHEN BLOCK,      00000030
  1455      THE STATEMENT AFTER THE ENDSELECT WILL BE THE NEXT EXECUTED.         00000031
  1456      IF SELECT_TYPE IS SET TO 1, UPON COMPLETION OF A WHEN BLOCK, THE     00000032
  1457      NEXT WHEN WILL BE EXECUTED.  A BREAK MACRO IN A WHEN BLOCK           00000033
  1458      WILL CAUSE THE STATEMENT AFTER THE ENDSELECT TO BE THE NEXT          00000034
  1459      STATEMENT EXECUTED.                                                  00000035
  1460      TO SWITCH TYPE, CODE A %SELECT_TYPE=1; OR %SELECT_TYPE=0;            00000036
  1461    **********************************************************************/00000037
  1462                                                                           00000038
  1463    %DECLARE                                                               00000039
  1464        SELECT    ENTRY (CHARACTER) RETURNS (CHARACTER),                   00000040
  1465        WHEN      ENTRY (CHARACTER) RETURNS (CHARACTER),                   00000041
  1466        OTHERWISE ENTRY             RETURNS (CHARACTER),                   00000042
  1467        BREAK     ENTRY             RETURNS (CHARACTER),                   00000043
  1468        ENDSELECT ENTRY             RETURNS (CHARACTER);                   00000044
  1469                                                                           00000045
  1470    %DECLARE                                                               00000046
  1471         WHEN_CTR            FIXED,                                        00000047
  1472         SELECT_CTR          FIXED,                                        00000048
  1473         SELECT_TYPE         FIXED,                                        00000049
  1474         SELECT_NAME         CHARACTER,                                    00000050
  1475        (SELEXPR,SPACES)     CHARACTER;                                    00000051
  1476                                                                           00000052
  1477      %WHEN_CTR = 0;                                                       00000053
  1478      %SELECT_CTR = 0;                                                     00000054
  1479      %SELECT_TYPE = 0;                                                    00000055
  1480      %SELECT_NAME = ' ';                                                  00000056
  1481      %SPACES = '                                                          00000057
  1482                ';                                                         00000058
  1483    /*********************************************************************/00000059
  1484    %SELECT :                                                              00000060
  1485        PROCEDURE (A) RETURNS (CHARACTER);                                 00000061
  1486                                                                           00000062
  1487          DECLARE  (A,L1,L2) CHARACTER;                                    00000063
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     46


   MACRO SOURCE2 LISTING

  1488                                                                           00000064
  1489          IF WHEN_CTR > 0 THEN                                             00000065
  1490              RETURN('/*** THE SELECT MACRO CANNOT BE NESTED ***/');       00000066
  1491                                                                           00000067
  1492          IF SELECT_TYPE < 0 | SELECT_TYPE > 1 THEN                        00000068
  1493              RETURN('/*** SELECT_TYPE MUST BE 0 OR 1 ***/');              00000069
  1494                                                                           00000070
  1495          SELECT_CTR = SELECT_CTR+1;                                       00000071
  1496          SELECT_NAME = FIX2STR(SELECT_CTR);                               00000072
  1497          SELECT_NAME = ' ENDSELECT_MACRO' || SELECT_NAME;                 00000073
  1498          SELEXPR = A;                                                     00000074
  1499          WHEN_CTR = 1;                                                    00000075
  1500                                                                           00000076
  1501          L1 = '       /*';                                                00000077
  1502          L2 = 'SELECT (' || SELEXPR || ')   */ DO;';                      00000078
  1503                                                                           00000079
  1504          L1 = SUBSTR(L1||SPACES,1,71);                                    00000080
  1505                                                                           00000081
  1506          RETURN(L1||L2);                                                  00000082
  1507    %END;                                                                  00000083
  1508    /*********************************************************************/00000084
  1509    %WHEN :                                                                00000085
  1510        PROCEDURE (A) RETURNS (CHARACTER);                                 00000086
  1511                                                                           00000087
  1512          DECLARE  (A,L1,L2,L4,L5) CHARACTER;                              00000088
  1513                                                                           00000089
  1514          IF WHEN_CTR > 1 THEN                                             00000090
  1515          DO;                                                              00000091
  1516             IF SELECT_TYPE = 0 THEN                                       00000092
  1517                L1='             GO TO ' || SELECT_NAME || '; END; /*';    00000093
  1518             ELSE                                                          00000094
  1519                L1='             END; /*';                                 00000095
  1520             L2='WHEN (' || A || ')    */';                                00000096
  1521          END;                                                             00000097
  1522          ELSE                                                             00000098
  1523          IF WHEN_CTR = 1 THEN                                             00000099
  1524          DO;                                                              00000100
  1525             L1='                 /*';                                     00000101
  1526             L2='WHEN (' || A || ')    */';                                00000102
  1527          END;                                                             00000103
  1528          ELSE                                                             00000104
  1529             RETURN('/** WHEN WITHOUT A SELECT **/');                      00000105
  1530                                                                           00000106
  1531          WHEN_CTR = WHEN_CTR + 1;                                         00000107
  1532                                                                           00000108
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     47


   MACRO SOURCE2 LISTING

  1533          IF SELEXPR = 'TRUE' THEN                                         00000109
  1534             L4='         IF (' || A || ') THEN';                          00000110
  1535          ELSE                                                             00000111
  1536             L4='         IF (' || SELEXPR || ')=(' || A || ') THEN';      00000112
  1537          L5='                      DO;';                                  00000113
  1538                                                                           00000114
  1539          L1 = SUBSTR(L1||SPACES,1,71);                                    00000115
  1540          L2 = SUBSTR(L2||SPACES,1,71);                                    00000116
  1541          L4 = SUBSTR(L4||SPACES,1,71);                                    00000117
  1542                                                                           00000118
  1543          RETURN(L1||L2||L4||L5);                                          00000119
  1544    %END ;                                                                 00000120
  1545    /*********************************************************************/00000121
  1546    %BREAK :                                                               00000122
  1547        PROCEDURE RETURNS (CHARACTER);                                     00000123
  1548          DECLARE  (L1,L2) CHARACTER;                                      00000124
  1549          IF SELECT_TYPE = 0 THEN                                          00000125
  1550             RETURN('/*** BREAK NOT ALLOWED IN THIS SELECT TYPE ***/');    00000126
  1551          L1='                   /*';                                      00000127
  1552          L2='BREAK         */   GO TO ' || SELECT_NAME ||';';             00000128
  1553          L1 = SUBSTR(L1||SPACES,1,71);                                    00000129
  1554                                                                           00000130
  1555          RETURN(L1||L2);                                                  00000131
  1556    %END;                                                                  00000132
  1557    /*********************************************************************/00000133
  1558    %OTHERWISE :                                                           00000134
  1559        PROCEDURE RETURNS (CHARACTER);                                     00000135
  1560                                                                           00000136
  1561          DECLARE  (L1,L2) CHARACTER;                                      00000137
  1562                                                                           00000138
  1563          IF WHEN_CTR < 1 THEN                                             00000139
  1564             RETURN('/** OTHERWISE OUT OF SEQUENCE **/');                  00000140
  1565                                                                           00000141
  1566          L1='              END; /*';                                      00000142
  1567          L2='OTHERWISE     */  ELSE DO;';                                 00000143
  1568                                                                           00000144
  1569          L1 = SUBSTR(L1||SPACES,1,71);                                    00000145
  1570          L2 = SUBSTR(L2||SPACES,1,71);                                    00000146
  1571                                                                           00000147
  1572          RETURN(L1||L2);                                                  00000148
  1573    %END;                                                                  00000149
  1574    /*********************************************************************/00000150
  1575    %ENDSELECT :                                                           00000151
  1576        PROCEDURE RETURNS (CHARACTER);                                     00000152
  1577                                                                           00000153
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     48


   MACRO SOURCE2 LISTING

  1578          DECLARE  (L1,L2) CHARACTER;                                      00000154
  1579                                                                           00000155
  1580          IF WHEN_CTR < 1 THEN                                             00000156
  1581             RETURN('/** ENDSELECT OUT OF SEQUENCE **/');                  00000157
  1582                                                                           00000158
  1583          WHEN_CTR = 0;                                                    00000159
  1584                                                                           00000160
  1585          L1='              END; /*';                                      00000161
  1586          L2='ENDSELECT     */  END;';                                     00000162
  1587                                                                           00000163
  1588          L2 = L2 || SELECT_NAME || ':;';                                  00000164
  1589          L1 = SUBSTR(L1||SPACES,1,71);                                    00000165
  1590                                                                           00000166
  1591          RETURN(L1||L2);                                                  00000167
  1592    %END;                                                                  00000168


   INCLUDED TEXT FOLLOWS FROM DD.MEMBER =  SYSLIB  .FIX2STR

  1593    /********************************************************************* 00000001
  1594                                                                           00000002
  1595          THE FIX2STR MACRO - CONVERT A FIXED ITEM TO A STRING             00000003
  1596                      FOR USE WITH PL/I (F).                               00000004
  1597                                                                           00000005
  1598    **********************************************************************/00000006
  1599    %DECLARE                                                               00000007
  1600        FIX2STR   ENTRY (FIXED) RETURNS (CHARACTER);                       00000008
  1601    %FIX2STR :                                                             00000009
  1602        PROCEDURE (N) RETURNS (CHARACTER);                                 00000010
  1603                                                                           00000011
  1604          DECLARE  (N,ABSN)      FIXED,                                    00000012
  1605                   NSTR          CHARACTER;                                00000013
  1606          NSTR = N;                                                        00000014
  1607          IF N < 0 THEN                                                    00000015
  1608              ABSN = N * -1;                                               00000016
  1609          ELSE                                                             00000017
  1610              ABSN = N;                                                    00000018
  1611          NSTR = ABSN;   /* CONVERSION RESULTS IN 99999999 FORMAT */       00000019
  1612          IF ABSN < 10 THEN                                                00000020
  1613                NSTR = SUBSTR(NSTR,8,1);                                   00000021
  1614          ELSE                                                             00000022
  1615          IF ABSN < 100 THEN                                               00000023
  1616                NSTR = SUBSTR(NSTR,7,2);                                   00000024
  1617          ELSE                                                             00000025
  1618          IF ABSN < 1000 THEN                                              00000026
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     49


   MACRO SOURCE2 LISTING

  1619                NSTR = SUBSTR(NSTR,6,3);                                   00000027
  1620          ELSE                                                             00000028
  1621          IF ABSN < 10000 THEN                                             00000029
  1622                NSTR = SUBSTR(NSTR,5,4);                                   00000030
  1623          ELSE                                                             00000031
  1624                NSTR = '/* FIX2STR - NUMBER TOO LARGE */';                 00000032
  1625          IF N<0 THEN                                                      00000033
  1626             NSTR = '-' || NSTR;                                           00000034
  1627          RETURN(NSTR);                                                    00000035
  1628    %END;                                                                  00000036


   NO ERROR OR WARNING CONDITION HAS BEEN DETECTED FOR THIS MACRO PASS.
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     50


                    SOURCE LISTING.



   STMT LEVEL NEST
                     /********************** MAP3270 V2.2.0********************************/    1
                     /**********************************************************************    2
                     **                                                                   **    2
                     ** MAP3270 V2.2.0 - SOFTWARE PACKAGE TO IMPLEMENT FULL SCREEN        **    2
                     ** IO FOR IBM 3270 CLASS TERMINALS.                                  **    2
                     **                                                                   **    2
                     **             COPYRIGHT (C) 2021  EDWARD G LISS                     **    2
                     **                     EGLISS4024@GMAIL.COM                          **    2
                     **                                                                   **    2
                     ** THIS PROGRAM IS FREE SOFTWARE: YOU CAN REDISTRIBUTE IT            **    2
                     ** AND/OR MODIFY IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC        **    2
                     ** LICENSE AS PUBLISHED BY THE FREE SOFTWARE FOUNDATION,             **    2
                     ** EITHER VERSION 3 OF THE LICENSE, OR ANY LATER VERSION.            **    2
                     **                                                                   **    2
                     ** THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE           **    2
                     ** USEFUL, BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED        **    2
                     ** WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR           **    2
                     ** PURPOSE.  SEE THE GNU GENERAL PUBLIC LICENSE FOR MORE             **    2
                     ** DETAILS.                                                          **    2
                     **                                                                   **    2
                     ** PLEASE SEE HTTPS://WWW.GNU.ORG/LICENSES/ FOR A COPY OF THE        **    2
                     ** GNU GENERAL PUBLIC LICENSE.                                       **    2
                     **                                                                   **    2
                     **********************************************************************/    2
                                                                                               24
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     51


   STMT LEVEL NEST

                     /*********************************************************************/   25
                     /*                                                                   */   26
                     /* NAME: MAP3270 - SCREEN COMPILER                                   */   27
                     /*                                                                   */   28
                     /*********************************************************************/   29
                     /*                                                                   */   30
                     /* THIS IS A PROGRAM TO PROCESS A SCREEN DEFINITION FILE AND CREATES */   31
                     /* A PANEL FOR THE MAP3270 SYSTEM.                                   */   32
                     /*                                                                   */   33
                     /* A PANEL FOR THE MAP3270 SYSTEM CONSISTS OF 2 COMPONENTS - A       */   34
                     /* PHYSICAL MAP AND A USER MAP.  CONCEPTUALLY THESE ARE LIKE CICS    */   35
                     /* PHYSICAL AND SYMBOLIC MAPS.  HOWEVER, THERE IS NO COMPATABILITY.  */   36
                     /*                                                                   */   37
                     /* THE PHYSICAL MAP IS CONSISTS OF AN INDEX, THE ACTUAL 3270 MAP     */   38
                     /* AND THE CROSS REFERENCE FROM THE PHYSICAL MAP TO A USER MAP.      */   39
                     /* THE USER MAP IS THE AREA THAT USER'S APPLICATION SENDS AND        */   40
                     /* RECEIVES DATA FROM MAP3270 RUNTIME MODULES.                       */   41
                     /*                                                                   */   42
                     /* USER MAPS ARE GENERATED FOR ASSEMBLER, COBOL, AND PL/I (F).       */   43
                     /* THE PHYSICAL MAP IS GENERATED AND MUST BE ASSEMLED AND LINKED.    */   44
                     /*                                                                   */   45
                     /* REVISION HISTORY                                                  */   46
                     /* ------  --------------------------------------------------------  */   47
                     /* V2.0.0  "DOWNGRADED" FROM PL/1 OPTIMIZING COMPILER TO PL/1 (F)    */   48
                     /*         SEPT 2008                                                 */   49
                     /* V2.1.0  ADDED SUPPORT FOR THE EXTENTED ATTRIBUTES HIGHLITE AND    */   50
                     /*         COLOR.                                                    */   51
                     /*         REWORKED CODE TO USE THE SELECT...WHEN  MACRO, WHICH      */   52
                     /*         SIMULATES THE SELECT STATEMENT.                           */   53
                     /*         AUGUST 2010                                               */   54
                     /* V2.2.0 -REVISED TO MAKE GENERATION OF ASM,COB,PLI AND MAP CODE    */   55
                     /*         OPTIONAL.                                                 */   56
                     /*        -REVISED TO ALLOW 28 CHARACTER FIELD NAMES IN .VAR         */   57
                     /*        -REVISED TO GENERATE COBOL AND PLI CODE WITH THE           */   58
                     /*         28 CHARACTER NAMES.                                       */   59
                     /*        -REVIDED ASM CODE GENERATION TO ONLY USE THE INTERNAL      */   60
                     /*         NAMES (R__C__).  FIELD NAMES ARE INCLUDED AS COMMENTS.    */   61
                     /*                                                                   */   62
                     /*********************************************************************/   63
                     /*********************************************************************  1425
                                                                                             1425
                           THE SELECT, WHEN, BREAK, OTHERWISE AND ENDSELECT MACROS           1425
                                       FOR USE WITH PL/I (F).                                1425
                                                                                             1425
                       THESE MACROS EMULATE THE PL/I SELECT STATEMENT WHICH WAS NOT          1425
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     52


   STMT LEVEL NEST

                       IMPLEMENTED IN THE PL/I (F) COMPILER.                                 1425
                                                                                             1425
                       TO USE, %INCLUDE THIS MEMBER IN YOUR PROGRAM AND COMPILE WITH         1425
                       THE MACRO OPTION. (NOMACRO IS THE DEFAULT).                           1425
                                                                                             1425
                       CODE THE SELECT:                                                      1425
                                                                                             1425
                           SELECT (A)                 SELECT (TRUE)                          1425
                           WHEN(1)                    WHEN(A=1)                              1425
                             CALL SUB1;                 CALL SUB1;                           1425
                           WHEN(X)                    WHEN(A=X)                              1425
                             CALL XRTN(X);              CALL XTRN(X);                        1425
                             X=X+A;                     X=X+A;                               1425
                           ENDSELECT                  OTHERWISE                              1425
                                                        PUT SKIP LIST('ERROR');              1425
                                                      ENDSELECT                              1425
                                                                                             1425
                       NOTE - USING THE MACROS, THE ENDSELECT IS REQUIRED.                   1425
                                                                                             1425
                       THE ALTERNATE SELECT WHEN BREAK IS ALSO SUPPORTED.  THIS ONE IS       1425
                       POPULAR WITH C, C++, JAVA, ETC PROGRAMMERS.                           1425
                                                                                             1425
                       THERE IS A COMPILE TIME VARIABLE DEFINED SELECT_TYPE.  BY DEFAULT     1425
                       IT IS SET TO 0. THIS INDICATES UPON COMPLETION OF A WHEN BLOCK,       1425
                       THE STATEMENT AFTER THE ENDSELECT WILL BE THE NEXT EXECUTED.          1425
                       IF SELECT_TYPE IS SET TO 1, UPON COMPLETION OF A WHEN BLOCK, THE      1425
                       NEXT WHEN WILL BE EXECUTED.  A BREAK MACRO IN A WHEN BLOCK            1425
                       WILL CAUSE THE STATEMENT AFTER THE ENDSELECT TO BE THE NEXT           1425
                       STATEMENT EXECUTED.                                                   1425
                       TO SWITCH TYPE, CODE A %SELECT_TYPE=1; OR %SELECT_TYPE=0;             1425
                     **********************************************************************/ 1425
                                                                                             1461
                                                                                             1469
                                                                                             1476
                     /*********************************************************************/ 1483
                     /*********************************************************************/ 1508
                     /*********************************************************************/ 1545
                     /*********************************************************************/ 1557
                     /*********************************************************************/ 1574
                     /*********************************************************************  1593
                                                                                             1593
                           THE FIX2STR MACRO - CONVERT A FIXED ITEM TO A STRING              1593
                                       FOR USE WITH PL/I (F).                                1593
                                                                                             1593
                     **********************************************************************/ 1593
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     53


   STMT LEVEL NEST

                                                                                             1598
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     54


   STMT LEVEL NEST

     1               MAPGEN:PROC(EXEC_PARM) OPTIONS(MAIN);                                     66
     2     1            DECLARE EXEC_PARM               CHAR(100) VARYING;                     67
     3     1            DECLARE (GEN_ASM,GEN_COB,GEN_PLI,GEN_MAP)                              68
                                                        BIT(1) ALIGNED INIT('1'B);             69
     4     1            DECLARE (PANEL,ASM,COB,PL1)                                            70
                                 STREAM OUTPUT FILE;                                           71
     5     1            DECLARE  PANEL_SEQ              FIXED DEC(9,2) INIT(1);                72
     6     1            DECLARE  NOT_E_O_F              BIT(1) ALIGNED;                        73
     7     1            DECLARE  NO_ATTRIB              BIT(1) ALIGNED;                        74
     8     1            DECLARE  PANEL_NAME             CHAR(7) VARYING INIT('PANELNM');       75
     9     1            DECLARE  MY_REC                 CHAR(80);                              76
    10     1            DECLARE  PROCESS_STATUS         CHAR(7);                               77
    11     1            DECLARE  SCR_IMG(26)            CHAR(82);                              78
    12     1            DECLARE  ERROR_FOUND            BIT(1) ALIGNED INIT('0'B),             79
                                 IHESARC                ENTRY(FIXED BIN(31,0)),                80
                                 RETURN_CODE            FIXED BIN(31,0) ALIGNED INIT(0);       81


                     /*********************************************************************/   82
                     /*                                                                   */   83
                     /* ATTR_TBL HOLDS ALL ATTRIBUTES FOR THE ATTR_CHR PARSED FROM .ATTR  */   84
                     /*                                                                   */   85
                     /*********************************************************************/   86
    13     1            DECLARE  1 ATTR_REC,                                                   87
                                   2 ATTR_CHR           CHAR(1),                               88
                                   2 ATTR_A             CHAR(80) VARYING,                      89
                                   2 PROT               BIT(1) ALIGNED,                        90
                                   2 BRIGHT             BIT(1) ALIGNED,                        91
                                   2 NUM                BIT(1) ALIGNED,                        92
                                   2 TITLE              BIT(1) ALIGNED,                        93
                                   2 STOP_BIT           BIT(1) ALIGNED,                        94
                                   2 CUR                BIT(1) ALIGNED,                        95
                                   2 HI_LIGHT           CHAR(1),                               96
                                   2 COLOR              CHAR(3);                               97
    14     1            DECLARE  1 ATTR_TBL(9) LIKE ATTR_REC;                                  98


                     /*********************************************************************/   99
                     /*                                                                   */  100
                     /* FLDS HOLDS ALL THE FIELD INFORMATION PARSED FROM THE .SCREEN      */  101
                     /* THE ATTRS ARE REPEATED SO THE ATTRIBUTES FOR FIELDS CAN BE        */  102
                     /* OVERRIDEN IN THE .VARS SECTION.                                   */  103
                     /*                                                                   */  104
                     /*********************************************************************/  105
    15     1            DECLARE  1 FLD(500),                                                  106
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     55


   STMT LEVEL NEST

                                   2 FLD_ROW            FIXED BINARY(15),                     107
                                   2 FLD_COL            FIXED BINARY(15),                     108
                                   2 FLD_ATTR           FIXED BINARY(15),                     109
                                   2 FLD_REC  LIKE ATTR_REC,                                  110
                                   2 FLD_DATA           CHAR(80) VARYING,                     111
                                   2 FLD_INT_NAME       CHAR(6),                              112
                                   2 FLD_NAME           CHAR(28) VARYING;                     113
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     56


   STMT LEVEL NEST

                     /*********************************************************************/  114
                     /*                                                                   */  115
                     /* VARS HOLDS ALL THE FIELD INFORMATION PARSED FROM THE .VARS        */  116
                     /*                                                                   */  117
                     /*********************************************************************/  118
    16     1            DECLARE  1 VAR(500),                                                  119
                                   2 VAR_NAME           CHAR(6),                              120
                                   2 VAR_FLD            CHAR(28) VARYING;                     121


                     /*********************************************************************/  122
                     /*                                                                   */  123
                     /*   STATIC FIELDS DEFINED HERE                                      */  124
                     /*                                                                   */  125
                     /*********************************************************************/  126
    17     1            DECLARE PAGE_TITLE              CHAR(45) STATIC INIT(                 127
                             'M A P 3 2 7 0   S C R E E N   C O M P I L E R'),                128
                                PGM_VER                 CHAR(8) STATIC INIT('V2.2.0  ');      129
    18     1            DECLARE (TRUE    INITIAL('1'B),                                       130
                                 FALSE   INITIAL('0'B)) BIT(1) ALIGNED STATIC,                131
                                 ONE     INITIAL(1)     FIXED BIN(15)  STATIC;                132
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     57


   STMT LEVEL NEST

                     /*********************************************************************/  133
                     /*                                                                   */  134
                     /*   GLOBAL VARIABLES DEFINED HERE                                   */  135
                     /*                                                                   */  136
                     /*********************************************************************/  137


    19     1            DECLARE  FLD_DEF                CHAR(80) VARYING;                     138
    20     1            DECLARE (B,ROW,COL,A,REC_CTR)   FIXED BINARY(15);                     139
    21     1            DECLARE (FLD_CTR,M,FLD_A      ) FIXED BINARY(15);                     140
    22     1            DECLARE VAR_CTR                 FIXED BINARY(15);                     141
    23     1            DECLARE LBL                     CHAR(7) VARYING,                      142
                                PAGE_NO                 FIXED DEC(3,0) INIT(0),               143
                                DT_TIME_STAMP           CHAR(60) VARYING,                     144
                                TITLE_STAMP             CHAR(50) VARYING;                     145
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     58


   STMT LEVEL NEST

                     /*********************************************************************/  146
                     /*                                                                   */  147
                     /* READ AND LIST THE INPUT STATEMENTS.  SET UP THE PAGE HEADING      */  148
                     /*    SET UP THE PAGE HEADING.  THEN THE INPUT IS LISTED AND PARSED  */  149
                     /*    INPUT CONSISTS OF SECTIONS AND COMMAND.  EACH SECTION STARTS   */  150
                     /*    WITH '.NAME ' IN COL 1.  VALID NAMES ARE LISTED BELOW.         */  151
                     /*    COMMAND START WITH '.KW=' IN COL 1.                            */  152
                     /*                                                                   */  153
                     /* THERE ARE 3 SECTIONS                                              */  154
                     /* 1.  ATTR - THIS IS WHERE THE ATTRIBUTES ARE DEFINED. THESE MUST   */  155
                     /*     BE DEFINED BEFORE USE IN THE SCREEN SECTION.                  */  156
                     /* 2.  SCREEN - THIS IS WHERE THE 'DRAWING' OF THE SCREEN IS         */  157
                     /*     IS DEFINED.  EACH FIELD BEGIN WITH AN ATTRIBUTED AS DEFINED   */  158
                     /*     IN THE ATTR SECTION.                                          */  159
                     /* 3.  VARS - THIS OPTIONAL SECTION MAPS ANY USER DEFINED FIELD      */  160
                     /*     NAME TO BE DEFINED.  THESE NAME REPLACE THE DEFAULT NAME OF   */  161
                     /*     R99C99.                                                       */  162
                     /*                                                                   */  163
                     /* THE FOLLOWING IS A LIST OF COMMAND CURRENTLY SUPPORTED:           */  164
                     /*                                                                   */  165
                     /* 1.  .NAME= THIS COMMAND SETS THE NAME FOR THE PANEL.  NAME CAN    */  166
                     /*     BE ANY VALID NAME 1-7 CHARACTERS.  MAP3270 GENERATES SOME     */  167
                     /*     INTERNAL NAMES USING 'NAME' PLUS 1 CHARACTER.                 */  168
                     /*                                                                   */  169
                     /*********************************************************************/  170
                                                                                              171
    24     1            DT_TIME_STAMP = '** GENERATED BY MAP3270 ' || PGM_VER || ' ON ' ||    172
                                        DATE || ' AT ' || TIME;                               173
    25     1            TITLE_STAMP = ' GENERATED BY MAP3270 V2.2.0';                         174
    26     1            CALL INITIALIZE;                                                      175
    27     1            ON ENDPAGE(SYSPRINT)                                                  176
    28     1            BEGIN;                                                                177
    29     2               PAGE_NO = PAGE_NO + 1;                                             178
    30     2               PUT PAGE EDIT(PAGE_TITLE,PGM_VER,'PAGE ',PAGE_NO)                  179
                                        (A,COL(100),A,COL(111),A,F(3));                       180
    31     2               IF PAGE_NO = 1 THEN                                                181
    32     2                  CALL PROCESS_PARM;                                              182
    33     2               PUT SKIP(2) EDIT('INPUT STATEMENTS')(A)                            183
                                           (' LINE:   STATEMENT') (SKIP(2),A)                 184
                                           ('------   ---------') (SKIP,A);                   185
    34     2            END;                                                                  186
                                                                                              187
    35     1            SIGNAL ENDPAGE(SYSPRINT);                                             188
    36     1            PROCESS_STATUS = '.NONE';                                             189
    37     1            ON ENDFILE(SYSIN)                                                     190
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     59


   STMT LEVEL NEST

    38     1               NOT_E_O_F = FALSE;                                                 191
    39     1            NOT_E_O_F = TRUE;                                                     192
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     60


   STMT LEVEL NEST

                     /*********************************************************************/  193
                     /*                                                                   */  194
                     /*  PPPP    AAA    SSS    SSS     1                                  */  195
                     /*  P   P  A   A  S      S       11                                  */  196
                     /*  PPPP   A   A  S      S        1                                  */  197
                     /*  P      AAAAA   SSS    SSS     1                                  */  198
                     /*  P      A   A      S      S    1                                  */  199
                     /*  P      A   A      S      S    1                                  */  200
                     /*  P      A   A   SSS    SSS   11111                                */  201
                     /*                                                                   */  202
                     /*  READ AND PRINT THE INPUT STATEMENTS                              */  203
                     /*    DETERMINE THE SECTION AND PASS TO THE APPROPRIATE SECTION      */  204
                     /*    FOR PROCESSING.                                                */  205
                     /*    COMMANDS ARE PARSED AND PROCESSED IMMEDIATELY.                 */  206
                     /*                                                                   */  207
                     /*********************************************************************/  208
    40     1            GET EDIT(MY_REC) (A(80));                                             209
    41     1            DO WHILE (NOT_E_O_F);                                                 210
    42     1    1          REC_CTR = REC_CTR + 1;                                             211
    43     1    1          PUT SKIP EDIT(REC_CTR,':',MY_REC) (F(5),A(4),A);                   212
    44     1    1          IF SUBSTR(MY_REC,1,5) = '.ATTR' THEN                               213
    45     1    1          DO;                                                                214
    46     1    2               PROCESS_STATUS = '.ATTR  ';                                   215
    47     1    2               A = 0;                                                        216
    48     1    2               ATTRLIST='';                                                  217
    49     1    2          END;                                                               218
    50     1    1          ELSE                                                               219
    50     1    1          IF SUBSTR(MY_REC,1,7) = '.SCREEN' THEN                             220
    51     1    1          DO;                                                                221
    52     1    2               PROCESS_STATUS = '.SCREEN';                                   222
    53     1    2               B = 0;                                                        223
    54     1    2               FLD_DEF = '';                                                 224
    55     1    2               FLD_A = 0;                                                    225
    56     1    2               ROW = 0;                                                      226
    57     1    2               COL = 0;                                                      227
    58     1    2               NO_ATTRIB = TRUE;                                             228
    59     1    2          END;                                                               229
    60     1    1          ELSE                                                               230
    60     1    1          IF SUBSTR(MY_REC,1,5) = '.VARS' THEN                               231
    61     1    1               PROCESS_STATUS = '.VARS  ';                                   232
    62     1    1          ELSE                                                               233
    62     1    1          IF SUBSTR(MY_REC,1,6) = '.NAME=' THEN                              234
    63     1    1          BEGIN;                                                             235
    64     2    1               DCL I FIXED BINARY(15);                                       236
    65     2    1               PANEL_NAME = SUBSTR(MY_REC,7,7);                              237
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     61


   STMT LEVEL NEST

    66     2    1               I = INDEX(PANEL_NAME,' ');                                    238
    67     2    1               IF I > 0 THEN PANEL_NAME=SUBSTR(PANEL_NAME,1,I-1);            239
    69     2    1          END;                                                               240
    70     1    1          ELSE                                                               241
    70     1    1          IF SUBSTR(MY_REC,1,1) = '*' THEN; /* DO NOT PROCESS COMMENT */     242
    72     1    1          ELSE                                                               243
    72     1    1               CALL PROCESS_MYREC;                                           244
    73     1    1          GET EDIT(MY_REC) (A(80));                                          245
    74     1    1       END; /* OF LOOP */                                                    246
    75     1            IF FLD_DEF ^= '' THEN             /* IF WE STILL HAVE DATA      */    247
    76     1            DO;                                                                   248
    77     1    1          CALL SAVE_FIELD(ONE);          /* WRITE DATA FOR LAST FIELD  */    249
    78     1    1          FLD_DEF = '';                                                      250
    79     1    1       END;                                                                  251
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     62


   STMT LEVEL NEST

                     /*********************************************************************/  252
                     /*                                                                   */  253
                     /*  PPPP    AAA    SSS    SSS    222                                 */  254
                     /*  P   P  A   A  S      S      2   2                                */  255
                     /*  PPPP   A   A  S      S          2                                */  256
                     /*  P      AAAAA   SSS    SSS      2                                 */  257
                     /*  P      A   A      S      S    2                                  */  258
                     /*  P      A   A      S      S   2                                   */  259
                     /*  P      A   A   SSS    SSS   22222                                */  260
                     /*                                                                   */  261
                     /*  SET UP THE PAGE HEADINGS FOR THE SECOND PASS.                    */  262
                     /*    DURING THE SECOND PASS, SOME ERROR CHECKING IS PERFORMED TO    */  263
                     /*    ENSURE THE MAP DOES NOT VIOLATE HARDWARE PROTOCOL.             */  264
                     /*                                                                   */  265
                     /*   -THE SCREEN IMAGE WILL BE PRINTED.                              */  266
                     /*   -THE INPUT ATTRIBUTES AND THE GENERATED ATTRIBUTES WILL BE      */  267
                     /*    PRINTED.  THIS SHOWS WHAT WAS SPECIFIED VS WHAT WILL BE        */  268
                     /*    GENERATED.                                                     */  269
                     /*   -ALL VARIABLE NAMES ARE CORRECT AND EXIST                       */  270
                     /*   -THE MACROS TO DEFINE THE PHYSICAL MAP (NOT RELATED TO CICS)    */  271
                     /*   -THE USER INTERFACE(S) FOR ASSEMBLER, COBOL AND PL1 PROGRAMS.   */  272
                     /*                                                                   */  273
                     /*********************************************************************/  274
                                                                                              275
    80     1            ON ENDPAGE(SYSPRINT)                                                  276
    81     1            BEGIN;                                                                277
    82     2               PAGE_NO = PAGE_NO + 1;                                             278
    83     2               PUT PAGE EDIT(PAGE_TITLE,'PANEL ',PANEL_NAME,                      279
                                         PGM_VER,'PAGE ',PAGE_NO)                             280
                                        (A,COL(70),A,A,COL(100),A,COL(111),A,F(3));           281
    84     2               PUT SKIP(2);                                                       282
    85     2            END;                                                                  283
    86     1            SIGNAL ENDPAGE(SYSPRINT);                                             284
                                                                                              285
                           /*  PRINT THE SCREEN IMAGE */                                      286
                                                                                              287
    87     1            PUT SKIP EDIT('* ', (29)'>',                                          288
                                      ' SAMPLE SCREEN LAYOUT ',                               289
                                      (29)'<') (X(10),(4)A);                                  290
    88     1            PUT SKIP EDIT('*') (X(10),A);                                         291
    89     1            PUT SKIP EDIT('* ----+----1----+----2----+----3',                     292
                                        '----+----4----+----5----+----6',                     293
                                        '----+----7----+----8') (X(10),(3)A);                 294
    90     1            DO I = 1 TO B;                                                        295
    91     1    1          PUT SKIP EDIT(I,SCR_IMG(I)) (F(9),X(1),A);                         296
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     63


   STMT LEVEL NEST

    92     1    1       END;                                                                  297
    93     1            PUT SKIP EDIT('* ----+----1----+----2----+----3',                     298
                                        '----+----4----+----5----+----6',                     299
                                        '----+----7----+----8') (X(10),(3)A);                 300
                                                                                              301
                           /*  PRINT THE ATTRIBUTE LIST */                                    302
                                                                                              303
    94     1            PUT SKIP(2) EDIT('CHAR ATTR')(X(10),A);                               304
    95     1            DO I = 1 TO A;                                                        305
    96     1    1          PUT SKIP EDIT(ATTR_TBL(I).ATTR_CHR,                                306
                                         ATTR_TBL(I).ATTR_A) (X(12),A,X(2),A);                307
    97     1    1          PUT SKIP EDIT(' ') (X(15),A);                                      308
    98     1    1          CALL PRINT_ATTR(ATTR_TBL(I));                                      309
    99     1    1       END; /* OF LOOP */                                                    310
                                                                                              311
                           /*  VERIFY THE FIELDS LIST  */                                     312
                                                                                              313
   100     1            DECLARE VAR_FLD_MATCH  BIT(1) ALIGNED;                                314
   101     1            DO I=1 TO VAR_CTR;                                                    315
   102     1    1         VAR_FLD_MATCH = FALSE;                                              316
   103     1    1         DO J=1 TO FLD_CTR;                                                  317
   104     1    2            IF VAR(I).VAR_NAME = FLD(J).FLD_NAME THEN                        318
   105     1    2            DO;                                                              319
   106     1    3               VAR_FLD_MATCH = TRUE;                                         320
                            /** IF ATTR_TBL(FLD(J).FLD_ATTR).TITLE THEN                       321
                                DO;                                                           321
                                   PUT SKIP EDIT('*** VAR ',VAR(I).VAR_NAME,                  321
                                                 ' IS LISTED IN THE .VAR SECTION. THE ',      321
                                                 'FIELD IS A TITLE. NAME NOT ALLOWED.')       321
                                                 (A,A,A,A);                                   321
                                   ERROR_FOUND = TRUE;                                        321
                                END;                                                          321
                                ELSE                                                          321
                            **/                                                               321
   107     1    3        FLD(J).FLD_NAME = VAR(I).VAR_FLD;                                    330
   108     1    3            END;                                                             331
   109     1    2         END;                                                                332
   110     1    1         IF VAR_FLD_MATCH  THEN ;                                            333
   112     1    1         ELSE                                                                334
   112     1    1         DO;                                                                 335
   113     1    2            PUT SKIP EDIT('*** VAR ',VAR(I).VAR_NAME,' IS LISTED IN THE',    336
                                           ' .VAR SECTION BUT IS NOT DEFINED ***')            337
                                          (A,A,A,A);                                          338
   114     1    2            ERROR_FOUND = TRUE;                                              339
   115     1    2         END;                                                                340
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     64


   STMT LEVEL NEST

   116     1    1       END;                                                                  341
                                                                                              342
                           /*  PRINT THE FIELDS LIST  */                                      343
                                                                                              344
   117     1            PUT SKIP(2) EDIT('  ROW  COL NAME')(X(5),A);                          345
   118     1            DO I=1 TO FLD_CTR;                                                    346
                       /*  IF ^ATTR_TBL(FLD(I).FLD_ATTR).TITLE THEN  */                       347
   119     1    1          DO;                                                                348
   120     1    2             PUT SKIP EDIT(FLD(I).FLD_ROW,FLD(I).FLD_COL,                    349
                                            FLD(I).FLD_NAME) (X(5),F(5),F(5),X(1),A(28));     350
   121     1    2             CALL PRINT_ATTR(FLD(I).FLD_REC);                                351
                           /* PUT SKIP DATA(FLD(I)); */                                       352
   122     1    2          END;                                                               353
   123     1    1       END;                                                                  354

   124     1            IF GEN_MAP THEN                                                       355
   125     1            DO;                                                                   356
   126     1    1          CALL WRITE_PANEL;                                                  357
   127     1    1          CALL WRITE_MAPPING;                                                358
   128     1    1          PUT FILE(PANEL) EDIT('END',PANEL_SEQ)                              359
                                                        (COL(10),A,COL(73),P'999999V99');     360
   129     1    1          PANEL_SEQ=PANEL_SEQ+1;                                             361
   130     1    1       END;                                                                  362
   131     1            IF GEN_ASM THEN                                                       363
   132     1               CALL WRITE_ASM;                                                    364
   133     1            IF GEN_COB THEN                                                       365
   134     1               CALL WRITE_COB;                                                    366
   135     1            IF GEN_PLI THEN                                                       367
   136     1               CALL WRITE_PL1;                                                    368
                        /*                                                                    369
                          END OF EXECUTION - SET RETURN CODE                                  369
                        */                                                                    369
                                                                                              371
   137     1            IF ERROR_FOUND THEN RETURN_CODE=16;                                   372
   139     1            PUT SKIP(3) EDIT('END OF MAPGEN EXECUTION - RETURN CODE IS ',         373
                                         RETURN_CODE) (A,P'9999');                            374
   140     1            CALL IHESARC(RETURN_CODE);                                            375
                     /***************** END OF MAINLINE ****************/                     376
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     65


   STMT LEVEL NEST

                     /*********************************************************************/  377
                     /*                                                                   */  378
                     /*   THIS IS WHERE THE EXEC CARD PARM IS PARSED.                     */  379
                     /*   THE ALLOWABLE OPTIONS ARE 'ASM COB PLI MAP' AND THE 'NO'        */  380
                     /*   PREFIX.  DEFAULT WILL BE 'ASM,COB,PLI,MAP'                      */  381
                     /*                                                                   */  382
                     /*********************************************************************/  383
   141     1         PROCESS_PARM:PROC;                                                       384
   142     2            DECLARE WORK_PARM            CHAR(100) VARYING;                       385
   143     2            DECLARE NEXT_CHAR            FIXED BIN(15) ALIGNED;                   386
   144     2            IF LENGTH(EXEC_PARM) = 0 THEN                                         387
   145     2            DO;                             /* USE THE DEFAULTS */                388
   146     2    1          PUT SKIP(2) EDIT('*** USING DEFAULT EXEC PARM ',                   389
                                            '''ASM,COB,PLI,MAP''')                            390
                                     (A,A);                                                   391
   147     2    1          RETURN;                                                            392
   148     2    1       END;                                                                  393
   149     2            PUT SKIP(2) EDIT('*** USING EXEC PARM ''',EXEC_PARM, '''')            394
                                     (A,A,A);                                                 395
   150     2            IF LENGTH(EXEC_PARM) < 3 THEN                                         396
   151     2            DO;                             /* USE THE DEFAULTS */                397
   152     2    1          PUT SKIP(2) EDIT('*** INVALID EXEC PARM ***')                      398
                                     (A);                                                     399
   153     2    1          PUT SKIP EDIT('*** USING DEFAULT EXEC PARM ',                      400
                                            '''ASM,COB,PLI,MAP''')                            401
                                     (A,A);                                                   402
   154     2    1          RETURN;                                                            403
   155     2    1       END;                                                                  404
   156     2            WORK_PARM = EXEC_PARM;                                                405
   157     2            DO WHILE(LENGTH(WORK_PARM)>0);                                        406
                                /*                                                            407 1
   158     2    1        SELECT (TRUE)   */ DO;                                               407 1
                                             /*                                               408 1
                            WHEN (SUBSTR(WORK_PARM,1,3) = 'ASM')    */                        408 1
   159     2    2                    IF (SUBSTR(WORK_PARM,1,3) = 'ASM') THEN                  408 1
   160     2    2                                 DO;                                         408 1
   161     2    3             GEN_ASM = TRUE;                                                 409
   162     2    3             NEXT_CHAR = 4;                                                  410
   163     2    3                        GO TO  ENDSELECT_MACRO1; END; /*                     411 1
                            WHEN (SUBSTR(WORK_PARM,1,3) = 'COB')    */                        411 1
   165     2    2                    IF (SUBSTR(WORK_PARM,1,3) = 'COB') THEN                  411 1
   166     2    2                                 DO;                                         411 1
   167     2    3             GEN_COB = TRUE;                                                 412
   168     2    3             NEXT_CHAR = 4;                                                  413
   169     2    3                        GO TO  ENDSELECT_MACRO1; END; /*                     414 1
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     66


   STMT LEVEL NEST

                            WHEN (SUBSTR(WORK_PARM,1,3) = 'PLI')    */                        414 1
   171     2    2                    IF (SUBSTR(WORK_PARM,1,3) = 'PLI') THEN                  414 1
   172     2    2                                 DO;                                         414 1
   173     2    3             GEN_PLI = TRUE;                                                 415
   174     2    3             NEXT_CHAR = 4;                                                  416
   175     2    3                        GO TO  ENDSELECT_MACRO1; END; /*                     417 1
                            WHEN (SUBSTR(WORK_PARM,1,3) = 'MAP')    */                        417 1
   177     2    2                    IF (SUBSTR(WORK_PARM,1,3) = 'MAP') THEN                  417 1
   178     2    2                                 DO;                                         417 1
   179     2    3             GEN_MAP = TRUE;                                                 418
   180     2    3             NEXT_CHAR = 4;                                                  419
   181     2    3                        GO TO  ENDSELECT_MACRO1; END; /*                     420 1
                            WHEN (SUBSTR(WORK_PARM,1,5) = 'NOASM')    */                      420 1
   183     2    2                    IF (SUBSTR(WORK_PARM,1,5) = 'NOASM') THEN                420 1
   184     2    2                                 DO;                                         420 1
   185     2    3             GEN_ASM = FALSE;                                                421
   186     2    3             NEXT_CHAR = 6;                                                  422
   187     2    3                        GO TO  ENDSELECT_MACRO1; END; /*                     423 1
                            WHEN (SUBSTR(WORK_PARM,1,5) = 'NOCOB')    */                      423 1
   189     2    2                    IF (SUBSTR(WORK_PARM,1,5) = 'NOCOB') THEN                423 1
   190     2    2                                 DO;                                         423 1
   191     2    3             GEN_COB = FALSE;                                                424
   192     2    3             NEXT_CHAR = 6;                                                  425
   193     2    3                        GO TO  ENDSELECT_MACRO1; END; /*                     426 1
                            WHEN (SUBSTR(WORK_PARM,1,5) = 'NOPLI')    */                      426 1
   195     2    2                    IF (SUBSTR(WORK_PARM,1,5) = 'NOPLI') THEN                426 1
   196     2    2                                 DO;                                         426 1
   197     2    3             GEN_PLI = FALSE;                                                427
   198     2    3             NEXT_CHAR = 6;                                                  428
   199     2    3                        GO TO  ENDSELECT_MACRO1; END; /*                     429 1
                            WHEN (SUBSTR(WORK_PARM,1,5) = 'NOMAP')    */                      429 1
   201     2    2                    IF (SUBSTR(WORK_PARM,1,5) = 'NOMAP') THEN                429 1
   202     2    2                                 DO;                                         429 1
   203     2    3             GEN_MAP = FALSE;                                                430
   204     2    3             NEXT_CHAR = 6;                                                  431
   205     2    3                      END; /*                                                432 1
   206     2    2        OTHERWISE     */  ELSE DO;                                           432 1
                                                                                              432 1
   207     2    3       DO;                                                                   433
   208     2    4          PUT SKIP EDIT('*** UNRECOGNIZED PARM FOUND ***') (A);              434
   209     2    4          ERROR_FOUND=TRUE;                                                  435
   210     2    4          RETURN;                                                            436
   211     2    4       END;                                                                  437
   212     2    3                      END; /*                                                438 1
   213     2    2        ENDSELECT     */  END; ENDSELECT_MACRO1:;                            438 1
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     67


   STMT LEVEL NEST

   215     2    1       IF NEXT_CHAR > LENGTH(WORK_PARM) THEN                                 439
   216     2    1          WORK_PARM = '';                                                    440
   217     2    1       ELSE                                                                  441
   217     2    1       IF SUBSTR(WORK_PARM,NEXT_CHAR,1) = ',' THEN                           442
   218     2    1          WORK_PARM = SUBSTR(WORK_PARM,NEXT_CHAR+1);                         443
                      /*PUT SKIP DATA(WORK_PARM,GEN_ASM,GEN_COB,GEN_PLI,GEN_MAP);*/           444
   219     2    1       END; /* OF DO */                                                      445
   220     2         END PROCESS_PARM;                                                        446
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     68


   STMT LEVEL NEST

                     /*********************************************************************/  447
                     /*                                                                   */  448
                     /*   THIS IS THE INITIALIZATION.  ALL THE FLD (FIELD) AND ATTRS ARE  */  449
                     /*   INITIALIZED.                                                    */  450
                     /*                                                                   */  451
                     /*********************************************************************/  452
   221     1         INITIALIZE:PROC;                                                         453
   222     2            FLD_CTR = 0;                                                          454
   223     2            FLD(*).FLD_ROW = 0;                                                   455
   224     2            FLD(*).FLD_COL = 0;                                                   456
   225     2            FLD(*).FLD_ATTR = 0;                                                  457
   226     2            FLD(*).FLD_DATA='';                                                   458
   227     2            FLD(*).FLD_NAME='';                                                   459
   228     2            FLD(*).FLD_INT_NAME=(6)' ';                                           460
   229     2            FLD(*).ATTR_CHR = ' ';                                                461
   230     2            FLD(*).ATTR_A = '';                                                   462
   231     2            FLD(*).PROT = FALSE;                                                  463
   232     2            FLD(*).NUM = FALSE;                                                   464
   233     2            FLD(*).BRIGHT = FALSE;                                                465
   234     2            FLD(*).TITLE = FALSE;                                                 466
   235     2            FLD(*).STOP_BIT = FALSE;                                              467
   236     2            FLD(*).CUR = FALSE;                                                   468
   237     2            FLD(*).HI_LIGHT = ' ';                                                469
   238     2            FLD(*).COLOR = ' ';                                                   470
   239     2            VAR_CTR = 0;                                                          471
   240     2            VAR(*).VAR_NAME=' ';                                                  472
   241     2            VAR(*).VAR_FLD='';                                                    473
   242     2            REC_CTR = 0;                                                          474
   243     2            ATTR_TBL(*).ATTR_CHR = ' ';                                           475
   244     2            ATTR_TBL(*).ATTR_A = '';                                              476
   245     2            ATTR_TBL(*).PROT = FALSE;                                             477
   246     2            ATTR_TBL(*).NUM = FALSE;                                              478
   247     2            ATTR_TBL(*).BRIGHT = FALSE;                                           479
   248     2            ATTR_TBL(*).TITLE = FALSE;                                            480
   249     2            ATTR_TBL(*).STOP_BIT = FALSE;                                         481
   250     2            ATTR_TBL(*).CUR = FALSE;                                              482
   251     2            ATTR_TBL(*).HI_LIGHT = ' ';                                           483
   252     2            ATTR_TBL(*).COLOR = ' ';                                              484
   253     2         END INITIALIZE;                                                          485
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     69


   STMT LEVEL NEST

                     /*********************************************************************/  486
                     /*                                                                   */  487
                     /*   THIS IS THE MAIN INPUT PROCESS CONTROL.  NOTE THAT THERE IS     */  488
                     /*   NO ENFORCMENT OF THE SEQUENCE OF THE INPUT SECTIONS.            */  489
                     /*   THE CORRECT SEQUENCE IS .ATTR, .SCREEN, .VARS                   */  490
                     /*                                                                   */  491
                     /*********************************************************************/  492

   254     1         PROCESS_MYREC:PROC;                                                      493
                                                                                              494
   255     2           IF PROCESS_STATUS = '.ATTR  '        THEN CALL PROCESS_ATTRIBUTE;      495
   257     2           ELSE IF  PROCESS_STATUS = '.SCREEN'  THEN CALL PROCESS_SCREEN;         496
   259     2           ELSE IF  PROCESS_STATUS = '.VARS  '  THEN CALL PROCESS_VARS;           497
                                                                                              498
   261     2         END PROCESS_MYREC;                                                       499
                                                                                              500
   262     1         PROCESS_ATTRIBUTE:PROC;                                                  501
   263     2            DECLARE ATTRIB              CHAR(1);                                  502
   264     2            DECLARE (TEMP,TEMP2)        CHAR(78) VARYING;                         503
   265     2            DECLARE I                   FIXED BINARY(15);                         504
   266     2            I = 3;                                                                505
   267     2            DO WHILE (I<80 & SUBSTR(MY_REC,I,1)^=' ');                            506
   268     2    1          I=I+1;                                                             507
   269     2    1       END;                                                                  508
   270     2            TEMP,TEMP2 = SUBSTR(MY_REC,3,I-3);                                    509
   271     2            A = A + 1;                                                            510
   272     2            ATTR_TBL(A).ATTR_A = '('||TEMP2||')';                                 511
   273     2            ATTR_TBL(A).ATTR_CHR = SUBSTR(MY_REC,1,1);                            512
   274     2            I=1;                                                                  513
   275     2            DO WHILE(I>0);                                                        514
   276     2    1          I=INDEX(TEMP,',');                                                 515
   277     2    1          IF I>0 THEN                                                        516
   278     2    1          DO;                                                                517
   279     2    2             CALL CHECK_ATTR(SUBSTR(TEMP,1,I-1),ATTR_TBL(A));                518
   280     2    2             TEMP=SUBSTR(TEMP,I+1);                                          519
   281     2    2          END;                                                               520
   282     2    1          ELSE                                                               521
   282     2    1             CALL CHECK_ATTR(TEMP,ATTR_TBL(A));                              522
   283     2    1       END;                                                                  523
   284     2            IF ATTR_TBL(A).TITLE THEN          /* OVERRIDE SOME ATTRS  */         524
   285     2            DO;                                /* FOR TYPE TITLE       */         525
   286     2    1          ATTR_TBL(A).TITLE = TRUE;                                          526
   287     2    1          ATTR_TBL(A).PROT = TRUE;                                           527
                        /**ATTR_TBL(A).BRIGHT = FALSE;  DO NOT OVERRIDE BRIGHT   **/          528
   288     2    1          ATTR_TBL(A).NUM = FALSE;                                           529
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     70


   STMT LEVEL NEST

   289     2    1          ATTR_TBL(A).STOP_BIT = FALSE;                                      530
   290     2    1          ATTR_TBL(A).CUR = FALSE;                                           531
   291     2    1       END;                                                                  532
                      /*PUT SKIP DATA(A,ATTR_TBL(A));*/                                       533
   292     2         END PROCESS_ATTRIBUTE;                                                   534

                     /*********************************************************************/  535
                     /*                                                                   */  536
                     /*   THIS ROUTINE PROCESSES ALL OF THE ATTRIBUTES.  THEY CAN BE      */  537
                     /*   SPECIFIED IN THE .ATTR OR .VARS SECTION.  THE MAP DEFAULTS      */  538
                     /*   CAN BE SET IN THE .ATTR AND OVERRIDEN FOR EACH FIELD IN THE     */  539
                     /*   .VARS SECTION.                                                  */  540
                     /*                                                                   */  541
                     /*********************************************************************/  542

   293     1         CHECK_ATTR:PROC(AT,ATTR);                                                543
   294     2            DCL AT CHAR(*) VARYING,                                               544
                            ATTR LIKE ATTR_REC;                                               545
                                /*                                                            546 1
   295     2             SELECT (AT)   */ DO; ;                                               546 1
                                            /*                                                547 1
                           WHEN ('TITLE')    */                                               547 1
   297     2    1                   IF (AT)=('TITLE') THEN                                    547 1
   298     2    1                                DO;      ATTR.TITLE = TRUE;                  547 1
   300     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      548 1
                           WHEN ('BRIGHT')    */                                              548 1
   302     2    1                   IF (AT)=('BRIGHT') THEN                                   548 1
   303     2    1                                DO;     ATTR.BRIGHT = TRUE;                  548 1
   305     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      549 1
                           WHEN ('NORMAL')    */                                              549 1
   307     2    1                   IF (AT)=('NORMAL') THEN                                   549 1
   308     2    1                                DO;     ATTR.BRIGHT = FALSE;                 549 1
   310     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      550 1
                           WHEN ('NUM')    */                                                 550 1
   312     2    1                   IF (AT)=('NUM') THEN                                      550 1
   313     2    1                                DO;        ATTR.NUM = TRUE;                  550 1
   315     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      551 1
                           WHEN ('ALPHA')    */                                               551 1
   317     2    1                   IF (AT)=('ALPHA') THEN                                    551 1
   318     2    1                                DO;      ATTR.NUM = FALSE;                   551 1
   320     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      552 1
                           WHEN ('PROT')    */                                                552 1
   322     2    1                   IF (AT)=('PROT') THEN                                     552 1
   323     2    1                                DO;       ATTR.PROT = TRUE;                  552 1
   325     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      553 1
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     71


   STMT LEVEL NEST

                           WHEN ('UNPROT')    */                                              553 1
   327     2    1                   IF (AT)=('UNPROT') THEN                                   553 1
   328     2    1                                DO;     ATTR.PROT = FALSE;                   553 1
   330     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      554 1
                           WHEN ('CUR')    */                                                 554 1
   332     2    1                   IF (AT)=('CUR') THEN                                      554 1
   333     2    1                                DO;        ATTR.CUR = TRUE;                  554 1
   335     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      555 1
                           WHEN ('STOP')    */                                                555 1
   337     2    1                   IF (AT)=('STOP') THEN                                     555 1
   338     2    1                                DO;       ATTR.STOP_BIT = TRUE;              555 1
   340     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      556 1
                           WHEN ('HIDEF')    */                                               556 1
   342     2    1                   IF (AT)=('HIDEF') THEN                                    556 1
   343     2    1                                DO;      ATTR.HI_LIGHT = 'D';                556 1
   345     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      557 1
                           WHEN ('BLINK')    */                                               557 1
   347     2    1                   IF (AT)=('BLINK') THEN                                    557 1
   348     2    1                                DO;      ATTR.HI_LIGHT = 'B';                557 1
   350     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      558 1
                           WHEN ('REVERSE')    */                                             558 1
   352     2    1                   IF (AT)=('REVERSE') THEN                                  558 1
   353     2    1                                DO;    ATTR.HI_LIGHT = 'R';                  558 1
   355     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      559 1
                           WHEN ('ULINE')    */                                               559 1
   357     2    1                   IF (AT)=('ULINE') THEN                                    559 1
   358     2    1                                DO;      ATTR.HI_LIGHT = 'U';                559 1
                                                               /* COLOR CODE */               560
   360     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      561 1
                           WHEN ('DEFAULT')    */                                             561 1
   362     2    1                   IF (AT)=('DEFAULT') THEN                                  561 1
   363     2    1                                DO;    ATTR.COLOR = 'DEF';  /* 40 */         561 1
   365     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      562 1
                           WHEN ('BLUE')    */                                                562 1
   367     2    1                   IF (AT)=('BLUE') THEN                                     562 1
   368     2    1                                DO;       ATTR.COLOR = 'BLU';  /* F1 */      562 1
   370     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      563 1
                           WHEN ('RED')    */                                                 563 1
   372     2    1                   IF (AT)=('RED') THEN                                      563 1
   373     2    1                                DO;        ATTR.COLOR = 'RED';  /* F2 */     563 1
   375     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      564 1
                           WHEN ('PINK')    */                                                564 1
   377     2    1                   IF (AT)=('PINK') THEN                                     564 1
   378     2    1                                DO;       ATTR.COLOR = 'PNK';  /* F3 */      564 1
   380     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      565 1
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     72


   STMT LEVEL NEST

                           WHEN ('GREEN')    */                                               565 1
   382     2    1                   IF (AT)=('GREEN') THEN                                    565 1
   383     2    1                                DO;      ATTR.COLOR = 'GRN';  /* F4 */       565 1
   385     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      566 1
                           WHEN ('TURQ')    */                                                566 1
   387     2    1                   IF (AT)=('TURQ') THEN                                     566 1
   388     2    1                                DO;       ATTR.COLOR = 'TUR';  /* F5 */      566 1
   390     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      567 1
                           WHEN ('YELLOW')    */                                              567 1
   392     2    1                   IF (AT)=('YELLOW') THEN                                   567 1
   393     2    1                                DO;     ATTR.COLOR = 'YEL';  /* F6 */        567 1
   395     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      568 1
                           WHEN ('WHITE')    */                                               568 1
   397     2    1                   IF (AT)=('WHITE') THEN                                    568 1
   398     2    1                                DO;      ATTR.COLOR = 'WHI';  /* F7 */       568 1
   400     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      569 1
                           WHEN ('BLACK')    */                                               569 1
   402     2    1                   IF (AT)=('BLACK') THEN                                    569 1
   403     2    1                                DO;      ATTR.COLOR = 'BLK';  /* F8 */       569 1
   405     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      570 1
                           WHEN ('DBLUE')    */                                               570 1
   407     2    1                   IF (AT)=('DBLUE') THEN                                    570 1
   408     2    1                                DO;      ATTR.COLOR = 'DBL';  /* F9 */       570 1
   410     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      571 1
                           WHEN ('ORANGE')    */                                              571 1
   412     2    1                   IF (AT)=('ORANGE') THEN                                   571 1
   413     2    1                                DO;     ATTR.COLOR = 'ORA';  /* FA */        571 1
   415     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      572 1
                           WHEN ('PURPLE')    */                                              572 1
   417     2    1                   IF (AT)=('PURPLE') THEN                                   572 1
   418     2    1                                DO;     ATTR.COLOR = 'PUR';  /* FB */        572 1
   420     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      573 1
                           WHEN ('PGREEN')    */                                              573 1
   422     2    1                   IF (AT)=('PGREEN') THEN                                   573 1
   423     2    1                                DO;     ATTR.COLOR = 'PGR';  /* FC */        573 1
   425     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      574 1
                           WHEN ('PTURQ')    */                                               574 1
   427     2    1                   IF (AT)=('PTURQ') THEN                                    574 1
   428     2    1                                DO;      ATTR.COLOR = 'PTQ';  /* FD */       574 1
   430     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      575 1
                           WHEN ('GREY')    */                                                575 1
   432     2    1                   IF (AT)=('GREY') THEN                                     575 1
   433     2    1                                DO;       ATTR.COLOR = 'GRY';  /* FE */      575 1
   435     2    2                       GO TO  ENDSELECT_MACRO2; END; /*                      576 1
                           WHEN ('NEUTRAL')    */                                             576 1
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     73


   STMT LEVEL NEST

   437     2    1                   IF (AT)=('NEUTRAL') THEN                                  576 1
   438     2    1                                DO;    ATTR.COLOR = 'NEU';  /* FF */         576 1
   440     2    2                      END; /*                                                577 1
   441     2    1        OTHERWISE     */  ELSE DO;                                           577 1
                                                                                              577 1
   442     2    2       DO;                                                                   578
   443     2    3          PUT SKIP EDIT('*** INVALID ATTRIBUTE ''',AT,''' DETECTED ***')     579
                                        (A,A,A);                                              580
   444     2    3          ERROR_FOUND = TRUE;                                                581
   445     2    3       END;                                                                  582
   446     2    2                      END; /*                                                583 1
   447     2    1        ENDSELECT     */  END; ENDSELECT_MACRO2:;                            583 1
                      /*PUT SKIP LIST(ATTR.COLOR);*/                                          584
   449     2         END CHECK_ATTR;                                                          585
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     74


   STMT LEVEL NEST

                     /*********************************************************************/  586
                     /*                                                                   */  587
                     /*   THIS ROUTINE PROCESSES ALL OF THE VARS LINES.  THE GENERAL      */  588
                     /*   FORMAT IS:                                                      */  589
                     /*   R99C99=NAME123,ATTR,ATTR COMMENTS                               */  590
                     /*   R99C99 IS THE NAME GENERATED BY MAP3270.                        */  591
                     /*   NAME IS 1 TO 28 CHARACTER NAME ASSIGNED BY THE PROGRAMMER.      */  592
                     /*   ,ATTR IS AN ADDITIONAL OR OVERRIDE ATTRIBUTE FOR THIS FIELD.    */  593
                     /*         0 OR MORE ATTRS MAY BE SPECIFIED.  THE LIST ENDS WHEN     */  594
                     /*         THE FIRST SPACE IS ENCOUNTERED.                           */  595
                     /*                                                                   */  596
                     /*********************************************************************/  597
                                                                                              598
   450     1         PROCESS_VARS:PROC;                                                       599
   451     2            DECLARE (MATCH_INI_NAME,MATCH_NAME) BIT(1) ALIGNED;                   600
   452     2            DECLARE (TEMP,TEMP2)        CHAR(78) VARYING;                         601
   453     2            DECLARE (I,COMMA,BLANK,NST,NLEN) FIXED BINARY(15) ALIGNED;            602
   454     2            DECLARE (FLD_NAME_PTR)           FIXED BINARY(15) ALIGNED;            603
   455     2            IF SUBSTR(MY_REC,7,1)^='=' THEN                                       604
   456     2            DO;                                                                   605
   457     2    1          PUT SKIP EDIT('*** EXPECTED ''='' NOT FOUND ***') (A);             606
   458     2    1          ERROR_FOUND = TRUE;                                                607
   459     2    1          RETURN;                                                            608
   460     2    1       END;                                                                  609
   461     2            COMMA=INDEX(MY_REC,',');                                              610
   462     2            BLANK=INDEX(MY_REC,' ');                                              611
   463     2            NST=8;                                                                612
                                /*                                                            613 1
   464     2             SELECT (TRUE)   */ DO; ;                                             613 1
                                             /*                                               614 1
                            WHEN (COMMA=0 & BLANK>0)    */                                    614 1
   466     2    1                    IF (COMMA=0 & BLANK>0) THEN                              614 1
   467     2    1                                 DO;   /* NO COMMA FOUND BUT A BLANK WAS */  614 1
   468     2    2               NLEN=BLANK-NST;                                               615
   469     2    2                        GO TO  ENDSELECT_MACRO3; END; /*                     616 1
                            WHEN (BLANK=0 & COMMA>0)    */                                    616 1
   471     2    1                    IF (BLANK=0 & COMMA>0) THEN                              616 1
   472     2    1                                 DO;     /* NO BLANK FOUND BUT A COMMA WAS   616 1
                     */                                                                       616
   473     2    2              NLEN=COMMA-NST;                                                617
   474     2    2                        GO TO  ENDSELECT_MACRO3; END; /*                     618 1
                            WHEN (COMMA<BLANK)    */                                          618 1
   476     2    1                    IF (COMMA<BLANK) THEN                                    618 1
   477     2    1                                 DO;     /* ATTR STARTS BEFORE BLANK         618 1
                     */                                                                       618
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     75


   STMT LEVEL NEST

   478     2    2              NLEN=COMMA-NST;                                                619
   479     2    2                        GO TO  ENDSELECT_MACRO3; END; /*                     620 1
                            WHEN (COMMA>BLANK)    */                                          620 1
   481     2    1                    IF (COMMA>BLANK) THEN                                    620 1
   482     2    1                                 DO;     /* BLANK APPEARS BEFORE COMMA       620 1
                     */                                                                       620
   483     2    2              NLEN=BLANK-NST;                                                621
   484     2    2                         END; /*                                             622 1
   485     2    1           OTHERWISE     */  ELSE DO;                                        622 1
                                                                                              622 1
   486     2    2          DO;                                                                623
   487     2    3             PUT SKIP EDIT('*** LOGIC ERROR 1 ***') (A);                     624
   488     2    3             ERROR_FOUND = TRUE;                                             625
   489     2    3             RETURN;                                                         626
   490     2    3          END;                                                               627
   491     2    2                      END; /*                                                628 1
   492     2    1        ENDSELECT     */  END; ENDSELECT_MACRO3:;                            628 1
   494     2            IF NLEN>26 THEN                                                       629
   495     2            DO;                                                                   630
   496     2    1          PUT SKIP EDIT('*** INCORRECT FIELD LENGTHS ***') (A);              631
   497     2    1          ERROR_FOUND = TRUE;                                                632
   498     2    1          RETURN;                                                            633
   499     2    1       END;                                                                  634
   500     2            DO I = 1 TO VAR_CTR;                                                  635
   501     2    1          IF VAR(I).VAR_NAME = SUBSTR(MY_REC,1,6) THEN                       636
   502     2    1          DO;                                                                637
   503     2    2              PUT SKIP EDIT('*** DUPLICATE VAR NAME ',VAR(I).VAR_NAME,       638
                                            ' ***') (A,A,A);                                  639
   504     2    2              ERROR_FOUND = TRUE;                                            640
   505     2    2              RETURN;                                                        641
   506     2    2          END;                                                               642
   507     2    1          IF VAR(I).VAR_FLD = SUBSTR(MY_REC,NST,NLEN) THEN                   643
   508     2    1          DO;                                                                644
   509     2    2              PUT SKIP EDIT('*** DUPLICATE VAR FIELD ',                      645
                                             SUBSTR(MY_REC,NST,NLEN),' ***') (A,A,A);         646
   510     2    2              ERROR_FOUND = TRUE;                                            647
   511     2    2              RETURN;                                                        648
   512     2    2          END;                                                               649
   513     2    1       END;                                                                  650
   514     2            MATCH_INI_NAME=FALSE;                                                 651
   515     2            MATCH_NAME=FALSE;                                                     652
   516     2            FLD_NAME_PTR=0;                                                       653
   517     2            DO WHILE(FLD_NAME_PTR<FLD_CTR & ^MATCH_INI_NAME);                     654
   518     2    1          FLD_NAME_PTR=FLD_NAME_PTR+1;                                       655
   519     2    1          MATCH_INI_NAME =                                                   656
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     76


   STMT LEVEL NEST

                                 (FLD(FLD_NAME_PTR).FLD_INT_NAME = SUBSTR(MY_REC,1,6));       657
   520     2    1       END;                                                                  658
   521     2            IF MATCH_INI_NAME THEN ;                                              659
   523     2            ELSE                                                                  660
   523     2            DO;                                                                   661
   524     2    1          PUT SKIP EDIT('*** INTERNAL NAME NOT DEFINED ',                    662
                                         SUBSTR(MY_REC,1,6),                                  663
                                         ' ***') (A,A,A);                                     664
   525     2    1          ERROR_FOUND = TRUE;                                                665
   526     2    1          RETURN;                                                            666
   527     2    1       END;                                                                  667
   528     2            VAR_CTR=VAR_CTR+1;                                                    668
   529     2            VAR(VAR_CTR).VAR_NAME=SUBSTR(MY_REC,1,6);                             669
   530     2            VAR(VAR_CTR).VAR_FLD=SUBSTR(MY_REC,NST,NLEN);                         670
                     /* PUT SKIP DATA(VAR(VAR_CTR).VAR_FLD,NLEN); */                          671
   531     2            I=INDEX(VAR(VAR_CTR).VAR_FLD,' ');                                    672
   532     2            IF I=0 THEN ;               /* NAME HAS NO SPACES - IT IS OK */       673
   534     2            ELSE                                                                  674
   534     2            IF I=1 THEN                                                           675
   535     2            DO;                                                                   676
   536     2    1          PUT SKIP EDIT('*** USER DEFINED NAME IS BLANK ***') (A);           677
   537     2    1          ERROR_FOUND = TRUE;                                                678
   538     2    1          RETURN;                                                            679
   539     2    1       END;                                                                  680
   540     2            IF COMMA=0 | BLANK<COMMA THEN    /* NO ATTRIBUTES */                  681
   541     2                RETURN;                                                           682
   542     2            TEMP,TEMP2 = SUBSTR(MY_REC,NST+NLEN+1);  /* GET RID OF NAME */        683
   543     2            BLANK=INDEX(TEMP,' ');                                                684
   544     2            IF BLANK>0 THEN TEMP,TEMP2=SUBSTR(TEMP,1,BLANK-1);                    685
   546     2            FLD(FLD_NAME_PTR).ATTR_A=FLD(FLD_NAME_PTR).ATTR_A||'<'||TEMP2||'>';   686
   547     2            I=1;                                                                  687
   548     2            DO WHILE(I>0);                                                        688
   549     2    1          I=INDEX(TEMP,',');                                                 689
   550     2    1          IF I>0 THEN                                                        690
   551     2    1          DO;                                                                691
   552     2    2             CALL CHECK_ATTR(SUBSTR(TEMP,1,I-1),FLD(FLD_NAME_PTR).FLD_REC);  692
   553     2    2             TEMP=SUBSTR(TEMP,I+1);                                          693
   554     2    2          END;                                                               694
   555     2    1          ELSE                                                               695
   555     2    1             CALL CHECK_ATTR(TEMP,FLD(FLD_NAME_PTR).FLD_REC);                696
   556     2    1       END;                                                                  697
                      /*PUT SKIP LIST ('INPUT=>',VAR_CTR,VAR(VAR_CTR).VAR_NAME,               698
                                                   ''''||VAR(VAR_CTR).VAR_FLD||'''');         698
                        PUT SKIP DATA (FLD(FLD_NAME_PTR));*/                                  698
                                                                                              700
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     77


   STMT LEVEL NEST

   557     2         END PROCESS_VARS;                                                        701
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     78


   STMT LEVEL NEST

                     /****************************************************************/       702
   558     1         PROCESS_SCREEN:PROC;                                                     703
                                                                                              704
   559     2            DECLARE (C,I               ) FIXED BINARY(15),                        705
                                 K                   CHAR(1);                                 706
   560     2            NO_ATTRIB = TRUE;                                                     707
   561     2            ROW = ROW + 1;                               /* COUNT ROW WE ARE  */  708
   562     2            B = B + 1; SCR_IMG(B) = '* ' || MY_REC;                               709
   564     2            COL = 1;                                                              710
   565     2            FLD_A = 1;                                                            711
   566     2            DO C = 1 TO 80;                              /* PROCESS ONE BY ONE*/  712
   567     2    1          K = SUBSTR(MY_REC,C,1);                   /* GET NEXT BYTE     */  713
   568     2    1          DO I = 1 TO A;                            /* TEST IF ATTRIBUTE */  714
   569     2    2             IF ATTR_TBL(I).ATTR_CHR = K THEN       /* IF WE FIND AN     */  715
   570     2    2             DO;                                    /*  ATTRIBUTE        */  716
   571     2    3                NO_ATTRIB = FALSE;                                           717
   572     2    3                IF FLD_DEF  ^= '' THEN              /* AND WE ALREADY    */  718
   573     2    3                DO;                                                          719
   574     2    4                    CALL SAVE_FIELD(FLD_A);         /*  HAVE DATA        */  720
   575     2    4                    FLD_DEF = '';                                            721
   576     2    4                END;                                                         722
   577     2    3                COL = C;                                                     723
   578     2    3                FLD_A = I;                                                   724
   579     2    3             END; /* IF */                                                   725
   580     2    2          END; /* DO */                                                      726
                        /* IF NO_ATTRIB THEN  ;                                               727
                           ELSE                                                               727
                        */                                                                    727
   581     2    1     DO;                                                                     729
   582     2    2             FLD_DEF = FLD_DEF  || K;                                        730
                             /*  IF SUBSTR(X,C,1)= '''' THEN DATA = DATA  ''''  */          731
   583     2    2          END;                                                               732
   584     2    1       END; /* DO */                                                         733
   585     2            IF LENGTH(FLD_DEF)>0 THEN                                             734
   586     2            DO;                                                                   735
   587     2    1          CALL SAVE_FIELD(FLD_A);                                            736
   588     2    1          FLD_DEF = '';                                                      737
   589     2    1       END;                                                                  738
   590     2         END PROCESS_SCREEN;                                                      739
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     79


   STMT LEVEL NEST

                     /****************************************************************/       740
   591     1         SAVE_FIELD:PROC(I);                                                      741
   592     2            DECLARE I FIXED BINARY(15);                                           742
   593     2            DECLARE (R,C) PICTURE '99';                                           743
   594     2            FLD_CTR = FLD_CTR + 1;                                                744
   595     2            FLD(FLD_CTR).FLD_DATA = FLD_DEF;                                      745
   596     2            R=ROW;                                                                746
   597     2            C=COL;                                                                747
   598     2            FLD(FLD_CTR).FLD_INT_NAME,                                            748
                        FLD(FLD_CTR).FLD_NAME = 'R'||R||'C'||C;                               749
   599     2            FLD(FLD_CTR).FLD_ROW  = ROW;                                          750
   600     2            FLD(FLD_CTR).FLD_COL  = COL;                                          751
   601     2            FLD(FLD_CTR).FLD_ATTR = I;                                            752
   602     2            FLD(FLD_CTR).FLD_REC = ATTR_TBL(I);                                   753
                      /*PUT SKIP DATA(FLD(FLD_CTR));*/                                        754
   603     2         END SAVE_FIELD;                                                          755
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     80


   STMT LEVEL NEST

                     /*********************************************************************/  756
                     /*                                                                   */  757
                     /* PRINT_ATTR - PRINT ATTRIBUTES FOR A GIVEN FIELD                   */  758
                     /*                                                                   */  759
                     /*********************************************************************/  760
   604     1         PRINT_ATTR:PROC(ATTR);                                                   761
   605     2            DECLARE ATTR LIKE ATTR_REC;                                           762
   606     2               IF ATTR.TITLE THEN                                                 763
   607     2                  PUT EDIT('TITLE ') (A);                                         764
                                                                                              765
   608     2               IF ATTR.NUM THEN PUT EDIT('NUM ') (A);                             766
   610     2               ELSE PUT EDIT('ALPHA ') (A);                                       767
                                                                                              768
   611     2               IF ATTR.PROT THEN PUT EDIT('PROT ') (A);                           769
   613     2               ELSE PUT EDIT('UNPROT ') (A);                                      770
                                                                                              771
   614     2               IF ATTR.BRIGHT THEN PUT EDIT('BRIGHT ') (A);                       772
   616     2               ELSE PUT EDIT('NORMAL ') (A);                                      773
                                                                                              774
                                   /*                                                         775 1
   617     2                SELECT (ATTR.HI_LIGHT)   */ DO;                                   775 1
                                                 /*                                           776 1
                                WHEN (' ')    */                                              776 1
   618     2    1                        IF (ATTR.HI_LIGHT)=(' ') THEN                        776 1
   619     2    1                                     DO;   ;                                 776 1
   621     2    2                            GO TO  ENDSELECT_MACRO4; END; /*                 777 1
                                WHEN ('D')    */                                              777 1
   623     2    1                        IF (ATTR.HI_LIGHT)=('D') THEN                        777 1
   624     2    1                                     DO;   PUT EDIT('HI DEFAULT ') (A);      777 1
   626     2    2                            GO TO  ENDSELECT_MACRO4; END; /*                 778 1
                                WHEN ('U')    */                                              778 1
   628     2    1                        IF (ATTR.HI_LIGHT)=('U') THEN                        778 1
   629     2    1                                     DO;   PUT EDIT('UNDERLINE ') (A);       778 1
   631     2    2                            GO TO  ENDSELECT_MACRO4; END; /*                 779 1
                                WHEN ('R')    */                                              779 1
   633     2    1                        IF (ATTR.HI_LIGHT)=('R') THEN                        779 1
   634     2    1                                     DO;   PUT EDIT('REVERSE ') (A);         779 1
   636     2    2                            GO TO  ENDSELECT_MACRO4; END; /*                 780 1
                                WHEN ('B')    */                                              780 1
   638     2    1                        IF (ATTR.HI_LIGHT)=('B') THEN                        780 1
   639     2    1                                     DO;   PUT EDIT('BLINK ') (A);           780 1
   641     2    2                             END; /*                                         781 1
   642     2    1               OTHERWISE     */  ELSE DO;                                    781 1
                                                                                              781 1
   643     2    2              DO;                                                            782
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     81


   STMT LEVEL NEST

   644     2    3                  PUT SKIP(2) EDIT('*** ERROR *** INVALID ATTRIBUTE ',       783
                                                    'VALUE ***') (A,A);                       784
   645     2    3                  ERROR_FOUND = TRUE;                                        785
   646     2    3              END;                                                           786
   647     2    2                         END; /*                                             787 1
   648     2    1           ENDSELECT     */  END; ENDSELECT_MACRO4:;                         787 1
   650     2               IF ATTR.CUR  THEN PUT EDIT('CUR ') (A);                            789
                                                                                              790
   652     2               IF ATTR.STOP_BIT THEN PUT EDIT('STOP ') (A);                       791
   654     2               PUT EDIT(ATTR.COLOR,' ') (A,A);                                    792
   655     2         END PRINT_ATTR;                                                          793
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     82


   STMT LEVEL NEST

                     /*********************************************************************/  794
                     /*                                                                   */  795
                     /* WRITE_PANEL - WRITE THE MACROS TO GENERATE THE PANEL              */  796
                     /*                                                                   */  797
                     /* IN THE MAP3270 SYSTEM, THE PANEL IS A LOAD MODULE GENERATED FROM  */  798
                     /* ASSEMBLER CODE GENERATED BY THIS PROGRAM.  THE PANEL HAS 3        */  799
                     /* SECTIONS:                                                         */  800
                     /*    1) INDEX TO THE  DATA STREAM, CROSS REFERENCE AND INSERT       */  801
                     /*       CURSOR AREAS.                                               */  802
                     /*    2) 3270 DATA STEAM WHICH CONTAINS THE INSERT CURSOR STUFF.     */  803
                     /*    3) CROSS REFERENCE WHICH MAPS THE FIELDS IN THE DATA STREAM    */  804
                     /*       TO THE USER MAP.                                            */  805
                     /*                                                                   */  806
                     /*********************************************************************/  807
   656     1         WRITE_PANEL:PROC;                                                        808
   657     2            DECLARE M FIXED BIN(15);                                              809
   658     2            DECLARE IC_WRITTEN  BIT(1) ALIGNED;                                   810
                                                                                              811
   659     2            OPEN FILE(PANEL) TITLE('MAP');                                        812
                                                                                              813
   660     2            PUT FILE(PANEL) EDIT('TITLE ''PANEL ',PANEL_NAME,' ',                 814
                                             TITLE_STAMP,'''')     (COL(10),A,A,A,A,A)        815
                                            (PANEL_SEQ)            (COL(73),P'999999V99');    816
   661     2            PANE_SEQ=PANEL_SEQ+1;                                                 817
   662     2            PUT FILE(PANEL) EDIT(DT_TIME_STAMP)                    (COL(1),A)     818
                                            (PANEL_SEQ)            (COL(73),P'999999V99')     819
                                            (PANEL_NAME,'TSECT')            (A,COL(10),A)     820
                                            (PANEL_SEQ+1)          (COL(73),P'999999V99')     821
                                            ('DC    A(', PANEL_NAME||'P)' ) (COL(10),A,A)     822
                                            (PANEL_SEQ+2)          (COL(73),P'999999V99')     823
                                            ('DC    A(', PANEL_NAME||'M)' ) (COL(10),A,A)     824
                                            (PANEL_SEQ+3)          (COL(73),P'999999V99')     825
                                            ('DC    A(', PANEL_NAME||'C)' ) (COL(10),A,A)     826
                                            (PANEL_SEQ+4)          (COL(73),P'999999V99');    827
   663     2            PANEL_SEQ=PANEL_SEQ+5;                                                828
   664     2            PUT FILE(PANEL)                                                       829
                                   EDIT(PANEL_NAME,'TSTPAN',PANEL_SEQ)                        830
                                                        (A,COL(10),A,COL(73),P'999999V99')    831
                                       ('TWCC  RESET=YES,RSTMDT=YES',PANEL_SEQ+1)             832
                                                          (COL(10),A,COL(73),P'999999V99');   833
   665     2            PANEL_SEQ=PANEL_SEQ+2;                                                834
   666     2            IC_WRITTEN=FALSE;                                                     835
   667     2            M = FLD_CTR;                                                          836
   668     2            DO WHILE (M>0);                                                       837
   669     2    1          IF ATTR_TBL(FLD(M).FLD_ATTR).CUR THEN                              838
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     83


   STMT LEVEL NEST

   670     2    1          DO;                                                                839
   671     2    2             CALL WRITE_IC(FLD(M).FLD_ROW,FLD(M).FLD_COL);                   840
   672     2    2             IC_WRITTEN=TRUE;                                                841
   673     2    2             M = 0;                                                          842
   674     2    2          END;                                                               843
   675     2    1          M=M-1;                                                             844
   676     2    1       END;  /* DO */                                                        845
   677     2            IF ^IC_WRITTEN THEN                                                   846
   678     2               CALL WRITE_IC(ONE,ONE);                                            847
   679     2            DO M = 1 TO FLD_CTR;                                                  848
   680     2    1          CALL WRITE_FIELD(M);                                               849
   681     2    1       END;                                                                  850
   682     2            PUT FILE(PANEL) EDIT('TENDPAN',PANEL_SEQ)                             851
                                                        (COL(10),A,COL(73),P'999999V99');     852
   683     2            PANEL_SEQ=PANEL_SEQ+1;                                                853
                     /****************************************************************/       854
   684     2         WRITE_IC:PROC(R,C);                                                      855
   685     3            DECLARE (R,C)  FIXED BIN(15);                                         856
                                                                                              857
   686     3            PUT FILE(PANEL)                                                       858
                                 EDIT(PANEL_NAME||'C',                                        859
                                             'TCMD  CMD=SBA,ROW=',R,',COL=',C,PANEL_SEQ)      860
                                          (A,COL(10),A,P'99',A,P'99',COL(73),P'999999V99')    861
                                     ('         TCMD  CMD=IC',PANEL_SEQ+1)                    862
                                                                 (A,COL(73),P'999999V99');    863
   687     3            PANEL_SEQ=PANEL_SEQ+2;                                                864
                                                                                              865
   688     3         END WRITE_IC;                                                            866
                     /****************************************************************/       867
   689     2         WRITE_FIELD:PROC(F);                                                     868
   690     3            DECLARE F FIXED BIN(15);                                              869
   691     3            DECLARE A FIXED BIN(15);                                              870
   692     3            DECLARE I FIXED BIN(15);                                              871
   693     3            DECLARE MACRO_LN CHAR(160) VARYING;                                   872
   694     3            DECLARE LN_PIC   PIC '99';                                            873
   695     3            DECLARE FLD_NAME CHAR(8) VARYING;   /* FORMAT R99C99 */               874
   696     3            A = FLD(F).FLD_ATTR;                                                  875
                      /*****                                                                  876
                        PUT SKIP DATA(FLD(F));                                                876
                        PUT SKIP DATA(ATTR_TBL(A));                                           876
                      *****/                                                                  876
                                                                                              879
   697     3            FLD_DEF=SUBSTR(FLD(F).FLD_DATA,2);                                    880
   698     3            I = LENGTH(FLD_DEF);                                                  881
   699     3            DO WHILE(SUBSTR(FLD_DEF,I,1)=' ' & I>0);                              882
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     84


   STMT LEVEL NEST

   700     3    1          I=I-1;                                                             883
   701     3    1       END;                                                                  884
   702     3            IF I=0 THEN FLD_DEF='';                                               885
   704     3            ELSE FLD_DEF=SUBSTR(FLD_DEF,1,I);                                     886
                     /* PUT SKIP DATA(FLD_DEF); */                                            887
                        /* MAKE SURE THAT FIELDS DON'T GO PAST COL 80 */                      888
   705     3            IF LENGTH(FLD_DEF)+FLD(F).FLD_COL   > 80 THEN                         889
   706     3            DO;                                                                   890
   707     3    1          PUT SKIP EDIT('*** ERROR PROCESSING ROW ',FLD(F).FLD_ROW,          891
                                         ' COL ',FLD(F).FLD_COL,': FIELD EXCEEDS COL 80')     892
                                         (A,F(3),A,F(3),A);                                   893
   708     3    1          RETURN;                                                            894
   709     3    1       END;                                                                  895
   710     3            FLD_NAME = SUBSTR(FLD(F).FLD_INT_NAME||(6)' ',1,6);                   896
   711     3            PUT FILE(PANEL)                                                       897
                            SKIP EDIT('TCMD  CMD=SBA,ROW=',                                   898
                                                    FLD(F).FLD_ROW,',COL=',                   899
                                                    FLD(F).FLD_COL,PANEL_SEQ)                 900
                                     (COL(10),A,P'99',A,P'99',COL(73),P'999999V99');          901
   712     3            PANEL_SEQ=PANEL_SEQ+1;                                                902
   713     3            LN_PIC = LENGTH(FLD_DEF);                                             903
   714     3            IF LN_PIC = '00' | ATTR_TBL(A).TITLE THEN                             904
   715     3               MACRO_LN = '         TCMD  CMD=SF,MDT=NO';                         905
   716     3            ELSE                                                                  906
   716     3            DO;                                                                   907
   717     3    1          MACRO_LN = FLD_NAME ||'   TCMD  CMD=SF,MDT=YES,LN=' || LN_PIC;     908
   718     3    1          PUT SKIP FILE(PANEL) EDIT ('***',FLD(F).FLD_NAME,PANEL_SEQ)        909
                                                     (A,A,COL(73),P'999999V99');              910
   719     3    1          PANEL_SEQ=PANEL_SEQ+1;                                             911
   720     3    1       END;                                                                  912
   721     3            IF FLD(F).PROT THEN                                                   913
   722     3                MACRO_LN = MACRO_LN || ',PROT=YES';                               914
   723     3            ELSE                                                                  915
   723     3                MACRO_LN = MACRO_LN || ',PROT=NO';                                916
   724     3            IF FLD(F).BRIGHT THEN                                                 917
   725     3                MACRO_LN = MACRO_LN || ',BRIGHT=YES';                             918
   726     3            ELSE                                                                  919
   726     3                MACRO_LN = MACRO_LN || ',BRIGHT=NO';                              920
   727     3            IF FLD(F).NUM THEN                                                    921
   728     3                MACRO_LN = MACRO_LN || ',NUM=YES';                                922
   729     3            ELSE                                                                  923
   729     3                MACRO_LN = MACRO_LN || ',NUM=NO';                                 924
   730     3            IF FLD(F).STOP_BIT &                                                  925
                           LENGTH(FLD_DEF)+FLD(F).FLD_COL < 80 THEN                           926
   731     3                MACRO_LN = MACRO_LN || ',STOP=YES';                               927
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     85


   STMT LEVEL NEST

   732     3            ELSE                                                                  928
   732     3                MACRO_LN = MACRO_LN || ',STOP=NO';                                929

                                                                                              930
   733     3            IF FLD(F).HI_LIGHT ^= ' ' | FLD(F).COLOR ^= ' ' THEN                  931
   734     3            DO;                                                                   932
   735     3    1          MACRO_LN = MACRO_LN || ',';                                        933
   736     3    1          PUT FILE(PANEL)                                                    934
                                   EDIT(MACRO_LN,'*',PANEL_SEQ) (A,COL(72),A,P'999999V99');   935
   737     3    1          PANEL_SEQ=PANEL_SEQ+1;                                             936
   738     3    1          MACRO_LN = (15)' ';                                                937
   739     3    1          IF FLD(F).HI_LIGHT = 'U' THEN                                      938
   740     3    1             MACRO_LN = MACRO_LN || 'HILITE=ULN';                            939
   741     3    1          ELSE                                                               940
   741     3    1          IF FLD(F).HI_LIGHT = 'R' THEN                                      941
   742     3    1             MACRO_LN = MACRO_LN || 'HILITE=REV';                            942
   743     3    1          ELSE                                                               943
   743     3    1          IF FLD(F).HI_LIGHT = 'B' THEN                                      944
   744     3    1             MACRO_LN = MACRO_LN || 'HILITE=BLN';                            945
   745     3    1          ELSE                                                               946
   745     3    1          IF FLD(F).HI_LIGHT = 'D' THEN                                      947
   746     3    1             MACRO_LN = MACRO_LN || 'HILITE=DEF';                            948
   747     3    1          IF FLD(F).HI_LIGHT ^= ' ' & FLD(F).COLOR ^= ' ' THEN               949
   748     3    1             MACRO_LN = MACRO_LN || ',';                                     950
   749     3    1          IF FLD(F).COLOR ^= ' ' THEN                                        951
   750     3    1             MACRO_LN = MACRO_LN || 'COLOR=' || FLD(F).COLOR;                952
   751     3    1       END;                                                                  953

                                                                                              954
   752     3            IF LN_PIC = '00' THEN                                                 955
   753     3            DO;                                                                   956
   754     3    1          PUT FILE(PANEL)                                                    957
                                    EDIT(MACRO_LN,PANEL_SEQ) (A,COL(73),P'999999V99');        958
   755     3    1          PANEL_SEQ=PANEL_SEQ+1;                                             959
   756     3    1       END;                                                                  960
   757     3            ELSE                                                                  961
   757     3            DO;                                                                   962
   758     3    1          MACRO_LN = MACRO_LN || ',';                                        963
   759     3    1          PUT FILE(PANEL)                                                    964
                                   EDIT(MACRO_LN,'*',PANEL_SEQ) (A,COL(72),A,P'999999V99');   965
   760     3    1          PANEL_SEQ=PANEL_SEQ+1;                                             966
   761     3    1          MACRO_LN = (15)' ' ||'DATA='''||FLD_DEF||'''';                     967
   762     3    1          IF LENGTH(MACRO_LN)>71 THEN                                        968
   763     3    1          DO;                                                                969
   764     3    2             PUT FILE(PANEL)                                                 970
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     86


   STMT LEVEL NEST

                                       EDIT(MACRO_LN,'*',PANEL_SEQ) (A(71),A,P'999999V99')    971
                                         (SUBSTR(MACRO_LN,72),PANEL_SEQ+1)                    972
                                                              (COL(16),A(57),P'999999V99');   973
   765     3    2             PANEL_SEQ=PANEL_SEQ+2;                                          974
   766     3    2          END;                                                               975
   767     3    1          ELSE                                                               976
   767     3    1          DO;                                                                977
   768     3    2             PUT FILE(PANEL)                                                 978
                                       EDIT(MACRO_LN,PANEL_SEQ) (A,COL(73),P'999999V99');     979
   769     3    2          PANEL_SEQ=PANEL_SEQ+1;                                             980
   770     3    2          END;                                                               981
   771     3    1       END;                                                                  982
   772     3            FLD_DEF='';                                                           983
   773     3         END WRITE_FIELD;                                                         984
   774     2         END WRITE_PANEL;                                                         985
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     87


   STMT LEVEL NEST

                     /*********************************************************************/  986
                     /*                                                                   */  987
                     /* WRITE_MAPPING - WRITE THE PANEL TO USER FIELD MAPPING             */  988
                     /*                                                                   */  989
                     /*********************************************************************/  990
   775     1         WRITE_MAPPING:PROC;                                                      991
   776     2            DECLARE M FIXED BIN(15);                                              992
   777     2            PUT FILE(PANEL)                                                       993
                                   EDIT(PANEL_NAME||'M','TINPST') (A,COL(10),A)               994
                                       (PANEL_SEQ) (COL(73),P'999999V99');                    995
   778     2            PANEL_SEQ=PANEL_SEQ+1;                                                996
   779     2            DO M = 1 TO FLD_CTR;                                                  997
   780     2    1          CALL WRITE_FIELD(M);                                               998
   781     2    1       END;                                                                  999
   782     2            PUT FILE(PANEL)                                                      1000
                                EDIT('TINPEND',PANEL_SEQ) (COL(10),A,COL(73),P'999999V99');  1001
   783     2            PANEL_SEQ=PANEL_SEQ+1;                                               1002
   784     2            PUT FILE(PANEL) EDIT(DT_TIME_STAMP)                    (COL(1),A)    1003
                                            (PANEL_SEQ)            (COL(73),P'999999V99');   1004
   785     2            PANEL_SEQ=PANEL_SEQ+1;                                               1005
                     /****************************************************************/      1006
   786     2         WRITE_FIELD:PROC(F);                                                    1007
   787     3            DECLARE F FIXED BIN(15);                                             1008
   788     3            DECLARE A FIXED BIN(15);                                             1009
   789     3            DECLARE MACRO_LN CHAR(160) VARYING;                                  1010
   790     3            DECLARE FLD_DEF  CHAR(160) VARYING;                                  1011
   791     3            DECLARE FLD_NAME CHAR(8)  VARYING;   /* FORMAT R99C99 */             1012
   792     3            A = FLD(F).FLD_ATTR;                                                 1013
                      /*****                                                                 1014
                        PUT SKIP DATA(FLD(F));                                               1014
                        PUT SKIP DATA(ATTR_TBL(A));                                          1014
                      *****/                                                                 1014
                                                                                             1017
   793     3            FLD_DEF=SUBSTR(FLD(F).FLD_DATA,2);                                   1018
   794     3            I = LENGTH(FLD_DEF);                                                 1019
   795     3            DO WHILE(SUBSTR(FLD_DEF,I,1)=' ' & I>0);                             1020
   796     3    1          I=I-1;                                                            1021
   797     3    1       END;                                                                 1022
   798     3            IF I=0 THEN FLD_DEF='';                                              1023
   800     3            ELSE FLD_DEF=SUBSTR(FLD_DEF,1,I);                                    1024
   801     3            IF ^ATTR_TBL(A).TITLE THEN                                           1025
   802     3            DO;                                                                  1026
   803     3    1          PUT FILE(PANEL)                                                   1027
                                    EDIT(FLD(F).FLD_INT_NAME) (A)                            1028
                                        ('TINPMAP ',FLD(F).FLD_ROW,',') (COL(10),A,P'99',A)  1029
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     88


   STMT LEVEL NEST

                                                   (FLD(F).FLD_COL,',',                      1030
                                                    LENGTH(FLD_DEF)) (P'99',A,P'99')         1031
                                                   (FLD(F).FLD_NAME) (COL(40),A)             1032
                                          (PANEL_SEQ) (COL(73),P'999999V99');                1033
   804     3    1          PANEL_SEQ=PANEL_SEQ+1;                                            1034
   805     3    1       END;                                                                 1035
   806     3         END WRITE_FIELD;                                                        1036
   807     2         END WRITE_MAPPING;                                                      1037
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     89


   STMT LEVEL NEST

                     /*********************************************************************/ 1038
                     /*                                                                   */ 1039
                     /* WRITE_ASM - GENERATE THE USER COMM AREA - ASSEMBLER FORMAT        */ 1040
                     /*                                                                   */ 1041
                     /*********************************************************************/ 1042
   808     1         WRITE_ASM:PROC;                                                         1043
   809     2            DECLARE SEQ_NO            FIXED DEC(8,2) INIT(9);                    1044
   810     2            PUT FILE(ASM)  EDIT                                                  1045
                            (DT_TIME_STAMP,1)               (COL(1),A,COL(73),P'999999V99')  1046
                            ('TPARM    DS    0F',2)                (A,COL(73),P'999999V99')  1047
                            ('TNAME    DC    CL8''',PANEL_NAME,'''',3)                       1048
                                                                        (A,A,A,COL(73),      1049
                                                                              P'999999V99')  1050
                            ('TADDR    DC    A(0)',4)                   (A,COL(73),          1051
                                                                              P'999999V99')  1052
                            ('TRC      DC    H''0''',5)                 (A,COL(73),          1053
                                                                              P'999999V99')  1054
                            ('TAID     DC    X''0''',6)                 (A,COL(73),          1055
                                                                              P'999999V99')  1056
                            ('TSBA     DC    XL2''0000''',7)            (A,COL(73),          1057
                                                                              P'999999V99')  1058
                            ('         DC    X''0''',8)                 (A,COL(73),          1059
                                                                              P'999999V99'); 1060
   811     2            DO M = 1 TO FLD_CTR;                                                 1061
   812     2    1          CALL WRITE_PARM(M);                                               1062
   813     2    1       END;                                                                 1063
   814     2            PUT FILE(ASM) EDIT                                                   1064
                            ('         DC    C'' ''',SEQ_NO)       (A,COL(73),P'999999V99')  1065
                            ('         DC    AL2(0)',SEQ_NO+1)     (A,COL(73),P'999999V99')  1066
                            (DT_TIME_STAMP,SEQ_NO+2)        (COL(1),A,COL(73),P'999999V99'); 1067
   815     2            SEQ_NO=SEQ_NO+3;                                                     1068
   816     2         WRITE_PARM:PROC(F);                                                     1069
   817     3            DECLARE F FIXED BIN(15);                                             1070
   818     3            DECLARE A FIXED BIN(15);                                             1071
   819     3            DECLARE I FIXED BIN(15);                                             1072
   820     3            DECLARE MACRO_LN CHAR(160) VARYING;                                  1073
   821     3            DECLARE LN_PIC   PIC '99';                                           1074
   822     3            DECLARE FLD_DEF  CHAR(160) VARYING;                                  1075
   823     3            DECLARE FLD_NAME CHAR(160) VARYING;                                  1076
   824     3            A = FLD(F).FLD_ATTR;                                                 1077
                      /*****                                                                 1078
                        PUT SKIP DATA(FLD(F));                                               1078
                        PUT SKIP DATA(ATTR_TBL(A));                                          1078
                      *****/                                                                 1078
                                                                                             1081
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     90


   STMT LEVEL NEST

   825     3            FLD_DEF=SUBSTR(FLD(F).FLD_DATA,2);                                   1082
   826     3            I = LENGTH(FLD_DEF);                                                 1083
   827     3            DO WHILE(SUBSTR(FLD_DEF,I,1)=' ' & I>0);                             1084
   828     3    1          I=I-1;                                                            1085
   829     3    1       END;                                                                 1086
   830     3            IF I=0 THEN FLD_DEF='';                                              1087
   832     3            ELSE FLD_DEF=SUBSTR(FLD_DEF,1,I);                                    1088
                        /* MAKE SURE THAT FIELDS DON'T GO PAST COL 80 */                     1089
   833     3            IF LENGTH(FLD_DEF)+FLD(F).FLD_COL   > 80 THEN                        1090
   834     3            DO;                                                                  1091
   835     3    1          PUT SKIP EDIT('*** ERROR PROCESSING ROW ',FLD(F).FLD_ROW,         1092
                                         ' COL ',FLD(F).FLD_COL,': FIELD EXCEEDS COL 80')    1093
                                         (A,F(3),A,F(3),A);                                  1094
   836     3    1          RETURN;                                                           1095
   837     3    1       END;                                                                 1096
   838     3            FLD_NAME = FLD(F).FLD_INT_NAME;                                      1097
   839     3            LN_PIC = LENGTH(FLD_DEF);                                            1098
   840     3            IF LN_PIC ^= '00' & ^ATTR_TBL(A).TITLE THEN                          1099
   841     3            DO;                                                                  1100
   842     3    1          PUT FILE(ASM) EDIT                                                1101
                                   (FLD_NAME||'C','DC    C'' ''',FLD(F).FLD_NAME,SEQ_NO)     1102
                                               (A,COL(10),A,COL(40),A,COL(73),P'999999V99')  1103
                                   (FLD_NAME||'L','DC    AL2(',LN_PIC,')',SEQ_NO+1)          1104
                                                     (A,COL(10),A,A,A,COL(73),P'999999V99'); 1105
   843     3    1          SEQ_NO=SEQ_NO+2;                                                  1106
   844     3    1          MACRO_LN = SUBSTR(FLD_NAME||'D        ',1,9)                      1107
                                              ||  'DC    CL' || LN_PIC                       1108
                                                                || ''''||FLD_DEF||'''';      1109
   845     3    1          IF LENGTH(MACRO_LN)>71 THEN                                       1110
   846     3    1          DO;                                                               1111
   847     3    2             PUT FILE(ASM)                                                  1112
                                       EDIT(MACRO_LN,'*',SEQ_NO) (A(71),A,P'999999V99')      1113
                                         (SUBSTR(MACRO_LN,72),SEQ_NO+1)                      1114
                                            (COL(16),A(57),P'999999V99');                    1115
   848     3    2             SEQ_NO=SEQ_NO+2;                                               1116
   849     3    2          END;                                                              1117
   850     3    1          ELSE                                                              1118
   850     3    1          DO;                                                               1119
   851     3    2             PUT FILE(ASM)                                                  1120
                                       EDIT(MACRO_LN,SEQ_NO) (A(72),P'999999V99');           1121
   852     3    2             SEQ_NO=SEQ_NO+1;                                               1122
   853     3    2           END;                                                             1123
   854     3    1       END;                                                                 1124
   855     3            FLD_DEF='';                                                          1125
   856     3         END WRITE_PARM;                                                         1126
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     91


   STMT LEVEL NEST

   857     2         END WRITE_ASM;                                                          1127
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     92


   STMT LEVEL NEST

                     /*********************************************************************/ 1128
                     /*                                                                   */ 1129
                     /* WRITE_COB - GENERATE THE USER COMM AREA FOR COBOL                 */ 1130
                     /*                                                                   */ 1131
                     /*********************************************************************/ 1132
   858     1         WRITE_COB:PROC;                                                         1133
   859     2            DECLARE SEQ_NO      FIXED DEC(8,2)  INIT(9);                         1134
   860     2            PUT FILE(COB)                                                        1135
                                   EDIT(DT_TIME_STAMP) (COL(7),A)                            1136
                                       (1)                           (COL(73),P'999999V99')  1137
                                       ('01  ',PANEL_NAME,'-PARM.')  (COL(8),A,A,A)          1138
                                       (2)                           (COL(73),P'999999V99')  1139
                                       ('05  ',PANEL_NAME,'-NAME','PIC X(8) VALUE ''',       1140
                                               PANEL_NAME,'''.')                             1141
                                                              (COL(12),(3)A,COL(47),(3)A)    1142
                                       (3)                           (COL(73),P'999999V99')  1143
                                       ('05  FILLER','PIC S9(8) COMP VALUE ZERO.')           1144
                                                              (COL(12),A,COL(47),A)          1145
                                       (4)                           (COL(73),P'999999V99')  1146
                                       ('05  ',PANEL_NAME,'-RET','PIC S9(4) COMP.')          1147
                                                              (COL(12),A,A,A,COL(47),A)      1148
                                       (5)                           (COL(73),P'999999V99')  1149
                                       ('05  ',PANEL_NAME,'-AID','PIC X.')                   1150
                                                              (COL(12),A,A,A,COL(47),A)      1151
                                       (6)                           (COL(73),P'999999V99')  1152
                                       ('05  ',PANEL_NAME,'-SBA','PIC XX.')                  1153
                                                              (COL(12),A,A,A,COL(47),A)      1154
                                       (7)                           (COL(73),P'999999V99')  1155
                                       ('05  FILLER','PIC X.')                               1156
                                                              (COL(12),A,COL(47),A)          1157
                                       (8)                           (COL(73),P'999999V99'); 1158
   861     2            DO M = 1 TO FLD_CTR;                                                 1159
   862     2    1          CALL WRITE_PARM(M);                                               1160
   863     2    1       END;                                                                 1161
   864     2            PUT FILE(COB)                                                        1162
                                    EDIT('05','FILLER.')                                     1163
                                                      (COL(12),A,COL(16),A)                  1164
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1165
   865     2            SEQ_NO=SEQ_NO+1;                                                     1166
   866     2            PUT FILE(COB)                                                        1167
                                    EDIT('10','FILLER','PIC X(01) VALUE '' ''.')             1168
                                                      (COL(16),A,COL(20),A,COL(47),A)        1169
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1170
   867     2            SEQ_NO=SEQ_NO+1;                                                     1171
   868     2            PUT FILE(COB)                                                        1172
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     93


   STMT LEVEL NEST

                                    EDIT('10','FILLER','PIC S9(4) VALUE ZERO COMP.')         1173
                                                      (COL(16),A,COL(20),A,COL(47),A)        1174
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1175
   869     2            SEQ_NO=SEQ_NO+1;                                                     1176
   870     2         WRITE_PARM:PROC(F);                                                     1177
   871     3            DECLARE F FIXED BIN(15);                                             1178
   872     3            DECLARE A FIXED BIN(15);                                             1179
   873     3            DECLARE I FIXED BIN(15);                                             1180
   874     3            DECLARE T FIXED BIN(15);                                             1181
   875     3            DECLARE MACRO_LN CHAR(160) VARYING;                                  1182
   876     3            DECLARE LN_PIC   PIC '99';                                           1183
   877     3            DECLARE FLD_DEF  CHAR(99) VARYING;                                   1184
   878     3            DECLARE FLD_NAME CHAR(99) VARYING;                                   1185
   879     3            A = FLD(F).FLD_ATTR;                                                 1186
                      /*****                                                                 1187
                        PUT SKIP DATA(FLD(F));                                               1187
                        PUT SKIP DATA(ATTR_TBL(A));                                          1187
                      *****/                                                                 1187
                                                                                             1190
   880     3            FLD_DEF=SUBSTR(FLD(F).FLD_DATA,2);                                   1191
   881     3            I = LENGTH(FLD_DEF);                                                 1192
   882     3            DO WHILE(SUBSTR(FLD_DEF,I,1)=' ' & I>0);                             1193
   883     3    1          I=I-1;                                                            1194
   884     3    1       END;                                                                 1195
   885     3            IF I=0 THEN FLD_DEF='';                                              1196
   887     3            ELSE FLD_DEF=SUBSTR(FLD_DEF,1,I);                                    1197
                        /* MAKE SURE THAT FIELDS DON'T GO PAST COL 80 */                     1198
   888     3            IF LENGTH(FLD_DEF)+FLD(F).FLD_COL   > 80 THEN                        1199
   889     3            DO;                                                                  1200
   890     3    1          PUT SKIP EDIT('*** ERROR PROCESSING ROW ',FLD(F).FLD_ROW,         1201
                                         ' COL ',FLD(F).FLD_COL,': FIELD EXCEEDS COL 80')    1202
                                         (A,F(3),A,F(3),A);                                  1203
   891     3    1          RETURN;                                                           1204
   892     3    1       END;                                                                 1205
   893     3            FLD_NAME = FLD(F).FLD_NAME;                                          1206
   894     3            DO T=1 TO LENGTH(FLD_NAME);                                          1207
   895     3    1          IF SUBSTR(FLD_NAME,T,1)='_' THEN                                  1208
   896     3    1             SUBSTR(FLD_NAME,T,1)='-';                                      1209
   897     3    1       END;                                                                 1210
   898     3            LN_PIC = LENGTH(FLD_DEF);                                            1211
   899     3            IF LN_PIC ^= '00' & ^ATTR_TBL(A).TITLE THEN                          1212
   900     3            DO;                                                                  1213
   901     3    1          PUT FILE(COB)                                                     1214
                                    EDIT('05',FLD_NAME,'.')                                  1215
                                                      (COL(12),A,COL(16),A,A)                1216
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     94


   STMT LEVEL NEST

                                        (SEQ_NO)                   (COL(73),P'999999V99');   1217
   902     3    1          SEQ_NO=SEQ_NO+1;                                                  1218
   903     3    1          PUT FILE(COB)                                                     1219
                                    EDIT('10',FLD_NAME||'-C','PIC X(01) VALUE '' ''.')       1220
                                                      (COL(16),A,COL(20),A,COL(47),A)        1221
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1222
   904     3    1          SEQ_NO=SEQ_NO+1;                                                  1223
   905     3    1          PUT FILE(COB)                                                     1224
                                    EDIT('10',FLD_NAME||'-L','PIC S9(4) VALUE ',             1225
                                                                LENGTH(FLD_DEF),' COMP.')    1226
                                                 (COL(16),A,COL(20),A,COL(47),A,P'SS9',A)    1227
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1228
   906     3    1          SEQ_NO=SEQ_NO+1;                                                  1229
   907     3    1          PUT FILE(COB)                                                     1230
                                    EDIT('10',FLD_NAME||'-D','PIC X(',LN_PIC,')')            1231
                                        (COL(16),A,COL(20),A,COL(47),A,A,A);                 1232
   908     3    1          IF LENGTH(FLD_DEF) <= 6  THEN                                     1233
   909     3    1          DO;                                                               1234
   910     3    2              PUT FILE(COB) EDIT(' VALUE ''',FLD_DEF,'''.') (A,A,A)         1235
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1236
   911     3    2              SEQ_NO=SEQ_NO+1;                                              1237
   912     3    2          END;                                                              1238
   913     3    1          ELSE                                                              1239
   913     3    1          DO;                                                               1240
   914     3    2              PUT FILE(COB) EDIT(' VALUE',SEQ_NO) (A,COL(73),P'999999V99'); 1241
   915     3    2              SEQ_NO=SEQ_NO+1;                                              1242
   916     3    2              MACRO_LN = '''' || FLD_DEF || '''.';                          1243
   917     3    2              IF LENGTH(MACRO_LN)>56 THEN                                   1244
   918     3    2              DO;                                                           1245
   919     3    3                 PUT FILE(COB)                                              1246
                                           EDIT(MACRO_LN) (COL(16),A(57))                    1247
                                            (SEQ_NO) (P'999999V99')                          1248
                                             ('-','''',SUBSTR(MACRO_LN,58))                  1249
                                                      (COL(7),A,COL(16),A,A)                 1250
                                            (SEQ_NO+1) (COL(73),P'999999V99');               1251
   920     3    3                 SEQ_NO=SEQ_NO+2;                                           1252
   921     3    3              END;                                                          1253
   922     3    2              ELSE                                                          1254
   922     3    2              DO;                                                           1255
   923     3    3                 PUT FILE(COB)                                              1256
                                      EDIT(MACRO_LN,SEQ_NO) (COL(16),A(57),P'999999V99');    1257
   924     3    3                 SEQ_NO=SEQ_NO+1;                                           1258
   925     3    3              END;                                                          1259
   926     3    2          END;                                                              1260
   927     3    1       FLD_DEF='';                                                          1261
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     95


   STMT LEVEL NEST

   928     3    1    END WRITE_PARM;                                                         1262
   930     2         END WRITE_COB;                                                          1263
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     96


   STMT LEVEL NEST

                     /*********************************************************************/ 1264
                     /*                                                                   */ 1265
                     /* WRITE_PL1 - GENERATE THE USER COMM AREA FOR PL1                   */ 1266
                     /*                                                                   */ 1267
                     /*********************************************************************/ 1268
   931     1         WRITE_PL1:PROC;                                                         1269
   932     2            DECLARE SEQ_NO      FIXED DEC(8,2)  INIT(9);                         1270
   933     2            PUT FILE(PL1)                                                        1271
                                   EDIT('/* ',DT_TIME_STAMP, ' ** */') (COL(2),A,A,A)        1272
                                       (1)                           (COL(73),P'999999V99')  1273
                                       ('DCL 1 ',PANEL_NAME,'_PARM  UNALIGNED,')             1274
                                                                       (COL(6),A,A,A)        1275
                                       (2)                           (COL(73),P'999999V99')  1276
                                       ('5 ',PANEL_NAME,'_NAME','CHAR(8) INIT(''',           1277
                                               PANEL_NAME,'''),')                            1278
                                                              (COL(12),(3)A,COL(47),(3)A)    1279
                                       (3)                           (COL(73),P'999999V99')  1280
                                       ('5 FILLER1','FIXED BIN(31) INIT(0),')                1281
                                                              (COL(12),A,COL(47),A)          1282
                                       (4)                           (COL(73),P'999999V99')  1283
                                       ('5 ',PANEL_NAME,'_RET','FIXED BIN(15) INIT(0),')     1284
                                                              (COL(12),A,A,A,COL(47),A)      1285
                                       (5)                           (COL(73),P'999999V99')  1286
                                       ('5 ',PANEL_NAME,'_AID','CHAR(1) INIT('' ''),')       1287
                                                              (COL(12),A,A,A,COL(47),A)      1288
                                       (6)                           (COL(73),P'999999V99')  1289
                                       ('5 ',PANEL_NAME,'_SBA','FIXED BIN(15) INIT(0),')     1290
                                                              (COL(12),A,A,A,COL(47),A)      1291
                                       (7)                           (COL(73),P'999999V99')  1292
                                       ('5 FILLER2','CHAR(1),')                              1293
                                                              (COL(12),A,COL(47),A)          1294
                                       (8)                           (COL(73),P'999999V99'); 1295
   934     2            DO M = 1 TO FLD_CTR;                                                 1296
   935     2    1          CALL WRITE_PARM(M);                                               1297
   936     2    1       END;                                                                 1298
   937     2            PUT FILE(PL1)                                                        1299
                                    EDIT('5 E_O_T_1,')                                       1300
                                                               (COL(12),A)                   1301
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1302
   938     2            SEQ_NO=SEQ_NO+1;                                                     1303
   939     2            PUT FILE(PL1)                                                        1304
                                    EDIT('10 E_O_T_2','CHAR(1) INIT('' ''),')                1305
                                                      (COL(16),A,COL(47),A)                  1306
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1307
   940     2            SEQ_NO=SEQ_NO+1;                                                     1308
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     97


   STMT LEVEL NEST

   941     2            PUT FILE(PL1)                                                        1309
                                    EDIT('10 E_O_T_3','FIXED BIN(15) INIT(0);')              1310
                                                      (COL(16),A,COL(47),A)                  1311
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1312
   942     2            SEQ_NO=SEQ_NO+1;                                                     1313
   943     2         WRITE_PARM:PROC(F);                                                     1314
   944     3            DECLARE F FIXED BIN(15);                                             1315
   945     3            DECLARE A FIXED BIN(15);                                             1316
   946     3            DECLARE I FIXED BIN(15);                                             1317
   947     3            DECLARE T FIXED BIN(15);                                             1318
   948     3            DECLARE MACRO_LN CHAR(160) VARYING;                                  1319
   949     3            DECLARE LN_PIC   PIC '99';                                           1320
   950     3            DECLARE FLD_DEF  CHAR(99) VARYING;                                   1321
   951     3            DECLARE FLD_NAME CHAR(99) VARYING;                                   1322
   952     3            A = FLD(F).FLD_ATTR;                                                 1323
                      /*****                                                                 1324
                        PUT SKIP DATA(FLD(F));                                               1324
                        PUT SKIP DATA(ATTR_TBL(A));                                          1324
                      *****/                                                                 1324
                                                                                             1327
   953     3            FLD_DEF=SUBSTR(FLD(F).FLD_DATA,2);                                   1328
   954     3            I = LENGTH(FLD_DEF);                                                 1329
   955     3            DO WHILE(SUBSTR(FLD_DEF,I,1)=' ' & I>0);                             1330
   956     3    1          I=I-1;                                                            1331
   957     3    1       END;                                                                 1332
   958     3            IF I=0 THEN FLD_DEF='';                                              1333
   960     3            ELSE FLD_DEF=SUBSTR(FLD_DEF,1,I);                                    1334
                        /* MAKE SURE THAT FIELDS DON'T GO PAST COL 80 */                     1335
   961     3            IF LENGTH(FLD_DEF)+FLD(F).FLD_COL   > 80 THEN                        1336
   962     3            DO;                                                                  1337
   963     3    1          PUT SKIP EDIT('*** ERROR PROCESSING ROW ',FLD(F).FLD_ROW,         1338
                                         ' COL ',FLD(F).FLD_COL,': FIELD EXCEEDS COL 80')    1339
                                         (A,F(3),A,F(3),A);                                  1340
   964     3    1          RETURN;                                                           1341
   965     3    1       END;                                                                 1342
   966     3            FLD_NAME = FLD(F).FLD_NAME;                                          1343
   967     3            DO T=1 TO LENGTH(FLD_NAME);                                          1344
   968     3    1          IF SUBSTR(FLD_NAME,T,1)='-' THEN                                  1345
   969     3    1             SUBSTR(FLD_NAME,T,1)='_';                                      1346
   970     3    1       END;                                                                 1347
   971     3            LN_PIC = LENGTH(FLD_DEF);                                            1348
   972     3            IF LN_PIC ^= '00' & ^ATTR_TBL(A).TITLE THEN                          1349
   973     3            DO;                                                                  1350
   974     3    1          PUT FILE(PL1)                                                     1351
                                    EDIT('5 ',FLD_NAME,',')                                  1352
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     98


   STMT LEVEL NEST

                                                      (COL(12),A,A,A)                        1353
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1354
   975     3    1          SEQ_NO=SEQ_NO+1;                                                  1355
   976     3    1          PUT FILE(PL1)                                                     1356
                                    EDIT('10 ',FLD_NAME||'_C','CHAR(1) INIT('' ''),')        1357
                                                      (COL(16),A,A,COL(47),A)                1358
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1359
   977     3    1          SEQ_NO=SEQ_NO+1;                                                  1360
   978     3    1          PUT FILE(PL1)                                                     1361
                                    EDIT('10 ',FLD_NAME||'_L','FIXED BIN(15) INIT(',         1362
                                                                LENGTH(FLD_DEF),'),')        1363
                                                 (COL(16),A,A,COL(47),A,P'Z9',A)             1364
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1365
   979     3    1          SEQ_NO=SEQ_NO+1;                                                  1366
   980     3    1          PUT FILE(PL1)                                                     1367
                                    EDIT('10 ',FLD_NAME||'_D','CHAR(',LN_PIC,')')            1368
                                        (COL(16),A,A,COL(47),A,A,A);                         1369
   981     3    1          IF LENGTH(FLD_DEF) <= 6  THEN                                     1370
   982     3    1          DO;                                                               1371
   983     3    2              PUT FILE(PL1) EDIT(' INIT(''',FLD_DEF,'''),') (A,A,A)         1372
                                        (SEQ_NO)                   (COL(73),P'999999V99');   1373
   984     3    2              SEQ_NO=SEQ_NO+1;                                              1374
   985     3    2          END;                                                              1375
   986     3    1          ELSE                                                              1376
   986     3    1          DO;                                                               1377
   987     3    2              PUT FILE(PL1) EDIT(' INIT(',SEQ_NO) (A,COL(73),P'999999V99'); 1378
   988     3    2              SEQ_NO=SEQ_NO+1;                                              1379
   989     3    2              MACRO_LN = '''' || FLD_DEF || '''),';                         1380
   990     3    2              IF LENGTH(MACRO_LN)>56 THEN                                   1381
   991     3    2              DO;                                                           1382
   992     3    3                 PUT FILE(PL1)                                              1383
                                           EDIT(MACRO_LN) (COL(16),A(57))                    1384
                                            (SEQ_NO) (P'999999V99')                          1385
                                             (SUBSTR(MACRO_LN,58))                           1386
                                                      (COL(2),A)                             1387
                                            (SEQ_NO+1) (COL(73),P'999999V99');               1388
   993     3    3                 SEQ_NO=SEQ_NO+2;                                           1389
   994     3    3              END;                                                          1390
   995     3    2              ELSE                                                          1391
   995     3    2              DO;                                                           1392
   996     3    3                 PUT FILE(PL1)                                              1393
                                      EDIT(MACRO_LN,SEQ_NO) (COL(16),A(57),P'999999V99');    1394
   997     3    3                 SEQ_NO=SEQ_NO+1;                                           1395
   998     3    3              END;                                                          1396
   999     3    2          END;                                                              1397
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE     99


   STMT LEVEL NEST

  1000     3    1       FLD_DEF='';                                                          1398
  1001     3    1    END WRITE_PARM;                                                         1399
  1003     2         END WRITE_PL1;                                                          1400
  1004     1         END MAPGEN;                                                             1401
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    100


   STMT LEVEL NEST

                     /********************************************************************** 1402
                     **                                                                   ** 1402
                     ** MAP3270 V2.2.0 - SOFTWARE PACKAGE TO IMPLEMENT FULL SCREEN        ** 1402
                     ** IO FOR IBM 3270 CLASS TERMINALS.                                  ** 1402
                     **                                                                   ** 1402
                     **             COPYRIGHT (C) 2021  EDWARD G LISS                     ** 1402
                     **                     EGLISS4024@GMAIL.COM                          ** 1402
                     **                                                                   ** 1402
                     ** THIS PROGRAM IS FREE SOFTWARE: YOU CAN REDISTRIBUTE IT            ** 1402
                     ** AND/OR MODIFY IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC        ** 1402
                     ** LICENSE AS PUBLISHED BY THE FREE SOFTWARE FOUNDATION,             ** 1402
                     ** EITHER VERSION 3 OF THE LICENSE, OR ANY LATER VERSION.            ** 1402
                     **                                                                   ** 1402
                     ** THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE           ** 1402
                     ** USEFUL, BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED        ** 1402
                     ** WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR           ** 1402
                     ** PURPOSE.  SEE THE GNU GENERAL PUBLIC LICENSE FOR MORE             ** 1402
                     ** DETAILS.                                                          ** 1402
                     **                                                                   ** 1402
                     ** PLEASE SEE HTTPS://WWW.GNU.ORG/LICENSES/ FOR A COPY OF THE        ** 1402
                     ** GNU GENERAL PUBLIC LICENSE.                                       ** 1402
                     **                                                                   ** 1402
                     **********************************************************************/ 1402
                                                                                             1424
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    101


                                                    ATTRIBUTE AND CROSS-REFERENCE TABLE


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES


945   ********* A                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    952,972

872   ********* A                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    879,899

818   ********* A                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    824,840

788   ********* A                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    792,801

691   ********* A                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    696,714

20    ********* A                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    47,95,271,271,272,273,279,282,284,286,287,288,289,290,568

4               ASM                                 FILE,EXTERNAL,STREAM,OUTPUT
                                                    810,814,842,847,851

294             AT                                  PARAMETER,UNALIGNED,STRING(*),CHARACTER,VARYING
                                                    293,297,302,307,312,317,322,327,332,337,342,347,352,357,362,367,372
                                                    377,382,387,392,397,402,407,412,417,422,427,432,437,443

605             ATTR                                PARAMETER,STRUCTURE
                                                    604

294             ATTR                                PARAMETER,STRUCTURE
                                                    293

605             ATTR_A                              IN ATTR,PARAMETER,UNALIGNED,STRING(80),CHARACTER,VARYING

294             ATTR_A                              IN ATTR,PARAMETER,UNALIGNED,STRING(80),CHARACTER,VARYING

13              ATTR_A                              IN ATTR_REC,AUTOMATIC,UNALIGNED,STRING(80),CHARACTER,VARYING

14              ATTR_A                              IN ATTR_TBL(9),AUTOMATIC,UNALIGNED,STRING(80),CHARACTER,VARYING
                                                    96,244,272

15              ATTR_A                              IN FLD_REC IN FLD(500),AUTOMATIC,UNALIGNED,STRING(80),CHARACTER,
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    102


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES

                                                    VARYING
                                                    230,546,546

605             ATTR_CHR                            IN ATTR,PARAMETER,UNALIGNED,STRING(1),CHARACTER

294             ATTR_CHR                            IN ATTR,PARAMETER,UNALIGNED,STRING(1),CHARACTER

13              ATTR_CHR                            IN ATTR_REC,AUTOMATIC,UNALIGNED,STRING(1),CHARACTER

14              ATTR_CHR                            IN ATTR_TBL(9),AUTOMATIC,UNALIGNED,STRING(1),CHARACTER
                                                    96,243,273,569

15              ATTR_CHR                            IN FLD_REC IN FLD(500),AUTOMATIC,UNALIGNED,STRING(1),CHARACTER
                                                    229

13              ATTR_REC                            AUTOMATIC,STRUCTURE

14              ATTR_TBL                            (9)AUTOMATIC,STRUCTURE
                                                    98,279,282,602

263             ATTRIB                              AUTOMATIC,UNALIGNED,STRING(1),CHARACTER

                ATTRLIST                            AUTOMATIC,ALIGNED,DECIMAL,FLOAT(SINGLE)
                                                    48

20    ********* B                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    53,90,562,562,563

453   ********* BLANK                               AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    462,466,468,471,476,481,483,540,543,544,545

605             BRIGHT                              IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    614

294             BRIGHT                              IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    304,309

13              BRIGHT                              IN ATTR_REC,AUTOMATIC,ALIGNED,STRING(1),BIT

14              BRIGHT                              IN ATTR_TBL(9),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    247

15              BRIGHT                              IN FLD_REC IN FLD(500),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    233,724
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    103


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES

685   ********* C                                   PARAMETER,ALIGNED,BINARY,FIXED(15,0)
                                                    684,686

593             C                                   AUTOMATIC,UNALIGNED,DECIMAL,PICTURE(99)
                                                    597,598

559   ********* C                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    566,567,577

293             CHECK_ATTR                          ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    279,282,552,555

4               COB                                 FILE,EXTERNAL,STREAM,OUTPUT
                                                    860,864,866,868,901,903,905,907,910,914,919,923

20    ********* COL                                 AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    57,564,577,597,600

605             COLOR                               IN ATTR,PARAMETER,UNALIGNED,STRING(3),CHARACTER
                                                    654

294             COLOR                               IN ATTR,PARAMETER,UNALIGNED,STRING(3),CHARACTER
                                                    364,369,374,379,384,389,394,399,404,409,414,419,424,429,434,439

13              COLOR                               IN ATTR_REC,AUTOMATIC,UNALIGNED,STRING(3),CHARACTER

14              COLOR                               IN ATTR_TBL(9),AUTOMATIC,UNALIGNED,STRING(3),CHARACTER
                                                    252

15              COLOR                               IN FLD_REC IN FLD(500),AUTOMATIC,UNALIGNED,STRING(3),CHARACTER
                                                    238,733,747,749,750

453   ********* COMMA                               AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    461,466,471,473,476,478,481,540,540

605             CUR                                 IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    650

294             CUR                                 IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    334

13              CUR                                 IN ATTR_REC,AUTOMATIC,ALIGNED,STRING(1),BIT

14              CUR                                 IN ATTR_TBL(9),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    250,290,669
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    104


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES


15              CUR                                 IN FLD_REC IN FLD(500),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    236

                DATE                                BUILT-IN FUNCTION
                                                    24

23              DT_TIME_STAMP                       AUTOMATIC,UNALIGNED,STRING(60),CHARACTER,VARYING
                                                    24,662,784,810,814,860,933

214             ENDSELECT_MACRO1                    STATEMENT LABEL CONSTANT
                                                    163,169,175,181,187,193,199

448             ENDSELECT_MACRO2                    STATEMENT LABEL CONSTANT
                                                    300,305,310,315,320,325,330,335,340,345,350,355,360,365,370,375,380
                                                    385,390,395,400,405,410,415,420,425,430,435

493             ENDSELECT_MACRO3                    STATEMENT LABEL CONSTANT
                                                    469,474,479

649             ENDSELECT_MACRO4                    STATEMENT LABEL CONSTANT
                                                    621,626,631,636

12              ERROR_FOUND                         AUTOMATIC,ALIGNED,INITIAL,STRING(1),BIT
                                                    114,137,209,444,458,488,497,504,510,525,537,645

2               EXEC_PARM                           PARAMETER,UNALIGNED,STRING(100),CHARACTER,VARYING
                                                    1,144,149,150,156

944   ********* F                                   PARAMETER,ALIGNED,BINARY,FIXED(15,0)
                                                    943,952,953,961,963,963,966

871   ********* F                                   PARAMETER,ALIGNED,BINARY,FIXED(15,0)
                                                    870,879,880,888,890,890,893

817   ********* F                                   PARAMETER,ALIGNED,BINARY,FIXED(15,0)
                                                    816,824,825,833,835,835,838,842

787   ********* F                                   PARAMETER,ALIGNED,BINARY,FIXED(15,0)
                                                    786,792,793,803,803,803,803

690   ********* F                                   PARAMETER,ALIGNED,BINARY,FIXED(15,0)
                                                    689,696,697,705,707,707,710,711,711,718,721,724,727,730,730,733,733
                                                    739,741,743,745,747,747,749,750
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    105


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES

18              FALSE                               STATIC,ALIGNED,INITIAL,STRING(1),BIT
                                                    38,102,185,191,197,203,231,232,233,234,235,236,245,246,247,248,249
                                                    250,288,289,290,309,319,329,514,515,571,666

15              FLD                                 (500)AUTOMATIC,STRUCTURE

21    ********* FLD_A                               AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    55,565,574,578,587

15    ********* FLD_ATTR                            IN FLD(500),AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    225,601,669,696,792,824,879,952

15    ********* FLD_COL                             IN FLD(500),AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    120,224,600,671,705,707,711,730,803,833,835,888,890,961,963

21    ********* FLD_CTR                             AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    103,118,222,517,594,594,595,598,598,599,600,601,602,667,679,779,811
                                                    861,934

15              FLD_DATA                            IN FLD(500),AUTOMATIC,UNALIGNED,STRING(80),CHARACTER,VARYING
                                                    226,595,697,793,825,880,953

950             FLD_DEF                             AUTOMATIC,UNALIGNED,STRING(99),CHARACTER,VARYING
                                                    953,954,955,959,960,960,961,971,978,981,983,989,1000

877             FLD_DEF                             AUTOMATIC,UNALIGNED,STRING(99),CHARACTER,VARYING
                                                    880,881,882,886,887,887,888,898,905,908,910,916,927

822             FLD_DEF                             AUTOMATIC,UNALIGNED,STRING(160),CHARACTER,VARYING
                                                    825,826,827,831,832,832,833,839,844,855

790             FLD_DEF                             AUTOMATIC,UNALIGNED,STRING(160),CHARACTER,VARYING
                                                    793,794,795,799,800,800,803

19              FLD_DEF                             AUTOMATIC,UNALIGNED,STRING(80),CHARACTER,VARYING
                                                    54,75,78,572,575,582,582,585,588,595,697,698,699,703,704,704,705,713
                                                    730,761,772

15              FLD_INT_NAME                        IN FLD(500),AUTOMATIC,UNALIGNED,STRING(6),CHARACTER
                                                    228,519,598,710,803,838

951             FLD_NAME                            AUTOMATIC,UNALIGNED,STRING(99),CHARACTER,VARYING
                                                    966,967,968,969,974,976,978,980

878             FLD_NAME                            AUTOMATIC,UNALIGNED,STRING(99),CHARACTER,VARYING
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    106


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES

                                                    893,894,895,896,901,903,905,907

823             FLD_NAME                            AUTOMATIC,UNALIGNED,STRING(160),CHARACTER,VARYING
                                                    838,842,842,844

791             FLD_NAME                            AUTOMATIC,UNALIGNED,STRING(8),CHARACTER,VARYING

695             FLD_NAME                            AUTOMATIC,UNALIGNED,STRING(8),CHARACTER,VARYING
                                                    710,717

15              FLD_NAME                            IN FLD(500),AUTOMATIC,UNALIGNED,STRING(28),CHARACTER,VARYING
                                                    104,107,120,227,598,718,803,842,893,966

454   ********* FLD_NAME_PTR                        AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    516,517,518,518,519,546,546,552,555

15              FLD_REC                             IN FLD(500),AUTOMATIC,STRUCTURE
                                                    121,552,555,602

15    ********* FLD_ROW                             IN FLD(500),AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    120,223,599,671,707,711,803,835,890,963

3               GEN_ASM                             AUTOMATIC,ALIGNED,INITIAL,STRING(1),BIT
                                                    131,161,185

3               GEN_COB                             AUTOMATIC,ALIGNED,INITIAL,STRING(1),BIT
                                                    133,167,191

3               GEN_MAP                             AUTOMATIC,ALIGNED,INITIAL,STRING(1),BIT
                                                    124,179,203

3               GEN_PLI                             AUTOMATIC,ALIGNED,INITIAL,STRING(1),BIT
                                                    135,173,197

605             HI_LIGHT                            IN ATTR,PARAMETER,UNALIGNED,STRING(1),CHARACTER
                                                    618,623,628,633,638

294             HI_LIGHT                            IN ATTR,PARAMETER,UNALIGNED,STRING(1),CHARACTER
                                                    344,349,354,359

13              HI_LIGHT                            IN ATTR_REC,AUTOMATIC,UNALIGNED,STRING(1),CHARACTER

14              HI_LIGHT                            IN ATTR_TBL(9),AUTOMATIC,UNALIGNED,STRING(1),CHARACTER
                                                    251
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    107


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES

15              HI_LIGHT                            IN FLD_REC IN FLD(500),AUTOMATIC,UNALIGNED,STRING(1),CHARACTER
                                                    237,733,739,741,743,745,747

946   ********* I                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    954,955,955,956,956,958,960

873   ********* I                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    881,882,882,883,883,885,887

819   ********* I                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    826,827,827,828,828,830,832

692   ********* I                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    698,699,699,700,700,702,704

592   ********* I                                   PARAMETER,ALIGNED,BINARY,FIXED(15,0)
                                                    591,601,602

559   ********* I                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    568,569,578

453   ********* I                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    500,501,503,507,531,532,534,547,548,549,550,552,553

265   ********* I                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    266,267,267,268,268,270,274,275,276,277,279,280

64    ********* I                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    66,67,68

      ********* I                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    90,91,91,95,96,96,98,101,104,107,113,118,120,120,120,121,794,795,795
                                                    796,796,798,800

658             IC_WRITTEN                          AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    666,672,677

12    ********* IHESARC                             EXTERNAL,ENTRY,BINARY,FIXED(15,0)
                                                    140

                INDEX                               GENERIC,BUILT-IN FUNCTION
                                                    66,276,461,462,531,543,549

221   ********* INITIALIZE                          ENTRY,BINARY,FIXED(15,0)
                                                    26
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    108


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES


      ********* J                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    103,104,107

559             K                                   AUTOMATIC,UNALIGNED,STRING(1),CHARACTER
                                                    567,569,582

23              LBL                                 AUTOMATIC,UNALIGNED,STRING(7),CHARACTER,VARYING

                LENGTH                              GENERIC,BUILT-IN FUNCTION
                                                    144,150,157,215,585,698,705,713,730,762,794,803,826,833,839,845,881
                                                    888,894,898,905,908,917,954,961,967,971,978,981,990

949             LN_PIC                              AUTOMATIC,UNALIGNED,DECIMAL,PICTURE(99)
                                                    971,972,980

876             LN_PIC                              AUTOMATIC,UNALIGNED,DECIMAL,PICTURE(99)
                                                    898,899,907

821             LN_PIC                              AUTOMATIC,UNALIGNED,DECIMAL,PICTURE(99)
                                                    839,840,842,844

694             LN_PIC                              AUTOMATIC,UNALIGNED,DECIMAL,PICTURE(99)
                                                    713,714,717,752

776   ********* M                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    779,780

657   ********* M                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    667,668,669,671,671,673,675,675,679,680

21    ********* M                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    811,812,861,862,934,935

948             MACRO_LN                            AUTOMATIC,UNALIGNED,STRING(160),CHARACTER,VARYING
                                                    989,990,992,992,996

875             MACRO_LN                            AUTOMATIC,UNALIGNED,STRING(160),CHARACTER,VARYING
                                                    916,917,919,919,923

820             MACRO_LN                            AUTOMATIC,UNALIGNED,STRING(160),CHARACTER,VARYING
                                                    844,845,847,847,851

789             MACRO_LN                            AUTOMATIC,UNALIGNED,STRING(160),CHARACTER,VARYING
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    109


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES

693             MACRO_LN                            AUTOMATIC,UNALIGNED,STRING(160),CHARACTER,VARYING
                                                    715,717,722,722,723,723,725,725,726,726,728,728,729,729,731,731,732
                                                    732,735,735,736,738,740,740,742,742,744,744,746,746,748,748,750,750
                                                    754,758,758,759,761,762,764,764,768

1     ********* MAPGEN                              ENTRY,BINARY,FIXED(15,0)

451             MATCH_INI_NAME                      AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    514,517,519,521

451             MATCH_NAME                          AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    515

9               MY_REC                              AUTOMATIC,UNALIGNED,STRING(80),CHARACTER
                                                    40,43,44,50,60,62,65,70,73,267,270,273,455,461,462,501,507,509,519
                                                    524,529,530,542,563,567

143   ********* NEXT_CHAR                           AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    162,168,174,180,186,192,198,204,215,217,218

453   ********* NLEN                                AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    468,473,478,483,494,507,509,530,542

7               NO_ATTRIB                           AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    58,560,571

6               NOT_E_O_F                           AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    38,39,41

453   ********* NST                                 AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    463,468,473,478,483,507,509,530,542

605             NUM                                 IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    608

294             NUM                                 IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    314,319

13              NUM                                 IN ATTR_REC,AUTOMATIC,ALIGNED,STRING(1),BIT

14              NUM                                 IN ATTR_TBL(9),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    246,288

15              NUM                                 IN FLD_REC IN FLD(500),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    232,727
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    110


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES


18    ********* ONE                                 STATIC,ALIGNED,INITIAL,BINARY,FIXED(15,0)
                                                    77,678,678

23              PAGE_NO                             AUTOMATIC,ALIGNED,INITIAL,DECIMAL,FIXED(3,0)
                                                    29,29,30,31,82,82,83

17              PAGE_TITLE                          STATIC,UNALIGNED,INITIAL,STRING(45),CHARACTER
                                                    30,83

                PANE_SEQ                            AUTOMATIC,ALIGNED,DECIMAL,FLOAT(SINGLE)
                                                    661

4               PANEL                               FILE,EXTERNAL,STREAM,OUTPUT
                                                    128,659,660,662,664,682,686,711,718,736,754,759,764,768,777,782,784
                                                    803

8               PANEL_NAME                          AUTOMATIC,UNALIGNED,INITIAL,STRING(7),CHARACTER,VARYING
                                                    65,66,68,68,83,660,662,662,662,662,664,686,777,810,860,860,860,860
                                                    860,860,933,933,933,933,933,933

5               PANEL_SEQ                           AUTOMATIC,ALIGNED,INITIAL,DECIMAL,FIXED(9,2)
                                                    128,129,129,660,661,662,662,662,662,662,663,663,664,664,665,665,682
                                                    683,683,686,686,687,687,711,712,712,718,719,719,736,737,737,754,755
                                                    755,759,760,760,764,764,765,765,768,769,769,777,778,778,782,783,783
                                                    784,785,785,803,804,804

17              PGM_VER                             STATIC,UNALIGNED,INITIAL,STRING(8),CHARACTER
                                                    24,30,83

4               PL1                                 FILE,EXTERNAL,STREAM,OUTPUT
                                                    933,937,939,941,974,976,978,980,983,987,992,996

604             PRINT_ATTR                          ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    98,121

262             PROCESS_ATTRIBUTE                   ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    256

254             PROCESS_MYREC                       ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    72

141             PROCESS_PARM                        ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    32
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    111


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES

558             PROCESS_SCREEN                      ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    258

10              PROCESS_STATUS                      AUTOMATIC,UNALIGNED,STRING(7),CHARACTER
                                                    36,46,52,61,255,257,259

450             PROCESS_VARS                        ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    260

605             PROT                                IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    611

294             PROT                                IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    324,329

13              PROT                                IN ATTR_REC,AUTOMATIC,ALIGNED,STRING(1),BIT

14              PROT                                IN ATTR_TBL(9),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    245,287

15              PROT                                IN FLD_REC IN FLD(500),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    231,721

685   ********* R                                   PARAMETER,ALIGNED,BINARY,FIXED(15,0)
                                                    684,686

593             R                                   AUTOMATIC,UNALIGNED,DECIMAL,PICTURE(99)
                                                    596,598

20    ********* REC_CTR                             AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    42,42,43,242

12              RETURN_CODE                         AUTOMATIC,ALIGNED,INITIAL,BINARY,FIXED(31,0)
                                                    138,139,140

20    ********* ROW                                 AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    56,561,561,596,599

591             SAVE_FIELD                          ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    77,574,587

11              SCR_IMG                             (26)AUTOMATIC,UNALIGNED,STRING(82),CHARACTER
                                                    91,563

932             SEQ_NO                              AUTOMATIC,ALIGNED,INITIAL,DECIMAL,FIXED(8,2)
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    112


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES

                                                    937,938,938,939,940,940,941,942,942,974,975,975,976,977,977,978,979
                                                    979,983,984,984,987,988,988,992,992,993,993,996,997,997

859             SEQ_NO                              AUTOMATIC,ALIGNED,INITIAL,DECIMAL,FIXED(8,2)
                                                    864,865,865,866,867,867,868,869,869,901,902,902,903,904,904,905,906
                                                    906,910,911,911,914,915,915,919,919,920,920,923,924,924

809             SEQ_NO                              AUTOMATIC,ALIGNED,INITIAL,DECIMAL,FIXED(8,2)
                                                    814,814,814,815,815,842,842,843,843,847,847,848,848,851,852,852

605             STOP_BIT                            IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    652

294             STOP_BIT                            IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    339

13              STOP_BIT                            IN ATTR_REC,AUTOMATIC,ALIGNED,STRING(1),BIT

14              STOP_BIT                            IN ATTR_TBL(9),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    249,289

15              STOP_BIT                            IN FLD_REC IN FLD(500),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    235,730

                SUBSTR                              GENERIC,BUILT-IN FUNCTION
                                                    44,50,60,62,65,68,70,159,165,171,177,183,189,195,201,217,218,267,270
                                                    273,279,280,455,501,507,509,519,524,529,530,542,545,552,553,567,697
                                                    699,704,710,764,793,795,800,825,827,832,844,847,880,882,887,895,896
                                                    919,953,955,960,968,969,992

                SYSIN                               FILE,EXTERNAL
                                                    37,40,73

                SYSPRINT                            FILE,EXTERNAL
                                                    27,30,33,35,43,80,83,84,86,87,88,89,91,93,94,96,97,113,117,120,139
                                                    146,149,152,153,208,443,457,487,496,503,509,524,536,607,609,610,612
                                                    613,615,616,625,630,635,640,644,651,653,654,707,835,890,963

947   ********* T                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    967,968,969

874   ********* T                                   AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    894,895,896

452             TEMP                                AUTOMATIC,UNALIGNED,STRING(78),CHARACTER,VARYING
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    113


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES

                                                    542,543,545,545,549,552,553,553,555

264             TEMP                                AUTOMATIC,UNALIGNED,STRING(78),CHARACTER,VARYING
                                                    270,276,279,280,280,282

452             TEMP2                               AUTOMATIC,UNALIGNED,STRING(78),CHARACTER,VARYING
                                                    542,545,546

264             TEMP2                               AUTOMATIC,UNALIGNED,STRING(78),CHARACTER,VARYING
                                                    270,272

                TIME                                BUILT-IN FUNCTION
                                                    24

605             TITLE                               IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    606

294             TITLE                               IN ATTR,PARAMETER,ALIGNED,STRING(1),BIT
                                                    299

13              TITLE                               IN ATTR_REC,AUTOMATIC,ALIGNED,STRING(1),BIT

14              TITLE                               IN ATTR_TBL(9),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    248,284,286,714,801,840,899,972

15              TITLE                               IN FLD_REC IN FLD(500),AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    234

23              TITLE_STAMP                         AUTOMATIC,UNALIGNED,STRING(50),CHARACTER,VARYING
                                                    25,660

18              TRUE                                STATIC,ALIGNED,INITIAL,STRING(1),BIT
                                                    39,58,106,114,161,167,173,179,209,286,287,299,304,314,324,334,339
                                                    444,458,488,497,504,510,525,537,560,645,672

16              VAR                                 (500)AUTOMATIC,STRUCTURE

22    ********* VAR_CTR                             AUTOMATIC,ALIGNED,BINARY,FIXED(15,0)
                                                    101,239,500,528,528,529,530,531

16              VAR_FLD                             IN VAR(500),AUTOMATIC,UNALIGNED,STRING(28),CHARACTER,VARYING
                                                    107,241,507,530,531

100             VAR_FLD_MATCH                       AUTOMATIC,ALIGNED,STRING(1),BIT
                                                    102,106,110
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    114


DCL NO.         IDENTIFIER                          ATTRIBUTES AND REFERENCES


16              VAR_NAME                            IN VAR(500),AUTOMATIC,UNALIGNED,STRING(6),CHARACTER
                                                    104,113,240,501,503,529

142             WORK_PARM                           AUTOMATIC,UNALIGNED,STRING(100),CHARACTER,VARYING
                                                    156,157,159,165,171,177,183,189,195,201,215,216,217,218,218

808             WRITE_ASM                           ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    132

858             WRITE_COB                           ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    134

689             WRITE_FIELD                         ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    680

786             WRITE_FIELD                         ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    780

684             WRITE_IC                            ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    671,678

775             WRITE_MAPPING                       ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    127

656             WRITE_PANEL                         ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    126

816             WRITE_PARM                          ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    812

870             WRITE_PARM                          ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    862

943             WRITE_PARM                          ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    935

931             WRITE_PL1                           ENTRY,DECIMAL,FLOAT(SINGLE)
                                                    136
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    115


                                       AGGREGATE LENGTH TABLE


STATEMENT NO.   IDENTIFIER                          LENGTH IN BYTES

13              ATTR_REC                            91

14              ATTR_TBL                            819

15              FLD                                 105999

11              SCR_IMG                             2132

16              VAR                                 17000
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    116


          STORAGE REQUIREMENTS.
          ----------------------

          THE STORAGE AREA FOR THE PROCEDURE LABELLED MAPGEN IS 143528 BYTES LONG.

          THE STORAGE AREA FOR THE ON UNIT AT STATEMENT NO. 28 IS 188 BYTES LONG.

          THE STORAGE AREA FOR THE ON UNIT AT STATEMENT NO. 37 IS 176 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE BEGIN BLOCK AT STATEMENT NO. 63 IS 196 BYTES LONG.

          THE STORAGE AREA FOR THE ON UNIT AT STATEMENT NO. 81 IS 180 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED PROCESS_PARM IS 404 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED INITIALIZE IS 196 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED PROCESS_MYREC IS 168 BYTES LONG.

          THE STORAGE AREA FOR THE PROCEDURE LABELLED PROCESS_ATTRIBUTE IS 628 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED CHECK_ATTR IS 176 BYTES LONG.

          THE STORAGE AREA FOR THE PROCEDURE LABELLED PROCESS_VARS IS 904 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED PROCESS_SCREEN IS 284 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED SAVE_FIELD IS 232 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED PRINT_ATTR IS 176 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED WRITE_PANEL IS 312 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED WRITE_IC IS 200 BYTES LONG.

          THE STORAGE AREA FOR THE PROCEDURE LABELLED WRITE_FIELD IS 860 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED WRITE_MAPPING IS 204 BYTES LONG.

          THE STORAGE AREA FOR THE PROCEDURE LABELLED WRITE_FIELD IS 740 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED WRITE_ASM IS 236 BYTES LONG.

          THE STORAGE AREA FOR THE PROCEDURE LABELLED WRITE_PARM IS 1516 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED WRITE_COB IS 336 BYTES LONG.
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    117


          THE STORAGE AREA FOR THE PROCEDURE LABELLED WRITE_PARM IS 888 BYTES LONG.

          THE STORAGE AREA (IN STATIC) FOR THE PROCEDURE LABELLED WRITE_PL1 IS 336 BYTES LONG.

          THE STORAGE AREA FOR THE PROCEDURE LABELLED WRITE_PARM IS 888 BYTES LONG.

          THE PROGRAM CSECT IS NAMED MAPGEN   AND IS 42102 BYTES LONG.

          THE STATIC  CSECT IS NAMED *MAPGENA AND IS 11048 BYTES LONG.


*STATISTICS*     MACRO RECORDS =     1628,SOURCE RECORDS =     1641,PROG TEXT STMNTS =     1004,OBJECT BYTES =    42102
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    118


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN ON UNIT

OFFSET (HEX)  0000 0048 0056 00F2 0104 010E 01AC
STATEMENT NO    28   29   30   31   32   33   34


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN ON UNIT

OFFSET (HEX)  0000 0048 0052
STATEMENT NO    38   38


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN ON UNIT

OFFSET (HEX)  0000 0048 0056 0134 0148
STATEMENT NO    81   82   83   84   85


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          PROCESS_PARM

OFFSET (HEX)  0000 003C 0050 0050 0098 009E 009E 0108 011C 011C 014E 019A 01A0 01A0 01F0 01FC 01FC 020A 020A 0214 021A
STATEMENT NO   141  144  145  146  147  148  149  150  151  152  153  154  155  156  157  158  159  160  161  162  163

OFFSET (HEX)  021E 021E 022C 022C 0236 023C 0240 0240 024E 024E 0258 025E 0262 0262 0270 0270 027A 0280 0284 0284 0292
STATEMENT NO   164  165  166  167  168  169  170  171  172  173  174  175  176  177  178  179  180  181  182  183  184

OFFSET (HEX)  0292 029C 02A2 02A6 02A6 02B4 02B4 02BE 02C4 02C8 02C8 02D6 02D6 02E0 02E6 02EA 02EA 02F8 02F8 0302 0308
STATEMENT NO   185  186  187  188  189  190  191  192  193  194  195  196  197  198  199  200  201  202  203  204  205

OFFSET (HEX)  030C 030C 030C 0342 034C 0352 0352 0352 0352 0352 0360 036A 0386 03F8 03FC
STATEMENT NO   206  207  208  209  210  211  212  213  214  215  216  217  218  219  220


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          INITIALIZE

OFFSET (HEX)  0000 008C 0096 00C6 00F6 0126 0158 018A 01BC 01EC 021E 0254 028A 02C0 02F6 032C 0362 0392 03CC 03D6 0410
STATEMENT NO   221  222  223  224  225  226  227  228  229  230  231  232  233  234  235  236  237  238  239  240  241

OFFSET (HEX)  0442 044C 047C 04AE 04E4 051A 0550 0586 05BC 05F2 0622 0658
STATEMENT NO   242  243  244  245  246  247  248  249  250  251  252  253


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          PROCESS_MYREC

OFFSET (HEX)  0000 003C 004E 005C 006E 007C 008E 0098
STATEMENT NO   254  255  256  257  258  259  260  261
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    119


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          PROCESS_ATTRIBUTE

OFFSET (HEX)  0000 0090 0096 00EA 00F6 00FA 0166 0176 01CE 01E8 01EE 01FA 0224 0230 0230 0514 0586 058A 082A 082E 084A
STATEMENT NO   262  266  267  268  269  270  271  272  273  274  275  276  277  278  279  280  281  282  283  284  285

OFFSET (HEX)  084A 0860 0876 088C 08A2 08B8 08B8
STATEMENT NO   286  287  288  289  290  291  292


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          CHECK_ATTR

OFFSET (HEX)  0000 0044 0044 0044 0064 0064 0072 0076 0076 0096 0096 00A4 00A8 00A8 00C8 00C8 00D6 00DA 00DA 00FA 00FA
STATEMENT NO   293  295  296  297  298  299  300  301  302  303  304  305  306  307  308  309  310  311  312  313  314

OFFSET (HEX)  0108 010C 010C 012C 012C 013A 013E 013E 015E 015E 016C 0170 0170 0190 0190 019E 01A2 01A2 01C2 01C2 01D0
STATEMENT NO   315  316  317  318  319  320  321  322  323  324  325  326  327  328  329  330  331  332  333  334  335

OFFSET (HEX)  01D4 01D4 01F4 01F4 0202 0206 0206 0226 0226 0232 0236 0236 0256 0256 0262 0266 0266 0286 0286 0292 0296
STATEMENT NO   336  337  338  339  340  341  342  343  344  345  346  347  348  349  350  351  352  353  354  355  356

OFFSET (HEX)  0296 02B6 02B6 02C2 02C6 02C6 02E6 02E6 02F4 02F8 02F8 0318 0318 0326 032A 032A 034A 034A 0358 035C 035C
STATEMENT NO   357  358  359  360  361  362  363  364  365  366  367  368  369  370  371  372  373  374  375  376  377

OFFSET (HEX)  037C 037C 038A 038E 038E 03AE 03AE 03BC 03C0 03C0 03E0 03E0 03EE 03F2 03F2 0412 0412 0420 0424 0424 0444
STATEMENT NO   378  379  380  381  382  383  384  385  386  387  388  389  390  391  392  393  394  395  396  397  398

OFFSET (HEX)  0444 0452 0456 0456 0476 0476 0484 0488 0488 04A8 04A8 04B6 04BA 04BA 04DA 04DA 04E8 04EC 04EC 050C 050C
STATEMENT NO   399  400  401  402  403  404  405  406  407  408  409  410  411  412  413  414  415  416  417  418  419

OFFSET (HEX)  051A 051E 051E 053E 053E 054C 0550 0550 0570 0570 057E 0582 0582 05A2 05A2 05B0 05B4 05B4 05D4 05D4 05E2
STATEMENT NO   420  421  422  423  424  425  426  427  428  429  430  431  432  433  434  435  436  437  438  439  440

OFFSET (HEX)  05E6 05E6 05E6 064C 0656 0656 0656 0656 0656
STATEMENT NO   441  442  443  444  445  446  447  448  449


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          PROCESS_VARS

OFFSET (HEX)  0000 00BC 00CE 00CE 0100 010A 0110 0110 013A 0164 016A 016A 016A 01A6 01A6 01B2 01B6 01B6 01F2 01F2 01FE
STATEMENT NO   450  455  456  457  458  459  460  461  462  463  464  465  466  467  468  469  470  471  472  473  474

OFFSET (HEX)  0202 0202 020E 020E 021A 021E 021E 022A 022A 0236 023A 023A 023A 0270 027A 0280 0280 0280 0280 0280 028C
STATEMENT NO   475  476  477  478  479  480  481  482  483  484  485  486  487  488  489  490  491  492  493  494  495

OFFSET (HEX)  028C 02C2 02CC 02D2 02D2 02E6 0308 0308 038A 0394 039A 039A 03F0 03F0 047C 0486 048C 048C 04A0 04A6 04AC
STATEMENT NO   496  497  498  499  500  501  502  503  504  505  506  507  508  509  510  511  512  513  514  515  516
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    120


OFFSET (HEX)  04B2 04E8 04F4 0524 0528 0530 0534 0534 05AE 05B8 05BE 05BE 05CE 05E8 065E 069C 06A8 06AC 06B8 06B8 06EE
STATEMENT NO   517  518  519  520  521  522  523  524  525  526  527  528  529  530  531  532  533  534  535  536  537

OFFSET (HEX)  06F8 06FE 06FE 073A 0740 07D8 0802 080E 089A 0928 092E 093A 0964 0970 0970 0C54 0CC6 0CCA 0F6A 0F6E
STATEMENT NO   538  539  540  541  542  543  544  545  546  547  548  549  550  551  552  553  554  555  556  557


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          PROCESS_SCREEN

OFFSET (HEX)  0000 003C 0046 0052 005E 0080 0086 008C 0094 00B0 00C0 00DA 00DA 00E0 0100 0100 0116 0120 0120 012A 0130
STATEMENT NO   558  560  561  562  563  564  565  566  567  568  569  570  571  572  573  574  575  576  577  578  579

OFFSET (HEX)  0130 0144 0144 0192 0192 01A6 01B6 01B6 01CC 01D6 01D6
STATEMENT NO   580  581  582  583  584  585  586  587  588  589  590


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          SAVE_FIELD

OFFSET (HEX)  0000 0080 0090 00C4 00E0 00F8 0150 0160 0170 0184 031E
STATEMENT NO   591  594  595  596  597  598  599  600  601  602  603


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          PRINT_ATTR

OFFSET (HEX)  0000 0044 0054 0086 0096 00CC 0102 0112 0148 017E 018E 01C4 01FA 01FA 0210 0210 0210 0214 0214 0226 0226
STATEMENT NO   604  606  607  608  609  610  611  612  613  614  615  616  617  618  619  620  621  622  623  624  625

OFFSET (HEX)  0258 025C 025C 026E 026E 02A0 02A4 02A4 02B6 02B6 02E8 02EC 02EC 02FE 02FE 0330 0334 0334 0334 0380 038A
STATEMENT NO   626  627  628  629  630  631  632  633  634  635  636  637  638  639  640  641  642  643  644  645  646

OFFSET (HEX)  038A 038A 038A 038A 039A 03CC 03DC 040E 045E
STATEMENT NO   647  648  649  650  651  652  653  654  655


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_IC

OFFSET (HEX)  0000 0044 01A6 01D2
STATEMENT NO   684  686  687  688


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_FIELD

OFFSET (HEX)  0000 0114 012C 017C 0188 01DC 01E8 01EC 01F8 0206 0272 0296 0296 0348 034E 034E 038E 0468 0494 04AC 04F2
STATEMENT NO   689  696  697  698  699  700  701  702  703  704  705  706  707  708  709  710  711  712  713  714  715

OFFSET (HEX)  0508 0508 0556 05DE 060A 060A 062E 0678 06BE 06E2 072C 0772 0796 07E0 0826 087E 08C8 090E 0988 0988 09CE
STATEMENT NO   716  717  718  719  720  721  722  723  724  725  726  727  728  729  730  731  732  733  734  735  736
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    121


OFFSET (HEX)  0A46 0A72 0A84 0AA2 0AEC 0B0E 0B58 0B7A 0BC4 0BE6 0C2C 0CA6 0CEC 0D1C 0D9C 0D9C 0DB2 0DB2 0E14 0E40 0E46
STATEMENT NO   737  738  739  740  741  742  743  744  745  746  747  748  749  750  751  752  753  754  755  756  757

OFFSET (HEX)  0E46 0E8C 0F04 0F30 0F78 0F84 0F84 107E 10AA 10B0 10B0 1112 113E 113E 113E 1148
STATEMENT NO   758  759  760  761  762  763  764  765  766  767  768  769  770  771  772  773


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_PANEL

OFFSET (HEX)  0000 0044 0052 012E 016A 04BC 04E8 05F0 061C 0622 0628 0634 065C 065C 068A 0690 0696 0696 06A2 06A6 06B8
STATEMENT NO   656  659  660  661  662  663  664  665  666  667  668  669  670  671  672  673  674  675  676  677  678

OFFSET (HEX)  06C6 06DA 06F0 0704 0778 07A4
STATEMENT NO   679  680  681  682  683  774


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_FIELD

OFFSET (HEX)  0000 009C 00B4 0104 0110 0168 0178 017C 018C 0196 01FE 0224 0224 03D4 0400 0400
STATEMENT NO   786  792  793  794  795  796  797  798  799  800  801  802  803  804  805  806


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_MAPPING

OFFSET (HEX)  0000 003C 00E8 0114 0124 013A 014E 01C2 01EE 026A 0296
STATEMENT NO   775  777  778  779  780  781  782  783  784  785  807


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_PARM

OFFSET (HEX)  0000 00E0 00F8 0148 0150 01A0 01AC 01B0 01BC 01C6 022A 024A 024A 02FC 0302 0302 032C 0344 0394 0394 0542
STATEMENT NO   816  824  825  826  827  828  829  830  831  832  833  834  835  836  837  838  839  840  841  842  843

OFFSET (HEX)  056E 0622 062E 062E 072C 0758 075C 075C 07B4 07E0 07E0 07E0 07E6
STATEMENT NO   844  845  846  847  848  849  850  851  852  853  854  855  856


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_ASM

OFFSET (HEX)  0000 0044 030E 0322 033C 0358 04A4 04CC
STATEMENT NO   808  810  811  812  813  814  815  857


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_PARM

OFFSET (HEX)  0000 00C0 00D8 0128 0130 0180 018C 0190 019C 01A6 020A 022A 022A 02DC 02E2 02E2 031E 032E 034A 0360 0374
STATEMENT NO   870  879  880  881  882  883  884  885  886  887  888  889  890  891  892  893  894  895  896  897  898
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    122


OFFSET (HEX)  038C 03DC 03DC 049E 04CA 05AC 05D8 06EE 071A 07EC 07F8 07F8 0896 08C2 08C6 08C6 092C 0958 09A0 09AC 09AC
STATEMENT NO   899  900  901  902  903  904  905  906  907  908  909  910  911  912  913  914  915  916  917  918  919

OFFSET (HEX)  0B0A 0B36 0B3A 0B3A 0BA4 0BD0 0BD0 0BD0 0BD6 0BD6
STATEMENT NO   920  921  922  923  924  925  926  927  928  929


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_COB

OFFSET (HEX)  0000 0044 0634 0648 0662 067E 0722 074A 0816 083E 090A 0932
STATEMENT NO   858  860  861  862  863  864  865  866  867  868  869  930


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_PARM

OFFSET (HEX)  0000 00C0 00D8 0128 0130 0180 018C 0190 019C 01A6 020A 022A 022A 02DC 02E2 02E2 031E 032E 034A 0360 0374
STATEMENT NO   943  952  953  954  955  956  957  958  959  960  961  962  963  964  965  966  967  968  969  970  971

OFFSET (HEX)  038C 03DC 03DC 048C 04B8 0588 05B4 06B8 06E4 07A4 07B0 07B0 084E 087A 087E 087E 08E4 0910 0958 0964 0964
STATEMENT NO   972  973  974  975  976  977  978  979  980  981  982  983  984  985  986  987  988  989  990  991  992

OFFSET (HEX)  0A84 0AB0 0AB4 0AB4 0B1E 0B4A 0B4A 0B4A 0B50 0B50
STATEMENT NO   993  994  995  996  997  998  999 1000 1001 1002


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          WRITE_PL1

OFFSET (HEX)  0000 0044 0660 0674 068E 06AA 0726 074E 07F2 081A 08BE 08E6
STATEMENT NO   931  933  934  935  936  937  938  939  940  941  942 1003


TABLE OF OFFSETS AND STATEMENT NUMBERS WITHIN PROCEDURE          MAPGEN

OFFSET (HEX)  0000 0484 04E2 04F4 04FE 050C 0522 052C 053A 0540 057A 0582 058E 05F8 060A 060A 0610 0616 061C 0620 0632
STATEMENT NO     1   24   25   26   27   35   36   37   39   40   41   42   43   44   45   46   47   48   49   50   51

OFFSET (HEX)  0632 0638 063E 0644 064A 0650 0656 065C 0660 0672 067C 06BC 06D6 0700 070C 077C 0786 0798 079C 07A6 07E0
STATEMENT NO    52   53   54   55   56   57   58   59   60   61   62   65   66   67   68   69   70   71   72   73   74

OFFSET (HEX)  07E4 0804 0804 080E 0814 0814 0822 0838 091E 0966 0A28 0A38 0AB2 0AC6 0B88 0BD0 0BE0 0C70 0CB8 0F4C 0F60
STATEMENT NO    75   76   77   78   79   80   86   87   88   89   90   91   92   93   94   95   96   97   98   99  101

OFFSET (HEX)  0F70 0F76 0F86 0FCE 0FCE 0FD4 1014 1014 1028 1030 1034 1034 10C8 10CE 10CE 10E2 112A 113C 113C 11EE 1482
STATEMENT NO   102  103  104  105  106  107  108  109  110  111  112  113  114  115  116  117  118  119  120  121  122

OFFSET (HEX)  1482 1496 14A0 14A0 14AA 14B4 152C 1554 1554 155E 1568 1572 157C 1586 1590 159A 15A0 15F8 160E
STATEMENT NO   123  124  125  126  127  128  129  130  131  132  133  134  135  136  137  138  139  140 1004
           /********************** MAP3270 V2.2.0********************************/00010000                  PAGE    123


    COMPILER DIAGNOSTICS.




 WARNINGS.


    IEM0227I          NO FILE/STRING OPTION SPECIFIED IN ONE OR MORE GET/PUT STATEMENTS. SYSIN/SYSPRINT HAS BEEN


                      ASSUMED IN EACH CASE.


    IEM0764I          ONE OR MORE FIXED BINARY ITEMS OF PRECISION 15 OR LESS HAVE BEEN GIVEN HALFWORD STORAGE. THEY


                      ARE FLAGGED '*********' IN THE XREF/ATR LIST.


    IEM1790I          DATA CONVERSIONS WILL BE DONE BY SUBROUTINE CALL IN THE FOLLOWING STATEMENTS   661.





 END OF DIAGNOSTICS.


AUXILIARY STORAGE WILL NOT BE USED FOR DICTIONARY WHEN SIZE = 120K


COMPILE TIME         .01 MINS

ELAPSED TIME         .01 MINS

 F64-LEVEL LINKAGE EDITOR OPTIONS SPECIFIED XREF,LIST
          DEFAULT OPTION(S) USED -  SIZE=(65536,38912)
****MAP3270   NOW REPLACED IN DATA SET
AUTHORIZATION CODE IS         0.



                                                CROSS REFERENCE TABLE


  CONTROL SECTION                       ENTRY

    NAME    ORIGIN  LENGTH                NAME   LOCATION     NAME   LOCATION     NAME   LOCATION     NAME   LOCATION
  MAPGEN        00    A476
  *MAPGENA    A478    2B28
  IHEMAIN     CFA0       4
  IHENTRY     CFA8       C
  PANEL       CFB8      38
  ASM         CFF0      38
  COB         D028      38
  PL1         D060      38
  IHESPRT     D098      38
  SYSIN       D0D0      38
  IHEDMA  *   D108      F8
                                        IHEDMAA     D108
  IHEVFA  *   D200     16C
                                        IHEVFAA     D200
  IHEVFB  *   D370      F0
                                        IHEVFBA     D370
  IHEVFC  *   D460      26
                                        IHEVFCA     D460
  IHEVFD  *   D488      66
                                        IHEVFDA     D488
  IHEVFE  *   D4F0      20
                                        IHEVFEA     D4F0
  IHEVKB  *   D510     30A
                                        IHEVKBA     D510
  IHEVKC  *   D820     2D0
                                        IHEVKCA     D820
  IHEVKF  *   DAF0     67C
                                        IHEVKFA     DAF0
  IHEVKG  *   E170     4DE
                                        IHEVKGA     E170
  IHEVPA  *   E650     1E0
                                        IHEVPAA     E650
  IHEVPB  *   E830     1A2
                                        IHEVPBA     E830
  IHEVPC  *   E9D8     1F0
                                        IHEVPCA     E9D8
  IHEVPD  *   EBC8     105
                                        IHEVPDA     EBC8
  IHEVPE  *   ECD0     278
                                        IHEVPEA     ECD0
  IHEVPF  *   EF48      50
                                        IHEVPFA     EF48


    NAME    ORIGIN  LENGTH                NAME   LOCATION     NAME   LOCATION     NAME   LOCATION     NAME   LOCATION
  IHEVPG  *   EF98     229
                                        IHEVPGA     EF98
  IHEVPH  *   F1C8      B4
                                        IHEVPHA     F1C8
  IHEERR  *   F280     745
                                        IHEERRD     F280    IHEERRC     F28A    IHEERRB     F294    IHEERRA     F29E
                                        IHEERRE     F92E
  IHEABN  *   F9C8       C
                                        IHEABND     F9C8
  IHEM91  *   F9D8     178
                                        IHEM91B     F9D8    IHEM91A     F9E0    IHEM91C     FAF2
  IHETER  *   FB50     110
                                        IHETERA     FB50
  IHEDOB  *   FC60     144
                                        IHEDOBA     FC60    IHEDOBB     FC62    IHEDOBC     FC64
  IHEDNC  *   FDA8     2B2
                                        IHEDNCA     FDA8
  IHEIOD  *  10060     29A
                                        IHEIODG    10060    IHEIODP    10062    IHEIODT    1015A
  IHEVSB  *  10300      CE
                                        IHEVSBA    10300
  IHEVSC  *  103D0      AC
                                        IHEVSCA    103D0
  IHEVSE  *  10480     15D
                                        IHEVSEA    10480    IHEVSEB    10482
  IHEVSF  *  105E0      EC
                                        IHEVSFA    105E0
  IHEUPA  *  106D0      E8
                                        IHEUPAA    106D0    IHEUPAB    1073A
  IHEVQC  *  107B8     268
                                        IHEVQCA    107B8
  IHEIOF  *  10A20     2DC
                                        IHEIOFB    10A20    IHEIOFA    10A22    IHEITAZ    10CBE    IHEITAX    10CCA
                                        IHEITAA    10CDE
  IHEDOE  *  10D00      DA
                                        IHEDOEA    10D00
  IHEDBN  *  10DE0     167
                                        IHEDBNA    10DE0
  IHEDCN  *  10F48     256
                                        IHEDCNA    10F48    IHEDCNB    10F4A
  IHEUPB  *  111A0      E4
                                        IHEUPBA    111A0    IHEUPBB    11208
  IHEVQB  *  11288     4DC
                                        IHEVQBA    11288
  IHEVQA  *  11768      FC
                                        IHEVQAA    11768
  IHEIOP  *  11868     1F7
                                        IHEIOPA    11868    IHEIOPB    1186A    IHEIOPC    1186E
  IHEIOX  *  11A60     14C
                                        IHEIOXA    11A60    IHEIOXB    11A62    IHEIOXC    11A66
  IHESAP  *  11BB0     B1C
                                        IHESADA    11BB0    IHESAPC    11BCA    IHESAPD    11BD2    IHESAPA    11BDA


    NAME    ORIGIN  LENGTH                NAME   LOCATION     NAME   LOCATION     NAME   LOCATION     NAME   LOCATION
                                        IHESAPB    11BE2    IHESADF    11BEA    IHESADB    11BF2    IHESADE    11BFA
                                        IHESAFC    11C02    IHESAFA    11C0A    IHESAFB    11C12    IHESAFD    11C1A
                                        IHESARA    11C22    IHESAFQ    11C2A    IHESARC    1241C    IHESADD    12530
                                        IHESAFF    1256A
  IHEBEG  *  126D0      80
                                        IHEBEGN    126D0    IHEBEGA    12710
  IHEDDO  *  12750     288
                                        IHEDDOA    12750    IHEDDOB    12752    IHEDDOC    12754    IHEDDOD    12756
                                        IHEDDOE    12758
  IHEOCL  *  129D8     580
                                        IHEOCLA    129D8    IHEOCLB    129DA    IHEOCLC    129DC    IHEOCLD    129DE
  IHEPRT  *  12F58     308
                                        IHEPRTA    12F58    IHEPRTB    12F5A
  IHESIZ  *  13260       C
                                        IHESIZE    13260
  IHETAB  *  13270       C
                                        IHETABS    13270
  IHEDDP  *  13280     28C
                                        IHEDDPA    13280    IHEDDPB    13282    IHEDDPC    13284    IHEDDPD    13286
  IHELDO  *  13510     418
                                        IHELDOA    13510    IHELDOB    13512    IHELDOC    13516
  IHECSC  *  13928      C6
                                        IHECSC0    13928
  IHECSK  *  139F0     13A
                                        IHECSKR    139F0    IHECSKK    13A1C
  IHEDIB  *  13B30     114
                                        IHEDIBA    13B30    IHEDIBB    13B32
  IHEKCD  *  13C48     110
                                        IHEKCDA    13C48    IHEKCDB    13C4A
  IHEVSD  *  13D58     1A0
                                        IHEVSDA    13D58    IHEVSDB    13D5A
  IHEDOA  *  13EF8     23A
                                        IHEDOAA    13EF8    IHEDOAB    13EFA
  IHEIOA  *  14138     16A
                                        IHEIOAA    14138    IHEIOAB    1413A    IHEIOAC    1413C    IHEIOAD    1413E
                                        IHEIOAT    14228
  IHEIOB  *  142A8     1E0
                                        IHEIOBA    142A8    IHEIOBB    142B0    IHEIOBC    142B8    IHEIOBD    142C0
                                        IHEIOBE    142C8    IHEIOBT    143B0
  IHEOSD  *  14488      D8
                                        IHEOSDA    14488
  IHEOST  *  14560      52
                                        IHEOSTA    14560



  LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION             LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION
       10            *MAPGENA        *MAPGENA                    1630            *MAPGENA        *MAPGENA
     17E4            *MAPGENA        *MAPGENA                    183C            *MAPGENA        *MAPGENA
     A498            IHESADA         IHESAP                      A49C            IHESADB         IHESAP
     A4A0            MAPGEN          MAPGEN                      A4A4            MAPGEN          MAPGEN
     A588            MAPGEN          MAPGEN                      A58C            MAPGEN          MAPGEN


  LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION             LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION
     A590            MAPGEN          MAPGEN                      A594            MAPGEN          MAPGEN
     A598            MAPGEN          MAPGEN                      A59C            MAPGEN          MAPGEN
     A5A0            MAPGEN          MAPGEN                      A5A4            MAPGEN          MAPGEN
     A5A8            MAPGEN          MAPGEN                      A5AC            MAPGEN          MAPGEN
     A5B0            MAPGEN          MAPGEN                      A5B4            MAPGEN          MAPGEN
     A5B8            MAPGEN          MAPGEN                      A5BC            MAPGEN          MAPGEN
     A5C0            MAPGEN          MAPGEN                      A5C4            MAPGEN          MAPGEN
     A5C8            MAPGEN          MAPGEN                      A5CC            MAPGEN          MAPGEN
     A5D0            MAPGEN          MAPGEN                      A5D4            MAPGEN          MAPGEN
     A5D8            MAPGEN          MAPGEN                      A5DC            MAPGEN          MAPGEN
     A5E0            MAPGEN          MAPGEN                      A5E4            MAPGEN          MAPGEN
     A5E8            IHEDMAA         IHEDMA                      A5EC            IHESAFD         IHESAP
     BE28            PL1             PL1                         BE2D            MAPGEN          MAPGEN
     BE30            PL1             PL1                         BE35            MAPGEN          MAPGEN
     BE38            PL1             PL1                         BE3D            MAPGEN          MAPGEN
     BE40            PL1             PL1                         BE45            MAPGEN          MAPGEN
     BE48            PL1             PL1                         BE4D            MAPGEN          MAPGEN
     BE50            PL1             PL1                         BE55            MAPGEN          MAPGEN
     BE58            PL1             PL1                         BE5D            MAPGEN          MAPGEN
     BE60            PL1             PL1                         BE65            MAPGEN          MAPGEN
     BE68            IHESPRT         IHESPRT                     BE6C            MAPGEN          MAPGEN
     BE74            PL1             PL1                         BE79            MAPGEN          MAPGEN
     BE7C            PL1             PL1                         BE81            MAPGEN          MAPGEN
     BE84            PL1             PL1                         BE89            MAPGEN          MAPGEN
     BE8C            PL1             PL1                         BE91            MAPGEN          MAPGEN
     BE94            COB             COB                         BE99            MAPGEN          MAPGEN
     BE9C            COB             COB                         BEA1            MAPGEN          MAPGEN
     BEA4            COB             COB                         BEA9            MAPGEN          MAPGEN
     BEAC            COB             COB                         BEB1            MAPGEN          MAPGEN
     BEB4            COB             COB                         BEB9            MAPGEN          MAPGEN
     BEBC            COB             COB                         BEC1            MAPGEN          MAPGEN
     BEC4            COB             COB                         BEC9            MAPGEN          MAPGEN
     BECC            COB             COB                         BED1            MAPGEN          MAPGEN
     BED4            IHESPRT         IHESPRT                     BED8            MAPGEN          MAPGEN
     BEE0            COB             COB                         BEE5            MAPGEN          MAPGEN
     BEE8            COB             COB                         BEED            MAPGEN          MAPGEN
     BEF0            COB             COB                         BEF5            MAPGEN          MAPGEN
     BEF8            COB             COB                         BEFD            MAPGEN          MAPGEN
     BF00            ASM             ASM                         BF05            MAPGEN          MAPGEN
     BF08            ASM             ASM                         BF0D            MAPGEN          MAPGEN
     BF10            ASM             ASM                         BF15            MAPGEN          MAPGEN
     BF18            IHESPRT         IHESPRT                     BF1C            MAPGEN          MAPGEN
     BF24            ASM             ASM                         BF29            MAPGEN          MAPGEN
     BF2C            ASM             ASM                         BF31            MAPGEN          MAPGEN
     BF34            PANEL           PANEL                       BF39            MAPGEN          MAPGEN
     BF3C            PANEL           PANEL                       BF41            MAPGEN          MAPGEN
     BF44            PANEL           PANEL                       BF49            MAPGEN          MAPGEN
     BF4C            PANEL           PANEL                       BF51            MAPGEN          MAPGEN
     BF54            PANEL           PANEL                       BF59            MAPGEN          MAPGEN
     BF5C            PANEL           PANEL                       BF61            MAPGEN          MAPGEN
     BF64            PANEL           PANEL                       BF69            MAPGEN          MAPGEN
     BF6C            PANEL           PANEL                       BF71            MAPGEN          MAPGEN


  LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION             LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION
     BF74            PANEL           PANEL                       BF79            MAPGEN          MAPGEN
     BF7C            PANEL           PANEL                       BF80            MAPGEN          MAPGEN
     BF88            PANEL           PANEL                       BF8C            MAPGEN          MAPGEN
     BF94            IHESPRT         IHESPRT                     BF98            MAPGEN          MAPGEN
     BFA0            PANEL           PANEL                       BFA5            MAPGEN          MAPGEN
     BFA8            PANEL           PANEL                       BFAD            MAPGEN          MAPGEN
     BFB0            PANEL           PANEL                       BFB5            MAPGEN          MAPGEN
     BFB8            PANEL           PANEL                       BFBD            MAPGEN          MAPGEN
     BFC0            PANEL           PANEL                       BFC5            MAPGEN          MAPGEN
     BFC8            PANEL           PANEL                       BFE8            IHESPRT         IHESPRT
     BFED            MAPGEN          MAPGEN                      BFF0            IHESPRT         IHESPRT
     BFF5            MAPGEN          MAPGEN                      BFF8            IHESPRT         IHESPRT
     BFFD            MAPGEN          MAPGEN                      C000            IHESPRT         IHESPRT
     C004            MAPGEN          MAPGEN                      C00C            IHESPRT         IHESPRT
     C011            MAPGEN          MAPGEN                      C014            IHESPRT         IHESPRT
     C019            MAPGEN          MAPGEN                      C01C            IHESPRT         IHESPRT
     C021            MAPGEN          MAPGEN                      C024            IHESPRT         IHESPRT
     C029            MAPGEN          MAPGEN                      C02C            IHESPRT         IHESPRT
     C031            MAPGEN          MAPGEN                      C034            IHESPRT         IHESPRT
     C039            MAPGEN          MAPGEN                      C03C            IHESPRT         IHESPRT
     C041            MAPGEN          MAPGEN                      C044            IHESPRT         IHESPRT
     C049            MAPGEN          MAPGEN                      C04C            IHESPRT         IHESPRT
     C051            MAPGEN          MAPGEN                      C054            IHESPRT         IHESPRT
     C059            MAPGEN          MAPGEN                      C05C            IHESPRT         IHESPRT
     C061            MAPGEN          MAPGEN                      C064            IHESPRT         IHESPRT
     C068            MAPGEN          MAPGEN                      C070            IHESPRT         IHESPRT
     C074            MAPGEN          MAPGEN                      C07C            IHESPRT         IHESPRT
     C080            MAPGEN          MAPGEN                      C088            IHESPRT         IHESPRT
     C08C            MAPGEN          MAPGEN                      C094            IHESPRT         IHESPRT
     C098            MAPGEN          MAPGEN                      C0A0            IHESPRT         IHESPRT
     C0A4            MAPGEN          MAPGEN                      C0AC            IHESPRT         IHESPRT
     C0B0            MAPGEN          MAPGEN                      C0B8            IHESPRT         IHESPRT
     C0BC            MAPGEN          MAPGEN                      C0C4            IHESPRT         IHESPRT
     C0C8            MAPGEN          MAPGEN                      C0D0            IHESPRT         IHESPRT
     C0D4            MAPGEN          MAPGEN                      C0DC            IHESPRT         IHESPRT
     C0E0            MAPGEN          MAPGEN                      C0E8            IHESPRT         IHESPRT
     C0EC            MAPGEN          MAPGEN                      C0F4            IHESPRT         IHESPRT
     C0F8            MAPGEN          MAPGEN                      C100            IHESPRT         IHESPRT
     C104            MAPGEN          MAPGEN                      C10C            PANEL           PANEL
     C111            MAPGEN          MAPGEN                      C114            IHESPRT         IHESPRT
     C118            MAPGEN          MAPGEN                      C120            IHESPRT         IHESPRT
     C124            MAPGEN          MAPGEN                      C12C            IHESPRT         IHESPRT
     C130            MAPGEN          MAPGEN                      C138            IHESPRT         IHESPRT
     C13C            MAPGEN          MAPGEN                      C144            IHESPRT         IHESPRT
     C148            MAPGEN          MAPGEN                      C150            IHESPRT         IHESPRT
     C154            MAPGEN          MAPGEN                      C15C            IHESPRT         IHESPRT
     C160            MAPGEN          MAPGEN                      C168            IHESPRT         IHESPRT
     C16C            MAPGEN          MAPGEN                      C174            IHESPRT         IHESPRT
     C178            MAPGEN          MAPGEN                      C180            IHESPRT         IHESPRT
     C184            MAPGEN          MAPGEN                      C18C            IHESPRT         IHESPRT
     C190            MAPGEN          MAPGEN                      C198            IHESPRT         IHESPRT
     A66C            COB             COB                         A670            PL1             PL1


  LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION             LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION
     A674            IHESPRT         IHESPRT                     A678            SYSIN           SYSIN
     A5F0            IHESADB         IHESAP                      A5F4            IHEIOXC         IHEIOX
     A5F8            IHEIOXC         IHEIOX                      A5FC            IHEIOXB         IHEIOX
     A600            IHEIOXB         IHEIOX                      A604            IHEIOPB         IHEIOP
     A608            IHEIOPB         IHEIOP                      A60C            IHEDOEA         IHEDOE
     A610            IHEDOEA         IHEDOE                      A614            IHEDOBB         IHEDOB
     A618            IHEDOBB         IHEDOB                      A61C            IHEDIBA         IHEDIB
     A620            IHEDOBA         IHEDOB                      A624            IHEDOAA         IHEDOA
     A628            IHEDOAA         IHEDOA                      A62C            IHEOCLA         IHEOCL
     A630            IHEIOBA         IHEIOB                      A634            IHEIOAT         IHEIOA
     A638            IHEIOAA         IHEIOA                      A63C            IHEIOBC         IHEIOB
     A640            IHEIOBT         IHEIOB                      A644            IHEIOBB         IHEIOB
     A648            IHESAFB         IHESAP                      A64C            IHEERRB         IHEERR
     A4A8            IHESAFA         IHESAP                      A650            IHECSKK         IHECSK
     A654            IHECSC0         IHECSC                      A658            IHESARC         IHESAP
     A65C            IHEOSDA         IHEOSD                      A660            IHEOSTA         IHEOST
     A664            PANEL           PANEL                       A668            ASM             ASM
     C19C            MAPGEN          MAPGEN                      C1A4            IHESPRT         IHESPRT
     C1A9            MAPGEN          MAPGEN                      C1AC            SYSIN           SYSIN
     C1B1            MAPGEN          MAPGEN                      C1B4            IHESPRT         IHESPRT
     C1B8            MAPGEN          MAPGEN                      C1C0            SYSIN           SYSIN
     C1C5            MAPGEN          MAPGEN                      C1C8            IHESPRT         IHESPRT
     C1CC            MAPGEN          MAPGEN                      C1D4            IHESPRT         IHESPRT
     C1D9            MAPGEN          MAPGEN                      CFA0            MAPGEN          MAPGEN
     CFB0            IHESAPC         IHESAP                      D174            IHEVFBA         IHEVFB
     D178            IHEVFCA         IHEVFC                      D180            IHEVFAA         IHEVFA
     D184            IHEVPAA         IHEVPA                      D188            IHEVKGA         IHEVKG
     D18C            IHEVPDA         IHEVPD                      D190            IHEVKFA         IHEVKF
     D194            IHEVPBA         IHEVPB                      D198            IHEVPCA         IHEVPC
     D1C4            IHEVFDA         IHEVFD                      D1C8            IHEVFEA         IHEVFE
     D1D0            IHEVPHA         IHEVPH                      D1D4            IHEVPGA         IHEVPG
     D1D8            IHEVKCA         IHEVKC                      D1DC            IHEVPFA         IHEVPF
     D1E0            IHEVKBA         IHEVKB                      D1E4            IHEVPEA         IHEVPE
     D448            IHEERRB         IHEERR                      E164            IHEERRB         IHEERR
     E63C            IHEERRB         IHEERR                      E82C            IHEERRB         IHEERR
     E9B0            IHEERRC         IHEERR                      E9C0            IHEERRB         IHEERR
     EBB0            IHEERRC         IHEERR                      EBB4            IHEERRB         IHEERR
     ECC0            IHEERRB         IHEERR                      EF30            IHEERRB         IHEERR
     F1B4            IHEERRB         IHEERR                      F278            IHEERRB         IHEERR
     F974            IHEM91A         IHEM91                      F978            IHEM91B         IHEM91
     F97C            IHEM91C         IHEM91                      F980            IHEABND         IHEABN
     F9A4            IHETERA         IHETER                      FB38            IHEERRC         IHEERR
     FD84            IHEERRC         IHEERR                      FD88            IHEIODP         IHEIOD
     FD8C            IHEIODT         IHEIOD                      FD90            IHEDNCA         IHEDNC
     FD94            IHEVSCA         IHEVSC                      FD98            IHEVSEA         IHEVSE
     FD9C            IHEVSBA         IHEVSB                      FDA0            IHEVSFA         IHEVSF
    1003C            IHEDMAA         IHEDMA                     10040            IHEUPAB         IHEUPA
    10044            IHEVSCA         IHEVSC                     10048            IHEVSEB         IHEVSE
    1004C            IHEVQCA         IHEVQC                     102E8            IHEIOFA         IHEIOF
    102EC            IHEERRB         IHEERR                     102F0            IHEERRC         IHEERR
    105D0            IHEERRB         IHEERR                     105D4            IHEERRC         IHEERR
    106C4            IHEERRC         IHEERR                     10908            IHEVSEB         IHEVSE


  LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION             LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION
    1098C            IHEERRC         IHEERR                     109A8            IHEERRB         IHEERR
    109FC            IHEVSCA         IHEVSC                     10CEC            IHEERRB         IHEERR
    10CF0            IHEERRC         IHEERR                     10DC0            IHEVSBA         IHEVSB
    10DC4            IHEDMAA         IHEDMA                     10DC8            IHEIODP         IHEIOD
    10DCC            IHEIODT         IHEIOD                     10DD0            IHEDCNA         IHEDCN
    10DD4            IHEDBNA         IHEDBN                     10F30            IHEDMAA         IHEDMA
    10F34            IHEUPBB         IHEUPB                     10F38            IHEUPAB         IHEUPA
    10F3C            IHEERRB         IHEERR                     11164            IHEDMAA         IHEDMA
    11168            IHEVQBA         IHEVQB                     1116C            IHEERRB         IHEERR
    11170            IHEUPAB         IHEUPA                     11174            IHEUPBB         IHEUPB
    11178            IHEUPAA         IHEUPA                     1117C            IHEUPBA         IHEUPB
    1127C            IHEDMAA         IHEDMA                     11698            IHEERRB         IHEERR
    1169C            IHEVQAA         IHEVQA                     11E1D            IHEERRA         IHEERR
    125F4            IHEBEGA         IHEBEG                     12678            IHEITAX         IHEIOF
    1267C            IHEERRB         IHEERR                     12680            IHEERRC         IHEERR
    12684            IHETABS         IHETAB                     12688            IHEITAZ         IHEIOF
    1184C            IHEERRB         IHEERR                     11A44            IHEIOFA         IHEIOF
    11A48            IHEERRB         IHEERR                     11A4C            IHEERRC         IHEERR
    11B94            IHEERRB         IHEERR                     11B98            IHEERRC         IHEERR
    11B9C            IHEIODG         IHEIOD                     11BA0            IHEIODP         IHEIOD
    11BA4            IHEIODT         IHEIOD                     11BA8            IHEIOFA         IHEIOF
    125CC            IHEMAIN         IHEMAIN                    125EC            IHEOCLD         IHEOCL
    125F0            IHESIZE         IHESIZ                     126BC            IHEPRTA         IHEPRT
    126C0            IHEPRTB         IHEPRT                     126C4            IHEDDOD         IHEDDO
    126C8            IHEOCLC         IHEOCL                     129B8            IHEIOFA         IHEIOF
    129BC            IHELDOC         IHELDO                     129C0            IHEPRTB         IHEPRT
    129C4            IHEDDPA         IHEDDP                     129C8            IHEDDPB         IHEDDP
    129CC            IHEDDPC         IHEDDP                     129D0            IHEDDPD         IHEDDP
    12F38            IHEIOFA         IHEIOF                     12F40            IHEERRB         IHEERR
    12F44            IHEERRC         IHEERR                     1322C            IHEOCLA         IHEOCL
    13230            IHEIOFA         IHEIOF                     13234            IHESPRT         IHESPRT
    13914            IHEERRC         IHEERR                     13918            IHEIOFA         IHEIOF
    1391C            IHEVSBA         IHEVSB                     13920            IHEVSCA         IHEVSC
    13924            IHEDNCA         IHEDNC                     13C20            IHEVSDA         IHEVSD
    13C24            IHEVSEA         IHEVSE                     13C28            IHEKCDA         IHEKCD
    13C2C            IHEDCNA         IHEDCN                     13C30            IHEIODG         IHEIOD
    13C34            IHEIODT         IHEIOD                     13C38            IHEVSCA         IHEVSC
    13D50            IHEERRB         IHEERR                     13EEC            IHEERRB         IHEERR
    14118            IHEIODP         IHEIOD                     1411C            IHEIODT         IHEIOD
    14120            IHEDMAA         IHEDMA                     14124            IHEDCNA         IHEDCN
    14128            IHEDBNA         IHEDBN                     1412C            IHEVQCA         IHEVQC
    14294            IHEERRC         IHEERR                     14298            IHEERRB         IHEERR
    1429C            IHEIOPB         IHEIOP                     1445C            IHEIOPA         IHEIOP
    14460            IHEIOPB         IHEIOP                     14464            IHEIOPC         IHEIOP
    14468            IHEIOPA         IHEIOP                     1446C            IHEOCLC         IHEOCL
    14480            IHEERRB         IHEERR                     14484            IHEERRC         IHEERR

  LOCATION   FC5C REQUESTS CUMULATIVE PSEUDO REGISTER LENGTH

 PSEUDO REGISTERS



    NAME    ORIGIN  LENGTH        NAME    ORIGIN  LENGTH        NAME    ORIGIN  LENGTH        NAME    ORIGIN  LENGTH
  IHEQINV       00       4      IHEQERR        4       4      IHEQTIC        8       4      IHEQLWF        C       4
  IHEQSLA       10       4      IHEQLW0       14       4      *MAPGENB      18       4      *MAPGENC      1C       4
  *MAPGEND      20       4      *MAPGENE      24       4      *MAPGENF      28       4      *MAPGENG      2C       4
  *MAPGENH      30       4      *MAPGENI      34       4      *MAPGENJ      38       4      *MAPGENK      3C       4
  *MAPGENL      40       4      *MAPGENM      44       4      *MAPGENN      48       4      *MAPGENO      4C       4
  *MAPGENP      50       4      *MAPGENQ      54       4      *MAPGENR      58       4      *MAPGENS      5C       4
  *MAPGENT      60       4      *MAPGENU      64       4      *MAPGENV      68       4      *MAPGENW      6C       4
  *MAPGENX      70       4      *MAPGENY      74       4      *MAPGENZ      78       4      PANEL         7C       4
  ASM           80       4      COB           84       4      PL1           88       4      IHEQSPR       8C       4
  SYSIN         90       4      IHEQLSA       94       4      IHEQLW1       98       4      IHEQLW2       9C       4
  IHEQLW3       A0       4      IHEQLW4       A4       4      IHEQLWE       A8       4      IHEQLCA       AC       4
  IHEQVDA       B0       4      IHEQFVD       B4       4      IHEQLPR       B8       4      IHEQFOP       BC       4
  IHEQCFL       C0       8      IHEQADC       C8       4      IHEQSAR       CC       4      IHEQRTC       D0       4

  IHEQSFC       D4       4      IHEQXLV       D8       8      IHEQEVT       E0       8
 TOTAL LENGTH OF PSEUDO REGISTERS      E8
 ENTRY ADDRESS     CFA8

 TOTAL LENGTH     145B8
M A P 3 2 7 0   S C R E E N   C O M P I L E R                                                      V2.2.0     PAGE   1

*** USING DEFAULT EXEC PARM 'ASM,COB,PLI,MAP'

INPUT STATEMENTS

 LINE:   STATEMENT
------   ---------
    1:   .ATTR
    2:   _ ALPHA,PROT
    3:   % ALPHA,UNPROT,BRIGHT
    4:   @ TITLE
    5:   .NAME=TTY3270
    6:   .SCREEN
    7:   @-------------------------------------------------------------------------------
    8:   _...............................................................................
    9:   _...............................................................................
   10:   _...............................................................................
   11:   _...............................................................................
   12:   _...............................................................................
   13:   _...............................................................................
   14:   _...............................................................................
   15:   _...............................................................................
   16:   _...............................................................................
   17:   _...............................................................................
   18:   _...............................................................................
   19:   _...............................................................................
   20:   _...............................................................................
   21:   _...............................................................................
   22:   _...............................................................................
   23:   _...............................................................................
   24:   _...............................................................................
   25:   _...............................................................................
   26:   _...............................................................................
   27:   _...............................................................................
   28:   @-------------------------------------------------------------------------------
   29:   %.............................................................................
   30:   _...............................................................................
M A P 3 2 7 0   S C R E E N   C O M P I L E R                        PANEL TTY3270                 V2.2.0     PAGE   2


          * >>>>>>>>>>>>>>>>>>>>>>>>>>>>> SAMPLE SCREEN LAYOUT <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
          *
          * ----+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8
        1 * @-------------------------------------------------------------------------------
        2 * _...............................................................................
        3 * _...............................................................................
        4 * _...............................................................................
        5 * _...............................................................................
        6 * _...............................................................................
        7 * _...............................................................................
        8 * _...............................................................................
        9 * _...............................................................................
       10 * _...............................................................................
       11 * _...............................................................................
       12 * _...............................................................................
       13 * _...............................................................................
       14 * _...............................................................................
       15 * _...............................................................................
       16 * _...............................................................................
       17 * _...............................................................................
       18 * _...............................................................................
       19 * _...............................................................................
       20 * _...............................................................................
       21 * _...............................................................................
       22 * @-------------------------------------------------------------------------------
       23 * %.............................................................................
       24 * _...............................................................................
          * ----+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8

          CHAR ATTR
            _  (ALPHA,PROT)
                ALPHA PROT NORMAL
            %  (ALPHA,UNPROT,BRIGHT)
                ALPHA UNPROT BRIGHT
            @  (TITLE)
                TITLE ALPHA PROT NORMAL

       ROW  COL NAME
         1    1 R01C01                      TITLE ALPHA PROT NORMAL
         2    1 R02C01                      ALPHA PROT NORMAL
         3    1 R03C01                      ALPHA PROT NORMAL
         4    1 R04C01                      ALPHA PROT NORMAL
         5    1 R05C01                      ALPHA PROT NORMAL
         6    1 R06C01                      ALPHA PROT NORMAL
         7    1 R07C01                      ALPHA PROT NORMAL
         8    1 R08C01                      ALPHA PROT NORMAL
         9    1 R09C01                      ALPHA PROT NORMAL
        10    1 R10C01                      ALPHA PROT NORMAL
        11    1 R11C01                      ALPHA PROT NORMAL
        12    1 R12C01                      ALPHA PROT NORMAL
        13    1 R13C01                      ALPHA PROT NORMAL
        14    1 R14C01                      ALPHA PROT NORMAL
        15    1 R15C01                      ALPHA PROT NORMAL
        16    1 R16C01                      ALPHA PROT NORMAL
        17    1 R17C01                      ALPHA PROT NORMAL
        18    1 R18C01                      ALPHA PROT NORMAL
        19    1 R19C01                      ALPHA PROT NORMAL
M A P 3 2 7 0   S C R E E N   C O M P I L E R                        PANEL TTY3270                 V2.2.0     PAGE   3

        20    1 R20C01                      ALPHA PROT NORMAL
        21    1 R21C01                      ALPHA PROT NORMAL
        22    1 R22C01                      TITLE ALPHA PROT NORMAL
        23    1 R23C01                      ALPHA UNPROT BRIGHT
        24    1 R24C01                      ALPHA PROT NORMAL


END OF MAPGEN EXECUTION - RETURN CODE IS 0000
                                               EXTERNAL SYMBOL DICTIONARY                                      PAGE    1


SYMBOL   TYPE  ID   ADDR  LENGTH LDID                                                            ASM 0201 13.22 10/02/21

TTY3270   SD  0001 000000 0008AC
         PANEL TTY3270  GENERATED BY MAP3270 V2.2.0                                                            PAGE    2


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                      2 ** GENERATED BY MAP3270 V2.2.0   ON 211002 AT 132240920                 00000100
                                      3 TTY3270  TSECT                                                          00000200
000000                                4+TTY3270  CSECT                                                          00410000
000000 0000000C                       5          DC    A(TTY3270P)                                              00000300
000004 000007F4                       6          DC    A(TTY3270M)                                              00000400
000008 00000012                       7          DC    A(TTY3270C)                                              00000500
                                      8 TTY3270  TSTPAN                                                         00000600
                                      9+**** **** GENERATING MVS 3.8J 3270 EXTENDED ATTRS ****                  00580000
00000C 07E7                          10+TTY3270P DC   AL2(TTY3270L)                                             00680000
                                     11          TWCC  RESET=YES,RSTMDT=YES                                     00000700
00000E 27                            12+         DC    AL1(39)    3270 ESCAPE                                   00430000
00000F F5                            13+         DC    AL1(245)   3270 WRITE(X'F1') OR WRITE/ERASE(X'F5')       00470000
000010 41                            14+         DC    AL1(65)    3270 WCC                                      00560000
                                     15 TTY3270C TCMD  CMD=SBA,ROW=01,COL=01                                    00000800
000011 11                            16+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
000012 4040                          17+TTY3270C DC    AL1(64,64)               FROM TSBA MACRO                 00480000
                                     18          TCMD  CMD=IC                                                   00000900
000014 13                            19+         DC   X'13'   3270 INSERT CURSOR COMMAND                        01780000
                                     20          TCMD  CMD=SBA,ROW=01,COL=01                                    00001000
000015 11                            21+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
000016 4040                          22+         DC    AL1(64,64)               FROM TSBA MACRO                 00480000
                                     23          TCMD  CMD=SF,MDT=NO,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO,        *00001100
                                                       DATA='--------------------------------------------------*00001200
                                                       -----------------------------'                           00001300
000018 1D                            24+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000019 60                            25+         DC    AL1(96)    3270 SF                                       00740000
00001A 6060606060606060              26+         DC    C'------------------------------------------------------X01540000
000022 6060606060606060                +               -------------------------'
                                     27          TCMD  CMD=SBA,ROW=02,COL=01                                    00001400
000069 11                            28+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
00006A C150                          29+         DC    AL1(193,80)              FROM TSBA MACRO                 00480000
                                     30 ***R02C01                                                               00001500
                                     31 R02C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00001600
                                                       DATA='..................................................*00001700
                                                       .............................'                           00001800
00006C 1D                            32+         DC    X'1D'   3270 SET FIELD CMD                               00630000
00006D 61                            33+         DC    AL1(97)    3270 SF                                       00740000
00006E 4B4B4B4B4B4B4B4B              34+R02C01   DC    CL79'...................................................X01500000
000076 4B4B4B4B4B4B4B4B                +               ............................'
                                     35          TCMD  CMD=SBA,ROW=03,COL=01                                    00001900
0000BD 11                            36+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
0000BE C260                          37+         DC    AL1(194,96)              FROM TSBA MACRO                 00480000
                                     38 ***R03C01                                                               00002000
                                     39 R03C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00002100
                                                       DATA='..................................................*00002200
                                                       .............................'                           00002300
0000C0 1D                            40+         DC    X'1D'   3270 SET FIELD CMD                               00630000
0000C1 61                            41+         DC    AL1(97)    3270 SF                                       00740000
0000C2 4B4B4B4B4B4B4B4B              42+R03C01   DC    CL79'...................................................X01500000
0000CA 4B4B4B4B4B4B4B4B                +               ............................'
                                     43          TCMD  CMD=SBA,ROW=04,COL=01                                    00002400
000111 11                            44+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
000112 C3F0                          45+         DC    AL1(195,240)             FROM TSBA MACRO                 00480000
                                     46 ***R04C01                                                               00002500
                                     47 R04C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00002600
         PANEL TTY3270  GENERATED BY MAP3270 V2.2.0                                                            PAGE    3


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                                       DATA='..................................................*00002700
                                                       .............................'                           00002800
000114 1D                            48+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000115 61                            49+         DC    AL1(97)    3270 SF                                       00740000
000116 4B4B4B4B4B4B4B4B              50+R04C01   DC    CL79'...................................................X01500000
00011E 4B4B4B4B4B4B4B4B                +               ............................'
                                     51          TCMD  CMD=SBA,ROW=05,COL=01                                    00002900
000165 11                            52+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
000166 C540                          53+         DC    AL1(197,64)              FROM TSBA MACRO                 00480000
                                     54 ***R05C01                                                               00003000
                                     55 R05C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00003100
                                                       DATA='..................................................*00003200
                                                       .............................'                           00003300
000168 1D                            56+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000169 61                            57+         DC    AL1(97)    3270 SF                                       00740000
00016A 4B4B4B4B4B4B4B4B              58+R05C01   DC    CL79'...................................................X01500000
000172 4B4B4B4B4B4B4B4B                +               ............................'
                                     59          TCMD  CMD=SBA,ROW=06,COL=01                                    00003400
0001B9 11                            60+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
0001BA C650                          61+         DC    AL1(198,80)              FROM TSBA MACRO                 00480000
                                     62 ***R06C01                                                               00003500
                                     63 R06C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00003600
                                                       DATA='..................................................*00003700
                                                       .............................'                           00003800
0001BC 1D                            64+         DC    X'1D'   3270 SET FIELD CMD                               00630000
0001BD 61                            65+         DC    AL1(97)    3270 SF                                       00740000
0001BE 4B4B4B4B4B4B4B4B              66+R06C01   DC    CL79'...................................................X01500000
0001C6 4B4B4B4B4B4B4B4B                +               ............................'
                                     67          TCMD  CMD=SBA,ROW=07,COL=01                                    00003900
00020D 11                            68+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
00020E C760                          69+         DC    AL1(199,96)              FROM TSBA MACRO                 00480000
                                     70 ***R07C01                                                               00004000
                                     71 R07C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00004100
                                                       DATA='..................................................*00004200
                                                       .............................'                           00004300
000210 1D                            72+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000211 61                            73+         DC    AL1(97)    3270 SF                                       00740000
000212 4B4B4B4B4B4B4B4B              74+R07C01   DC    CL79'...................................................X01500000
00021A 4B4B4B4B4B4B4B4B                +               ............................'
                                     75          TCMD  CMD=SBA,ROW=08,COL=01                                    00004400
000261 11                            76+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
000262 C8F0                          77+         DC    AL1(200,240)             FROM TSBA MACRO                 00480000
                                     78 ***R08C01                                                               00004500
                                     79 R08C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00004600
                                                       DATA='..................................................*00004700
                                                       .............................'                           00004800
000264 1D                            80+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000265 61                            81+         DC    AL1(97)    3270 SF                                       00740000
000266 4B4B4B4B4B4B4B4B              82+R08C01   DC    CL79'...................................................X01500000
00026E 4B4B4B4B4B4B4B4B                +               ............................'
                                     83          TCMD  CMD=SBA,ROW=09,COL=01                                    00004900
0002B5 11                            84+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
0002B6 4A40                          85+         DC    AL1(74,64)               FROM TSBA MACRO                 00480000
                                     86 ***R09C01                                                               00005000
                                     87 R09C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00005100
         PANEL TTY3270  GENERATED BY MAP3270 V2.2.0                                                            PAGE    4


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                                       DATA='..................................................*00005200
                                                       .............................'                           00005300
0002B8 1D                            88+         DC    X'1D'   3270 SET FIELD CMD                               00630000
0002B9 61                            89+         DC    AL1(97)    3270 SF                                       00740000
0002BA 4B4B4B4B4B4B4B4B              90+R09C01   DC    CL79'...................................................X01500000
0002C2 4B4B4B4B4B4B4B4B                +               ............................'
                                     91          TCMD  CMD=SBA,ROW=10,COL=01                                    00005400
000309 11                            92+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
00030A 4B50                          93+         DC    AL1(75,80)               FROM TSBA MACRO                 00480000
                                     94 ***R10C01                                                               00005500
                                     95 R10C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00005600
                                                       DATA='..................................................*00005700
                                                       .............................'                           00005800
00030C 1D                            96+         DC    X'1D'   3270 SET FIELD CMD                               00630000
00030D 61                            97+         DC    AL1(97)    3270 SF                                       00740000
00030E 4B4B4B4B4B4B4B4B              98+R10C01   DC    CL79'...................................................X01500000
000316 4B4B4B4B4B4B4B4B                +               ............................'
                                     99          TCMD  CMD=SBA,ROW=11,COL=01                                    00005900
00035D 11                           100+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
00035E 4C60                         101+         DC    AL1(76,96)               FROM TSBA MACRO                 00480000
                                    102 ***R11C01                                                               00006000
                                    103 R11C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00006100
                                                       DATA='..................................................*00006200
                                                       .............................'                           00006300
000360 1D                           104+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000361 61                           105+         DC    AL1(97)    3270 SF                                       00740000
000362 4B4B4B4B4B4B4B4B             106+R11C01   DC    CL79'...................................................X01500000
00036A 4B4B4B4B4B4B4B4B                +               ............................'
                                    107          TCMD  CMD=SBA,ROW=12,COL=01                                    00006400
0003B1 11                           108+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
0003B2 4DF0                         109+         DC    AL1(77,240)              FROM TSBA MACRO                 00480000
                                    110 ***R12C01                                                               00006500
                                    111 R12C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00006600
                                                       DATA='..................................................*00006700
                                                       .............................'                           00006800
0003B4 1D                           112+         DC    X'1D'   3270 SET FIELD CMD                               00630000
0003B5 61                           113+         DC    AL1(97)    3270 SF                                       00740000
0003B6 4B4B4B4B4B4B4B4B             114+R12C01   DC    CL79'...................................................X01500000
0003BE 4B4B4B4B4B4B4B4B                +               ............................'
                                    115          TCMD  CMD=SBA,ROW=13,COL=01                                    00006900
000405 11                           116+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
000406 4F40                         117+         DC    AL1(79,64)               FROM TSBA MACRO                 00480000
                                    118 ***R13C01                                                               00007000
                                    119 R13C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00007100
                                                       DATA='..................................................*00007200
                                                       .............................'                           00007300
000408 1D                           120+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000409 61                           121+         DC    AL1(97)    3270 SF                                       00740000
00040A 4B4B4B4B4B4B4B4B             122+R13C01   DC    CL79'...................................................X01500000
000412 4B4B4B4B4B4B4B4B                +               ............................'
                                    123          TCMD  CMD=SBA,ROW=14,COL=01                                    00007400
000459 11                           124+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
00045A 5050                         125+         DC    AL1(80,80)               FROM TSBA MACRO                 00480000
                                    126 ***R14C01                                                               00007500
                                    127 R14C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00007600
         PANEL TTY3270  GENERATED BY MAP3270 V2.2.0                                                            PAGE    5


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                                       DATA='..................................................*00007700
                                                       .............................'                           00007800
00045C 1D                           128+         DC    X'1D'   3270 SET FIELD CMD                               00630000
00045D 61                           129+         DC    AL1(97)    3270 SF                                       00740000
00045E 4B4B4B4B4B4B4B4B             130+R14C01   DC    CL79'...................................................X01500000
000466 4B4B4B4B4B4B4B4B                +               ............................'
                                    131          TCMD  CMD=SBA,ROW=15,COL=01                                    00007900
0004AD 11                           132+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
0004AE D160                         133+         DC    AL1(209,96)              FROM TSBA MACRO                 00480000
                                    134 ***R15C01                                                               00008000
                                    135 R15C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00008100
                                                       DATA='..................................................*00008200
                                                       .............................'                           00008300
0004B0 1D                           136+         DC    X'1D'   3270 SET FIELD CMD                               00630000
0004B1 61                           137+         DC    AL1(97)    3270 SF                                       00740000
0004B2 4B4B4B4B4B4B4B4B             138+R15C01   DC    CL79'...................................................X01500000
0004BA 4B4B4B4B4B4B4B4B                +               ............................'
                                    139          TCMD  CMD=SBA,ROW=16,COL=01                                    00008400
000501 11                           140+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
000502 D2F0                         141+         DC    AL1(210,240)             FROM TSBA MACRO                 00480000
                                    142 ***R16C01                                                               00008500
                                    143 R16C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00008600
                                                       DATA='..................................................*00008700
                                                       .............................'                           00008800
000504 1D                           144+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000505 61                           145+         DC    AL1(97)    3270 SF                                       00740000
000506 4B4B4B4B4B4B4B4B             146+R16C01   DC    CL79'...................................................X01500000
00050E 4B4B4B4B4B4B4B4B                +               ............................'
                                    147          TCMD  CMD=SBA,ROW=17,COL=01                                    00008900
000555 11                           148+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
000556 D440                         149+         DC    AL1(212,64)              FROM TSBA MACRO                 00480000
                                    150 ***R17C01                                                               00009000
                                    151 R17C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00009100
                                                       DATA='..................................................*00009200
                                                       .............................'                           00009300
000558 1D                           152+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000559 61                           153+         DC    AL1(97)    3270 SF                                       00740000
00055A 4B4B4B4B4B4B4B4B             154+R17C01   DC    CL79'...................................................X01500000
000562 4B4B4B4B4B4B4B4B                +               ............................'
                                    155          TCMD  CMD=SBA,ROW=18,COL=01                                    00009400
0005A9 11                           156+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
0005AA D550                         157+         DC    AL1(213,80)              FROM TSBA MACRO                 00480000
                                    158 ***R18C01                                                               00009500
                                    159 R18C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00009600
                                                       DATA='..................................................*00009700
                                                       .............................'                           00009800
0005AC 1D                           160+         DC    X'1D'   3270 SET FIELD CMD                               00630000
0005AD 61                           161+         DC    AL1(97)    3270 SF                                       00740000
0005AE 4B4B4B4B4B4B4B4B             162+R18C01   DC    CL79'...................................................X01500000
0005B6 4B4B4B4B4B4B4B4B                +               ............................'
                                    163          TCMD  CMD=SBA,ROW=19,COL=01                                    00009900
0005FD 11                           164+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
0005FE D660                         165+         DC    AL1(214,96)              FROM TSBA MACRO                 00480000
                                    166 ***R19C01                                                               00010000
                                    167 R19C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00010100
         PANEL TTY3270  GENERATED BY MAP3270 V2.2.0                                                            PAGE    6


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                                       DATA='..................................................*00010200
                                                       .............................'                           00010300
000600 1D                           168+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000601 61                           169+         DC    AL1(97)    3270 SF                                       00740000
000602 4B4B4B4B4B4B4B4B             170+R19C01   DC    CL79'...................................................X01500000
00060A 4B4B4B4B4B4B4B4B                +               ............................'
                                    171          TCMD  CMD=SBA,ROW=20,COL=01                                    00010400
000651 11                           172+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
000652 D7F0                         173+         DC    AL1(215,240)             FROM TSBA MACRO                 00480000
                                    174 ***R20C01                                                               00010500
                                    175 R20C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00010600
                                                       DATA='..................................................*00010700
                                                       .............................'                           00010800
000654 1D                           176+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000655 61                           177+         DC    AL1(97)    3270 SF                                       00740000
000656 4B4B4B4B4B4B4B4B             178+R20C01   DC    CL79'...................................................X01500000
00065E 4B4B4B4B4B4B4B4B                +               ............................'
                                    179          TCMD  CMD=SBA,ROW=21,COL=01                                    00010900
0006A5 11                           180+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
0006A6 D940                         181+         DC    AL1(217,64)              FROM TSBA MACRO                 00480000
                                    182 ***R21C01                                                               00011000
                                    183 R21C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00011100
                                                       DATA='..................................................*00011200
                                                       .............................'                           00011300
0006A8 1D                           184+         DC    X'1D'   3270 SET FIELD CMD                               00630000
0006A9 61                           185+         DC    AL1(97)    3270 SF                                       00740000
0006AA 4B4B4B4B4B4B4B4B             186+R21C01   DC    CL79'...................................................X01500000
0006B2 4B4B4B4B4B4B4B4B                +               ............................'
                                    187          TCMD  CMD=SBA,ROW=22,COL=01                                    00011400
0006F9 11                           188+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
0006FA 5A50                         189+         DC    AL1(90,80)               FROM TSBA MACRO                 00480000
                                    190          TCMD  CMD=SF,MDT=NO,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO,        *00011500
                                                       DATA='--------------------------------------------------*00011600
                                                       -----------------------------'                           00011700
0006FC 1D                           191+         DC    X'1D'   3270 SET FIELD CMD                               00630000
0006FD 60                           192+         DC    AL1(96)    3270 SF                                       00740000
0006FE 6060606060606060             193+         DC    C'------------------------------------------------------X01540000
000706 6060606060606060                +               -------------------------'
                                    194          TCMD  CMD=SBA,ROW=23,COL=01                                    00011800
00074D 11                           195+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
00074E 5B60                         196+         DC    AL1(91,96)               FROM TSBA MACRO                 00480000
                                    197 ***R23C01                                                               00011900
                                    198 R23C01   TCMD  CMD=SF,MDT=YES,LN=77,PROT=NO,BRIGHT=YES,NUM=NO,STOP=NO, *00012000
                                                       DATA='..................................................*00012100
                                                       ...........................'                             00012200
000750 1D                           199+         DC    X'1D'   3270 SET FIELD CMD                               00630000
000751 C9                           200+         DC    AL1(201)   3270 SF                                       00740000
000752 4B4B4B4B4B4B4B4B             201+R23C01   DC    CL77'...................................................X01500000
00075A 4B4B4B4B4B4B4B4B                +               ..........................'
                                    202          TCMD  CMD=SBA,ROW=24,COL=01                                    00012300
00079F 11                           203+         DC    X'11'   3270 SET BUFFER ADDRESS                          01700000
0007A0 5CF0                         204+         DC    AL1(92,240)              FROM TSBA MACRO                 00480000
                                    205 ***R24C01                                                               00012400
                                    206 R24C01   TCMD  CMD=SF,MDT=YES,LN=79,PROT=YES,BRIGHT=NO,NUM=NO,STOP=NO, *00012500
                                                       DATA='..................................................*00012600
         PANEL TTY3270  GENERATED BY MAP3270 V2.2.0                                                            PAGE    7


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                                       .............................'                           00012700
0007A2 1D                           207+         DC    X'1D'   3270 SET FIELD CMD                               00630000
0007A3 61                           208+         DC    AL1(97)    3270 SF                                       00740000
0007A4 4B4B4B4B4B4B4B4B             209+R24C01   DC    CL79'...................................................X01500000
0007AC 4B4B4B4B4B4B4B4B                +               ............................'
                                    210          TENDPAN                                                        00012800
                            007E7   211+TTY3270L EQU  *-TTY3270P                                                00360000
                                    212 TTY3270M TINPST                                                         00012900
0007F4                              213+TTY3270M DS   0F                                                        00340000
                                    214 R02C01   TINPMAP 02,01,79              R02C01                           00013000
0007F4                              215+         CNOP  0,4                                                      00420000
0007F4 C1D1                         216+         DC    AL1(193,209)             FROM TSBA MACRO                 00480000
0007F6 004F                         217+         DC   AL2(79)                                                   00440000
0007F8 0000006E                     218+         DC   AL4(R02C01)                                               00450000
                                    219 R03C01   TINPMAP 03,01,79              R03C01                           00013100
0007FC                              220+         CNOP  0,4                                                      00420000
0007FC C261                         221+         DC    AL1(194,97)              FROM TSBA MACRO                 00480000
0007FE 004F                         222+         DC   AL2(79)                                                   00440000
000800 000000C2                     223+         DC   AL4(R03C01)                                               00450000
                                    224 R04C01   TINPMAP 04,01,79              R04C01                           00013200
000804                              225+         CNOP  0,4                                                      00420000
000804 C3F1                         226+         DC    AL1(195,241)             FROM TSBA MACRO                 00480000
000806 004F                         227+         DC   AL2(79)                                                   00440000
000808 00000116                     228+         DC   AL4(R04C01)                                               00450000
                                    229 R05C01   TINPMAP 05,01,79              R05C01                           00013300
00080C                              230+         CNOP  0,4                                                      00420000
00080C C5C1                         231+         DC    AL1(197,193)             FROM TSBA MACRO                 00480000
00080E 004F                         232+         DC   AL2(79)                                                   00440000
000810 0000016A                     233+         DC   AL4(R05C01)                                               00450000
                                    234 R06C01   TINPMAP 06,01,79              R06C01                           00013400
000814                              235+         CNOP  0,4                                                      00420000
000814 C6D1                         236+         DC    AL1(198,209)             FROM TSBA MACRO                 00480000
000816 004F                         237+         DC   AL2(79)                                                   00440000
000818 000001BE                     238+         DC   AL4(R06C01)                                               00450000
                                    239 R07C01   TINPMAP 07,01,79              R07C01                           00013500
00081C                              240+         CNOP  0,4                                                      00420000
00081C C761                         241+         DC    AL1(199,97)              FROM TSBA MACRO                 00480000
00081E 004F                         242+         DC   AL2(79)                                                   00440000
000820 00000212                     243+         DC   AL4(R07C01)                                               00450000
                                    244 R08C01   TINPMAP 08,01,79              R08C01                           00013600
000824                              245+         CNOP  0,4                                                      00420000
000824 C8F1                         246+         DC    AL1(200,241)             FROM TSBA MACRO                 00480000
000826 004F                         247+         DC   AL2(79)                                                   00440000
000828 00000266                     248+         DC   AL4(R08C01)                                               00450000
                                    249 R09C01   TINPMAP 09,01,79              R09C01                           00013700
00082C                              250+         CNOP  0,4                                                      00420000
00082C 4AC1                         251+         DC    AL1(74,193)              FROM TSBA MACRO                 00480000
00082E 004F                         252+         DC   AL2(79)                                                   00440000
000830 000002BA                     253+         DC   AL4(R09C01)                                               00450000
                                    254 R10C01   TINPMAP 10,01,79              R10C01                           00013800
000834                              255+         CNOP  0,4                                                      00420000
000834 4BD1                         256+         DC    AL1(75,209)              FROM TSBA MACRO                 00480000
000836 004F                         257+         DC   AL2(79)                                                   00440000
000838 0000030E                     258+         DC   AL4(R10C01)                                               00450000
                                    259 R11C01   TINPMAP 11,01,79              R11C01                           00013900
         PANEL TTY3270  GENERATED BY MAP3270 V2.2.0                                                            PAGE    8


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

00083C                              260+         CNOP  0,4                                                      00420000
00083C 4C61                         261+         DC    AL1(76,97)               FROM TSBA MACRO                 00480000
00083E 004F                         262+         DC   AL2(79)                                                   00440000
000840 00000362                     263+         DC   AL4(R11C01)                                               00450000
                                    264 R12C01   TINPMAP 12,01,79              R12C01                           00014000
000844                              265+         CNOP  0,4                                                      00420000
000844 4DF1                         266+         DC    AL1(77,241)              FROM TSBA MACRO                 00480000
000846 004F                         267+         DC   AL2(79)                                                   00440000
000848 000003B6                     268+         DC   AL4(R12C01)                                               00450000
                                    269 R13C01   TINPMAP 13,01,79              R13C01                           00014100
00084C                              270+         CNOP  0,4                                                      00420000
00084C 4FC1                         271+         DC    AL1(79,193)              FROM TSBA MACRO                 00480000
00084E 004F                         272+         DC   AL2(79)                                                   00440000
000850 0000040A                     273+         DC   AL4(R13C01)                                               00450000
                                    274 R14C01   TINPMAP 14,01,79              R14C01                           00014200
000854                              275+         CNOP  0,4                                                      00420000
000854 50D1                         276+         DC    AL1(80,209)              FROM TSBA MACRO                 00480000
000856 004F                         277+         DC   AL2(79)                                                   00440000
000858 0000045E                     278+         DC   AL4(R14C01)                                               00450000
                                    279 R15C01   TINPMAP 15,01,79              R15C01                           00014300
00085C                              280+         CNOP  0,4                                                      00420000
00085C D161                         281+         DC    AL1(209,97)              FROM TSBA MACRO                 00480000
00085E 004F                         282+         DC   AL2(79)                                                   00440000
000860 000004B2                     283+         DC   AL4(R15C01)                                               00450000
                                    284 R16C01   TINPMAP 16,01,79              R16C01                           00014400
000864                              285+         CNOP  0,4                                                      00420000
000864 D2F1                         286+         DC    AL1(210,241)             FROM TSBA MACRO                 00480000
000866 004F                         287+         DC   AL2(79)                                                   00440000
000868 00000506                     288+         DC   AL4(R16C01)                                               00450000
                                    289 R17C01   TINPMAP 17,01,79              R17C01                           00014500
00086C                              290+         CNOP  0,4                                                      00420000
00086C D4C1                         291+         DC    AL1(212,193)             FROM TSBA MACRO                 00480000
00086E 004F                         292+         DC   AL2(79)                                                   00440000
000870 0000055A                     293+         DC   AL4(R17C01)                                               00450000
                                    294 R18C01   TINPMAP 18,01,79              R18C01                           00014600
000874                              295+         CNOP  0,4                                                      00420000
000874 D5D1                         296+         DC    AL1(213,209)             FROM TSBA MACRO                 00480000
000876 004F                         297+         DC   AL2(79)                                                   00440000
000878 000005AE                     298+         DC   AL4(R18C01)                                               00450000
                                    299 R19C01   TINPMAP 19,01,79              R19C01                           00014700
00087C                              300+         CNOP  0,4                                                      00420000
00087C D661                         301+         DC    AL1(214,97)              FROM TSBA MACRO                 00480000
00087E 004F                         302+         DC   AL2(79)                                                   00440000
000880 00000602                     303+         DC   AL4(R19C01)                                               00450000
                                    304 R20C01   TINPMAP 20,01,79              R20C01                           00014800
000884                              305+         CNOP  0,4                                                      00420000
000884 D7F1                         306+         DC    AL1(215,241)             FROM TSBA MACRO                 00480000
000886 004F                         307+         DC   AL2(79)                                                   00440000
000888 00000656                     308+         DC   AL4(R20C01)                                               00450000
                                    309 R21C01   TINPMAP 21,01,79              R21C01                           00014900
00088C                              310+         CNOP  0,4                                                      00420000
00088C D9C1                         311+         DC    AL1(217,193)             FROM TSBA MACRO                 00480000
00088E 004F                         312+         DC   AL2(79)                                                   00440000
000890 000006AA                     313+         DC   AL4(R21C01)                                               00450000
                                    314 R23C01   TINPMAP 23,01,77              R23C01                           00015000
         PANEL TTY3270  GENERATED BY MAP3270 V2.2.0                                                            PAGE    9


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

000894                              315+         CNOP  0,4                                                      00420000
000894 5B61                         316+         DC    AL1(91,97)               FROM TSBA MACRO                 00480000
000896 004D                         317+         DC   AL2(77)                                                   00440000
000898 00000752                     318+         DC   AL4(R23C01)                                               00450000
                                    319 R24C01   TINPMAP 24,01,79              R24C01                           00015100
00089C                              320+         CNOP  0,4                                                      00420000
00089C 5CF1                         321+         DC    AL1(92,241)              FROM TSBA MACRO                 00480000
00089E 004F                         322+         DC   AL2(79)                                                   00440000
0008A0 000007A4                     323+         DC   AL4(R24C01)                                               00450000
                                    324          TINPEND                                                        00015200
0008A4                              325+         CNOP  0,4                                                      00340000
0008A4 00000000                     326+         DC   2AL2(0)                                                   00350000
0008A8 00000000                     327+         DC   A(0)                                                      00360000
                                    328 ** GENERATED BY MAP3270 V2.2.0   ON 211002 AT 132240920                 00015300
                                    329          END                                                            00015400
                                                  RELOCATION DICTIONARY                                        PAGE   10


POS.ID   REL.ID   FLAGS   ADDRESS                                                                ASM 0201 13.22 10/02/21

 0001     0001      0C     000000
 0001     0001      0C     000004
 0001     0001      0C     000008
 0001     0001      0C     0007F8
 0001     0001      0C     000800
 0001     0001      0C     000808
 0001     0001      0C     000810
 0001     0001      0C     000818
 0001     0001      0C     000820
 0001     0001      0C     000828
 0001     0001      0C     000830
 0001     0001      0C     000838
 0001     0001      0C     000840
 0001     0001      0C     000848
 0001     0001      0C     000850
 0001     0001      0C     000858
 0001     0001      0C     000860
 0001     0001      0C     000868
 0001     0001      0C     000870
 0001     0001      0C     000878
 0001     0001      0C     000880
 0001     0001      0C     000888
 0001     0001      0C     000890
 0001     0001      0C     000898
 0001     0001      0C     0008A0
                                                  CROSS-REFERENCE                                              PAGE   11


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

R02C01   00079 0000006E 00034  00218
R03C01   00079 000000C2 00042  00223
R04C01   00079 00000116 00050  00228
R05C01   00079 0000016A 00058  00233
R06C01   00079 000001BE 00066  00238
R07C01   00079 00000212 00074  00243
R08C01   00079 00000266 00082  00248
R09C01   00079 000002BA 00090  00253
R10C01   00079 0000030E 00098  00258
R11C01   00079 00000362 00106  00263
R12C01   00079 000003B6 00114  00268
R13C01   00079 0000040A 00122  00273
R14C01   00079 0000045E 00130  00278
R15C01   00079 000004B2 00138  00283
R16C01   00079 00000506 00146  00288
R17C01   00079 0000055A 00154  00293
R18C01   00079 000005AE 00162  00298
R19C01   00079 00000602 00170  00303
R20C01   00079 00000656 00178  00308
R21C01   00079 000006AA 00186  00313
R23C01   00077 00000752 00201  00318
R24C01   00079 000007A4 00209  00323
TTY3270C 00001 00000012 00017  00007
TTY3270L 00001 000007E7 00211  00010
TTY3270M 00004 000007F4 00213  00006
TTY3270P 00002 0000000C 00010  00005 00211
                                                  ASSEMBLER DIAGNOSTICS AND STATISTICS                         PAGE   12


                                                                                                 ASM 0201 13.22 10/02/21

NO STATEMENTS FLAGGED IN THIS ASSEMBLY
HIGHEST SEVERITY WAS    0
OPTIONS FOR THIS ASSEMBLY
  ALIGN, ALOGIC, BUFSIZE(STD), NODECK, ESD, FLAG(0), LINECOUNT(55), LIST, NOMCALL, YFLAG, WORKSIZE(2097152)
  NOMLOGIC, NONUMBER, OBJECT, NORENT, RLD, NOSTMT, NOLIBMAC, NOTERMINAL, NOTEST, XREF(SHORT)
  SYSPARM()
WORK FILE BUFFER SIZE/NUMBER = 6654/ 1
TOTAL RECORDS READ FROM SYSTEM INPUT        155
TOTAL RECORDS READ FROM SYSTEM LIBRARY      706
TOTAL RECORDS PUNCHED                        45
TOTAL RECORDS PRINTED                       488

 F64-LEVEL LINKAGE EDITOR OPTIONS SPECIFIED XREF,LET,LIST
          DEFAULT OPTION(S) USED -  SIZE=(98304,55296)



                                                CROSS REFERENCE TABLE


  CONTROL SECTION                       ENTRY

    NAME    ORIGIN  LENGTH                NAME   LOCATION     NAME   LOCATION     NAME   LOCATION     NAME   LOCATION
  TTY3270       00     8AC




  LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION             LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION

 ENTRY ADDRESS       00

 TOTAL LENGTH       8B0
****TTY3270   NOW REPLACED IN DATA SET
AUTHORIZATION CODE IS         0.
                                               EXTERNAL SYMBOL DICTIONARY                                      PAGE    1


SYMBOL   TYPE  ID   ADDR  LENGTH LDID                                                            ASM 0201 13.22 10/02/21

T3270IO   SD  0001 000000 000CB9
                                                                                                               PAGE    2


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                      1 T3270IO  T3270 MODE=NORMAL                                              00700000
                                      2+**********************************************************************  00060000
                                      3+**                                                                  **  00070000
                                      4+** MAP3270 V2.2.0 - SOFTWARE PACKAGE TO IMPLEMENT FULL SCREEN       **  00080000
                                      5+** IO FOR IBM 3270 CLASS TERMINALS.                                 **  00090000
                                      6+**                                                                  **  00100000
                                      7+**             COPYRIGHT (C) 2021  EDWARD G LISS                    **  00110000
                                      8+**                     EGLISS4024@GMAIL.COM                         **  00120000
                                      9+**                                                                  **  00130000
                                     10+** THIS PROGRAM IS FREE SOFTWARE: YOU CAN REDISTRIBUTE IT           **  00140000
                                     11+** AND/OR MODIFY IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC       **  00150000
                                     12+** LICENSE AS PUBLISHED BY THE FREE SOFTWARE FOUNDATION,            **  00160000
                                     13+** EITHER VERSION 3 OF THE LICENSE, OR ANY LATER VERSION.           **  00170000
                                     14+**                                                                  **  00180000
                                     15+** THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE          **  00190000
                                     16+** USEFUL, BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED       **  00200000
                                     17+** WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR          **  00210000
                                     18+** PURPOSE.  SEE THE GNU GENERAL PUBLIC LICENSE FOR MORE            **  00220000
                                     19+** DETAILS.                                                         **  00230000
                                     20+**                                                                  **  00240000
                                     21+** PLEASE SEE HTTPS://WWW.GNU.ORG/LICENSES/ FOR A COPY OF THE       **  00250000
                                     22+** GNU GENERAL PUBLIC LICENSE.                                      **  00260000
                                     23+**                                                                  **  00270000
                                     24+**********************************************************************  00350000
                                     25+**NAME   ESTART TYPE=START,DESC='3270 FULLSCREEN IO BUFLEN=&BUFLEN',    00890000
                                     26+**             VER='2.0.0',REGS=YES,BASE=R12                            00900000
000000                               27+T3270IO  START                                                          00000019
                                     28+*                                                                       00000027
000000 47FF 008C      0008C          29+ID10002    B     ID40002(15)           BRANCH AROUND IDENT CONSTANTS    00000039
000004 87                            30+         DC    AL1(ID30002-ID20002)                                     00000041
000005 E3F3F2F7F0C9D640              31+ID20002    DC    CL8'T3270IO'                                           00000042
00000D F24BF04BF0                    32+         DC    C'2.0.0'                                                 00000043
000012 40F1F061F0F261F2              33+         DC    C' 10/02/21 13.22 - '                                    00000044
000024 F3F2F7F040C6E4D3              34+         DC    C'3270 FULLSCREEN IO BUFLEN=2048'                        00000045
000044                               35+         DS    0F                                                       00000046
                            00044    36+IDS0002    EQU   *-ID10002                                              00000047
000044                               37+         DS    18F                                                      00000048
00008C                               38+ID30002    DS    0H                                                     00000049
                            00000    39+R0       EQU   0                                                        00000007
                            00001    40+R1       EQU   1                                                        00000008
                            00002    41+R2       EQU   2                                                        00000009
                            00003    42+R3       EQU   3                                                        00000010
                            00004    43+R4       EQU   4                                                        00000011
                            00005    44+R5       EQU   5                                                        00000012
                            00006    45+R6       EQU   6                                                        00000013
                            00007    46+R7       EQU   7                                                        00000014
                            00008    47+R8       EQU   8                                                        00000015
                            00009    48+R9       EQU   9                                                        00000016
                            0000A    49+R10      EQU   10                                                       00000017
                            0000B    50+R11      EQU   11                                                       00000018
                            0000C    51+R12      EQU   12                                                       00000019
                            0000D    52+R13      EQU   13                                                       00000020
                            0000E    53+R14      EQU   14                                                       00000021
                            0000F    54+R15      EQU   15                                                       00000022
                            0008C    55+ID40002    EQU   *-ID10002                                              00000054
                                                                                                               PAGE    3


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                     56+*                                                                       00000055
00008C 90EC D00C      0000C          57+         STM   14,12,12(13)                                             00000056
                                     58+*                                                                       00000057
000090 185D                          59+         LR    5,13                COPY CALLER'S SAVEAREA ADDR          00000058
000092 41DF 0044      00044          60+         LA    13,IDS0002(15)      ESTABLISH MY SAVEAREA                00000059
000096 5050 D004      00004          61+         ST    5,4(,13)            BACK CHAIN SAVE AREAS                00000060
00009A 50D0 5008      00008          62+         ST    13,8(,5)            FORWARD CHAIN SAVE AREAS             00000061
00009E 05C0                          63+         BALR  R12,0               ESTABLISH BASE REG VALUE             00000063
                            000A0    64+         USING *,R12                                                    00000064
                                     65+*                                                                       00930000
                                     66+*  GET ADDRESS OF PARM LIST.  PARM1 IS THE IOCB, PARM2 IS               00940000
                                     67+*      PANEL INTERFACE.                                                 00950000
                                     68+*                                                                       00960000
0000A0 5870 1000      00000          69+         L     R7,0(0,R1)              GET IOCB ADDRESS                 00970000
0000A4 D203 C3BC 1004 0045C 00004    70+         MVC   USERPARM,4(R1)          SAVE INTERFACE AREA              00980000
0000AA 947F C3BC      0045C          71+         NI    USERPARM,X'7F'          TURN OF HIGH ORDER BIT           00990000
                            00000    72+         USING IOCB,R7                 ESTABLISH BR FOR IOCB            01050000
0000AE D201 7004 C3E8 00004 00488    73+         MVC   IOCBRC,=H'0'            SET RETURN CODE TO ZERO          01060000
0000B4 D503 7000 C3D0 00000 00470    74+         CLC   IOCBFUNC,=C'STRT'       IS IT A STRT?                    01070000
0000BA 4770 C06A      0010A          75+         BNE   NOTSTRT                                                  01080000
0000BE 5820 7008      00008          76+         L     R2,IOCBADR             IOCBADR MUST BE ZEROS FOR STRT    01090000
0000C2 1222                          77+         LTR   R2,R2                                                    01100000
0000C4 4780 C032      000D2          78+         BZ    STRTOK                                                   01110000
                                     79+**       WTO   'MAP3270-&NAME INVALID STRT',ROUTCDE=11                  01120000
                                     80+**       ABEND &UCODE,,,USER                                            01130000
0000C8 D201 7004 C3EA 00004 0048A    81+         MVC   IOCBRC,=H'8'            SET RC TO 8 AND EXIT             01140000
0000CE 47F0 C35E      003FE          82+         B     LEAVE                                                    01150000
                            000D2    83+STRTOK   EQU   *                                                        01160000
                                     84+**       STFSMODE ON,INITIAL=YES                                        01170000
0000D2 4110 00C0      000C0          85+         LA    1,128+64                 FLAGS FOR MODE/INITIAL CALL     01400000
0000D6 8910 0018      00018          86+         SLL   1,24                     SHIFT TO HIGH ORDER BYTE        01450000
0000DA 4100 0012      00012          87+         LA    0,18                     LOAD ENTRY CODE                 01700000
0000DE 8900 0018      00018          88+         SLL   0,24                     SHIFT TO HIGH ORDER BYTE        01750000
0000E2 0A5E                          89+         SVC   94                       TERMINAL CONTROL MACRO SVC      01800000
                                     90+**       STTMPMD ON,KEYS=ALL                                            01190000
0000E4 4110 00C0      000C0          91+         LA    1,128+64                 SET PARM FLAGS                  01800001
0000E8 8910 0018      00018          92+         SLL   1,24                     SHIFT TO HIGH ORDER BYTE        01850001
0000EC 4100 0014      00014          93+         LA    0,20                     LOAD ENTRY CODE                 01900001
0000F0 8900 0018      00018          94+         SLL   0,24                     SHIFT TO HIGH ORDER BYTE        01950001
0000F4 0A5E                          95+         SVC   94                       TERMINAL CONTROL MACRO SVC      02000001
0000F6 4120 C419      004B9          96+         LA    R2,INBUF                COPY ADDRESS OF                  01210000
0000FA 5020 7008      00008          97+         ST    R2,IOCBADR                INBUF TO                       01220000
0000FE 4120 0800      00800          98+         LA    R2,INBUFLN                   CONTROL                     01230000
000102 4020 7006      00006          99+         STH   R2,IOCBLEN                     BLOCK                     01240000
000106 47F0 C35E      003FE         100+         B     LEAVE                                                    01250000
                            0010A   101+NOTSTRT  EQU   *                                                        01260000
00010A D503 7000 C3D4 00000 00474   102+         CLC   IOCBFUNC,=C'END '                                        01270000
000110 4770 C096      00136         103+         BNE   NOTEND                                                   01280000
000114 5820 7008      00008         104+         L     R2,IOCBADR             IOCBADR MUST BE NON ZERO FOR END  01290000
000118 1222                         105+         LTR   R2,R2                                                    01300000
00011A 4770 C088      00128         106+         BNZ   ENDOK                                                    01310000
                                    107+**       WTO   'MAP3270-&NAME INVALID END',ROUTCDE=11                   01320000
                                    108+**       ABEND &UCODE,,,USER                                            01330000
00011E D201 7004 C3EC 00004 0048C   109+         MVC   IOCBRC,=H'12'            SET RC TO 12 AND EXIT           01340000
000124 47F0 C35E      003FE         110+         B     LEAVE                                                    01350000
                                                                                                               PAGE    4


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                            00128   111+ENDOK    EQU   *                                                        01360000
000128 9200 7000      00000         112+         MVI   IOCB,X'00'                                               01370000
00012C D21D 7001 7000 00001 00000   113+         MVC   IOCB+1(IOCBLN-2),IOCB                                    01380000
000132 47F0 C324      003C4         114+         B     EXIT                                                     01390000
                            00136   115+NOTEND   EQU   *                                                        01400000
000136 D503 7000 C3D8 00000 00478   116+         CLC   IOCBFUNC,=C'PUT '                                        01410000
00013C 4780 C0BE      0015E         117+         BE    FUNCOK                                                   01420000
000140 D503 7000 C3DC 00000 0047C   118+         CLC   IOCBFUNC,=C'IO  '                                        01430000
000146 4780 C0BE      0015E         119+         BE    FUNCOK                                                   01440000
00014A D503 7000 C3E0 00000 00480   120+         CLC   IOCBFUNC,=C'PG  '                                        01450000
000150 4780 C0BE      0015E         121+         BE    FUNCOK                                                   01460000
000154 D201 7004 C3EE 00004 0048E   122+         MVC   IOCBRC,=H'4'       SET RC TO 4 - INVALID FUNCTION        01470000
00015A 47F0 C35E      003FE         123+         B     LEAVE                                                    01480000
                            0015E   124+FUNCOK   EQU   *                                                        01490000
                                    125+*                                                                       01500000
                                    126+*                                                                       01610000
                                    127+*   GET THE ADDRESSES OF THE USERPARM, THE PANEL AND THE MAPPING TBL    01620000
                                    128+*                                                                       01630000
00015E 58B0 C3BC      0045C         129+         L     R11,USERPARM        GET ADDR OF USER PARM AREA           01640000
                            00000   130+         USING USRPARM,R11                                              01650000
                                    131+*                                                                       01660000
000162 0700                         132+         CNOP  0,4                                                      00400002
000164 4100 B000      00000         133+         LA    0,USRPNAM          LOAD PARAMETER INTO REG 0             00800002
000168 5810 C0D0      00170         134+         L     1,*+8              NO DCB, RETURN CODE REQUESTED         01700002
00016C 47F0 C0D4      00174         135+         B     *+8                BRANCH AROUND CONSTANT                01800002
000170 80000000                     136+         DC    X'80000000'        RETURN CODE REQUESTED                 01850002
000174 0A08                         137+         SVC   8                                                        01200002
000176 12FF                         138+         LTR   15,15              RETURN CODE TEST                      01300002
000178 4770 C358      003F8         139+         BNZ   LOADFAIL         GO TO ERROR ROUTINE                     01400002
00017C 5000 B008      00008         140+         ST    R0,USRPADR                                               01680000
                                    141+*                                                                       01690000
000180 4120 B012      00012         142+         LA    R2,USRTBL           GET ADDR OF USER TABLE               01700000
                            00000   143+         USING USRMAP,R2                                                01710000
                                    144+*                                                                       01720000
000184 58A0 B008      00008         145+         L     R10,USRPADR         GET PANEL LOAD MODULE ADDRESS        01730000
000188 5810 A000      00000         146+         L     R1,0(0,R10)         GET PANEL ADDRESS                    01740000
00018C 5010 C3C0      00460         147+         ST    R1,PANLADDR                                              01750000
000190 5810 A008      00008         148+         L     R1,8(0,R10)         GET ADDR OF CURSOR                   01760000
000194 D201 1000 C3F0 00000 00490   149+         MVC   0(2,R1),=X'4040'    RESET BUFFER ADDR                    01770000
00019A D501 B00F C3F2 0000F 00492   150+         CLC   UCUR,=X'0000'       IF THE CURSOR IS NULL                01780000
0001A0 4780 C10A      001AA         151+         BE    DEFLTSBA              DON'T MOVE IT                      01790000
0001A4 D201 1000 B00F 00000 0000F   152+         MVC   0(2,R1),UCUR        MOVE THE PASSED BUFF ADDR            01800000
                            001AA   153+DEFLTSBA EQU   *                                                        01810000
0001AA 5830 A004      00004         154+         L     R3,4(0,R10)         GET ADDR OF OUTPUT MAPPING           01820000
0001AE 5030 C3C4      00464         155+         ST    R3,MAPADDR                                               01830000
                            00000   156+         USING TINPMAP,R3                                               01840000
0001B2 D501 3000 C3F2 00000 00492   157+         CLC   TISBA,=X'0000'      IS THE END OF TABLE FIRST ITEM?      01850000
0001B8 4780 C168      00208         158+         BZ    DONEOUT             YES, BRANCH                          01860000
                            001BC   159+LOOPOUT  EQU *                                                          01870000
0001BC D501 2001 3002 00001 00002   160+         CLC   USRLEN,TILEN        COMPARE OUTLN:MAPLN                  01880000
0001C2 4770 C15E      001FE         161+         BNE   NOMATCH             BRANCH IF MISMATCH                   01890000
0001C6 4840 3002      00002         162+         LH    R4,TILEN            GEN LENGTH                           01900000
0001CA 1244                         163+         LTR   R4,R4               ZERO?                                01910000
0001CC 4780 C168      00208         164+         BZ    DONEOUT             YES, BRANCH                          01920000
0001D0 0640                         165+         BCTR  R4,R0                                                    01930000
                                                                                                               PAGE    5


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

0001D2 5850 3004      00004         166+         L     R5,TIFLD                                                 01940000
0001D6 4440 C158      001F8         167+         EX    R4,MVCOUT                                                01950000
0001DA 9540 2000      00000         168+         CLI   USRCUR,X'40'        IS CURSOR FLAG SET?                  01960000
0001DE 47D0 C14C      001EC         169+         BNH   NEXTFLD             NO, BRANCH                           01970000
0001E2 D201 1000 3000 00000 00000   170+         MVC   0(2,R1),TISBA       MOVE THE PASSED BUFF ADDR            01980000
0001E8 9240 2000      00000         171+         MVI   USRCUR,X'40'        RESET USER CURSOR FLAG               01990000
                            001EC   172+NEXTFLD  EQU   *                                                        02000000
0001EC 4124 2004      00004         173+         LA    R2,4(R4,R2)                                              02010000
0001F0 4130 3008      00008         174+         LA    R3,TINPMAPL(0,R3)                                        02020000
0001F4 47F0 C11C      001BC         175+         B     LOOPOUT                                                  02030000
0001F8 D200 5000 2003 00000 00003   176+MVCOUT   MVC 0(0,R5),USRFLD                                             02040000
                            001FE   177+NOMATCH  EQU *                                                          02050000
                                    178+**       WTO   'MAP3270-&NAME MAP MATCH ERROR',ROUTCDE=11               02060000
                                    179+**       ABEND &UCODE,,,USER                                            02070000
0001FE D201 7004 C3F4 00004 00494   180+         MVC   IOCBRC,=H'16'          PHYS AND SYMB MAP DIFF LEN        02080000
000204 47F0 C35E      003FE         181+         B     LEAVE                                                    02090000
                            00208   182+DONEOUT  EQU *                                                          02100000
000208 58A0 C3C0      00460         183+         L     R10,PANLADDR                                             02110000
00020C 4830 A000      00000         184+         LH    R3,0(0,R10)                                              02120000
000210 4B30 C3F6      00496         185+         SH    R3,=H'2'                                                 02130000
                                    186+**       TPUT  2(R10),(R3),FULLSCR                                      02140000
000214                              187+         DS    0H                       TJID IS '0'                     22800003
000214 1803                         188+         LR    0,R3                     LOAD BUFFER SIZE                23450003
000216 0700                         189+         CNOP  0,4                                                      23700003
000218                              190+         CNOP  0,4                                             @OZ65329 23785636
000218 47F0 C17E      0021E         191+         B     *+6                                             @OZ65329 23828436
00021C 0300                         192+         DC    AL1(3,0)                 OPTION BITS AND PAD    @OZ65329 23871236
00021E 411A 0002      00002         193+         LA    1,2(R10)                 LOAD POINTER TO BUFFER @OZ65329 23914036
000222 BF18 C17C      0021C         194+         ICM   1,8,*-6                  GET OPTION BYTE        @OZ65329 23956836
000226 0A5D                         195+         SVC   93                       ISSUE TGET/TPUT SVC             21200003

000228 12FF                         197+         LTR   R15,R15                 CHECK FOR FAILURE                02160000
00022A 4770 C1A2      00242         198+         BNZ   TPUTERR                 YES, BRANCH                      02170000
00022E D503 7000 C3D8 00000 00478   199+         CLC   IOCBFUNC,=C'PUT '       IF PUT ONLY,                     02180000
000234 4770 C1AE      0024E         200+         BNE   NOTPUT                    CLEAR UAID AND CURSOR          02190000
000238 D202 B00E C406 0000E 004A6   201+         MVC   UAID(3),=3X'00'             AND RETURN                   02200000
00023E 47F0 C35E      003FE         202+         B     LEAVE                                                    02210000
                            00242   203+TPUTERR  EQU   *                                                        02220000
                                    204+**       WTO   'MAP3270-&NAME TPUT RC XX (DEC)',ROUTCDE=11              02230000
                                    205+**       ABEND &UCODE,,,USER                                            02240000
000242 4AF0 C3F8      00498         206+         AH    R15,=H'100'             ADD 100 TO TPUT RC               02250000
000246 40F0 7004      00004         207+         STH   R15,IOCBRC                                               02260000
00024A 47F0 C35E      003FE         208+         B     LEAVE                                                    02270000
                            0024E   209+NOTPUT   EQU   *                                                        02280000
00024E D503 7000 C3E0 00000 00480   210+         CLC   IOCBFUNC,=C'PG  '       IF PG OR IO                      02290000
000254 4780 C1CC      0026C         211+         BE    DOGET                      CONTINUE TO TGET              02300000
000258 D503 7000 C3DC 00000 0047C   212+         CLC   IOCBFUNC,=C'IO  '       OTHERWISE                        02310000
00025E 4780 C1CC      0026C         213+         BE    DOGET                      ABORT                         02320000
                                    214+**       WTO   'MAP3270-&NAME INVALID FUNCTION',ROUTCDE=11              02330000
                                    215+**       ABEND &UCODE,,,USER                                            02340000
000262 D201 7004 C3EE 00004 0048E   216+         MVC   IOCBRC,=H'4'                                             02350000
000268 47F0 C35E      003FE         217+         B     LEAVE                                                    02360000
                            0026C   218+DOGET    EQU   *                                                        02370000
00026C 9200 C419      004B9         219+         MVI   INBUF,X'00'                                              02380000
000270 D2FE C41A C419 004BA 004B9   220+         MVC   INBUF+1(255),INBUF                                       02390000
                                                                                                               PAGE    6


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                    221+*                                                                       02400000
                                    222+**       TGET  INBUF,INBUFLN,ASIS                                       02410000
000276 0700                         223+         CNOP  0,4                                             @OZ46729 44885036
000278                              224+         DS    0F                                              @OZ46729 44903836
000278 47F0 C1E0      00280         225+         B     *+8                     BRANCH AROUND CONSTANTS @OZ48875 44922636
00027C 8100                         226+         DC    AL1(129,0)              OPTION BYTE AND FILLER  @OZ48875 44941436
00027E 0800                         227+         DC    AL2(INBUFLN)             BUFFER SIZE                @01P 44960403
000280 5800 C1DC      0027C         228+         L     0,*-4                    LOAD SIZE              @OZ48875 44985536
000284 4110 C419      004B9         229+         LA    1,INBUF                  LOAD BUFFER ADDRESS    @OZ48875 45010636
000288 BF18 C1DC      0027C         230+         ICM   1,8,*-12                 LOAD OPTION BYTE       @OZ48875 45035736
00028C BF08 C1DD      0027D         231+         ICM   0,8,*-15                 CLEAR HIGH ORDER BYTE  @OZ51683 45060836
000290 0A5D                         232+         SVC   93                       ISSUE SVC                  @01P 45086003

000292 12FF                         234+         LTR   R15,R15            CHECK FOR FAILURE                     02430000
000294 4780 C204      002A4         235+         BZ    TGETOK             NO, BRANCH                            02440000
                                    236+**       WTO   'MAP3270-&NAME TGET RC XX (DEC)',ROUTCDE=11              02450000
                                    237+**       ABEND &UCODE,,,USER                                            02460000
000298 4AF0 C3FA      0049A         238+         AH    R15,=H'200'                                              02470000
00029C 40F0 7004      00004         239+         STH   R15,IOCBRC                                               02480000
0002A0 47F0 C35E      003FE         240+         B     LEAVE                                                    02490000
                            002A4   241+TGETOK   EQU   *                                                        02500000
0002A4 D202 B00E C419 0000E 004B9   242+         MVC   UAID(3),INBUF       MOVE THE AID AND CUR                 02510000
                                    243+**********************************************************************  02710000
                                    244+*                                                                    *  02720000
                                    245+*  THE BUFFER RETURNED BY TGET HAS EACH FIELD RETURNED WITH A 3      *  02730000
                                    246+*  BYTE PREFIX - X'11' PLUS BUFFER ADDRESS.                          *  02740000
                                    247+*                                                                    *  02750000
                                    248+*  TO MAP BACK TO THE USER AREA, THERE IS A XREF MAP GENERATED AS    *  02760000
                                    249+*  PART OF THE PANEL.  THIS XREF HAS THE BUFFER ADDR, THE ADDR OF    *  02770000
                                    250+*  THE USER FIELD AND THE MAX LENGTH OF THE FIELD.  NOTE THAT THIS   *  02780000
                                    251+*  ROUTINE DOES NOT MAP BACK TO THE PANEL BUT TO THE USER AREA.      *  02790000
                                    252+*                                                                    *  02800000
                                    253+**********************************************************************  02810000
0002AA 4120 B012      00012         254+         LA    R2,USRTBL           GET TO THE USER TABLE                02820000
0002AE 4160 C41C      004BC         255+         LA    R6,INBUF+3                                               02830000
0002B2 4190 03C0      003C0         256+         LA    R9,MAXFLDS          LIMIT INPUT FIELDS TO MAX POSSIBLE   02840000
                                    257+**                                 TO PREVENT RUNAWAY LOOPS             02850000
0002B6 5830 C3C4      00464         258+         L     R3,MAPADDR                                               02860000
0002BA D501 3000 C3F2 00000 00492   259+         CLC   TISBA,=X'0000'      SEE IF 1ST DATA FIELD IS END OF TAB. 02870000
0002C0 4780 C320      003C0         260+         BE    ALLDONE             IF SO, BRANCH TO EXIT.               02880000
                            002C4   261+LOOPIN   EQU *                                                          02890000
0002C4 5830 C3C4      00464         262+         L     R3,MAPADDR                                               02900000
                                    263+*                                                                       02910000
                                    264+*  FIND THE BUFFER ADDRESS IN THE XREF TABLE.                           02920000
                                    265+*                                                                       02930000
0002C8 9511 6000      00000         266+         CLI   0(R6),X'11'         CHECK FOR SBA                        02940000
0002CC 4780 C242      002E2         267+         BE    FNDSBA              IF SO, CONTINUE                      02950000
0002D0 9500 6000      00000         268+         CLI   0(R6),X'00'         END OF MESSAGE FROM 3270?            02960000
0002D4 4780 C2D2      00372         269+         BE    DONEIN                                                   02970000
                                    270+**       WTO   'MAP3270-&NAME INVALID INPUT MSG',ROUTCDE=11             02980000
                                    271+**       ABEND &UCODE,,,USER                                            02990000
0002D8 D201 7004 C3FC 00004 0049C   272+         MVC   IOCBRC,=H'20'                                            03000000
0002DE 47F0 C35E      003FE         273+         B     LEAVE                                                    03010000
                            002E2   274+FNDSBA   EQU   *                                                        03020000
0002E2 D501 3000 6001 00000 00001   275+         CLC   TISBA,1(R6)         COMPARE THE SBA.                     03030000
                                                                                                               PAGE    7


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

0002E8 4780 C264      00304         276+         BE    FNDTSBA             IF SO, BRANCH                        03040000
0002EC 4130 3008      00008         277+         LA    R3,TINPMAPL(,R3)    TRY NEXT ENTRY                       03050000
0002F0 D501 3000 C3F2 00000 00492   278+         CLC   TISBA,=X'0000'      TEST FOR END OF TABLE                03060000
0002F6 4770 C242      002E2         279+         BNE   FNDSBA              IF NOT END,  TRY NEXT THIS ENTRY     03070000
                                    280+**       WTO   'MAP3270-&NAME INPUT MAPPING ERROR',ROUTCDE=11           03080000
                                    281+**       ABEND &UCODE,DUMP,,USER                                        03090000
0002FA D201 7004 C3FE 00004 0049E   282+         MVC   IOCBRC,=H'24'                                            03100000
000300 47F0 C35E      003FE         283+         B     LEAVE                                                    03110000
                            00304   284+FNDTSBA  EQU   *                                                        03120000
                                    285+*                                                                       03130000
                                    286+*   CALCULATE THE LENGTH OF THE DATAFIELD                               03140000
                                    287+*                                                                       03150000
000304 4180 6003      00003         288+         LA    R8,3(,R6)              GET ADDR OF 1ST BYTE              03160000
000308 9511 8000      00000         289+NXTSBA   CLI   0(R8),X'11'            IF THIS AN SBA?                   03170000
00030C 4780 C280      00320         290+         BE    GOTLEN                 YES, BRANCH                       03180000
000310 9500 8000      00000         291+         CLI   0(R8),X'00'            IF END OF MSG?                    03190000
000314 4780 C280      00320         292+         BE    GOTLEN                                                   03200000
000318 4180 8001      00001         293+         LA    R8,1(,R8)              BUMP UP THE CHARACTER             03210000
00031C 47F0 C268      00308         294+         B     NXTSBA                                                   03220000
                            00320   295+GOTLEN   EQU   *                                                        03230000
000320 1B86                         296+         SR    R8,R6                  CALCULATE FLD LEN                 03240000
000322 5B80 C3E4      00484         297+         S     R8,=F'3'                                                 03250000
                                    298+*                                                                       03260000
000326 4840 3002      00002         299+         LH    R4,TILEN               GEN LENGTH                        03270000
00032A 1244                         300+         LTR   R4,R4                  ZERO?                             03280000
00032C 4780 C2D2      00372         301+         BZ    DONEIN                 YES, BRANCH                       03290000
000330 0640                         302+         BCTR  R4,0                                                     03300000
000332 5850 3004      00004         303+         L     R5,TIFLD                                                 03310000
000336 4440 C2C2      00362         304+         EX    R4,MVCSP                                                 03320000
00033A 4840 3002      00002         305+         LH    R4,TILEN               GEN LENGTH                        03330000
00033E 1984                         306+         CR    R8,R4                                                    03340000
000340 4780 C2AA      0034A         307+         BE    LENOK                                                    03350000
000344 4720 C2AA      0034A         308+         BH    LENOK                                                    03360000
000348 1848                         309+         LR    R4,R8                                                    03370000
                            0034A   310+LENOK    EQU   *                                                        03380000
00034A 0640                         311+         BCTR  R4,R0                                                    03390000
00034C 4440 C2BC      0035C         312+         EX    R4,MVCIN                                                 03400000
000350 4168 6003      00003         313+         LA    R6,3(R8,R6)                                              03410000
000354 4690 C224      002C4         314+         BCT   R9,LOOPIN                                                03420000
000358 47F0 C2D2      00372         315+         B     DONEIN                 ONLY PROCESS LIMITED FIELDS       03430000
00035C D200 5000 6003 00000 00003   316+MVCIN    MVC   0(0,R5),3(R6)                                            03440000
000362 D200 5000 C36C 00000 0040C   317+MVCSP    MVC   0(0,R5),SPACES                                           03450000
                            00368   318+NOMATCHI EQU *                                                          03460000
                                    319+**       WTO   'MAP3270-&NAME MAPPING ERROR',ROUTCDE=11                 03470000
                                    320+**       ABEND &UCODE,DUMP,,USER                                        03480000
000368 D201 7004 C400 00004 004A0   321+         MVC   IOCBRC,=H'28'                                            03490000
00036E 47F0 C35E      003FE         322+         B     LEAVE                                                    03500000
                            00372   323+DONEIN   EQU *                                                          03510000
                                    324+****     B     ALLDONE                                                  03520000
                                    325+*                                                                       03530000
                                    326+*  MAP DATA BACK TO USER AREA                                           03540000
                                    327+*                                                                       03550000
000372 4190 03C0      003C0         328+         LA    R9,MAXFLDS     LIMIT INPUT FIELDS                        03560000
000376 58A0 C3C0      00460         329+         L     R10,PANLADDR                                             03570000
00037A 4120 B012      00012         330+         LA    R2,USRTBL           GET ADDR OF USER TABLE               03580000
                                                                                                               PAGE    8


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

00037E 5830 C3C4      00464         331+         L     R3,MAPADDR                                               03590000
                            00000   332+         USING TINPMAP,R3                                               03600000
                            00382   333+LOOPRET  EQU *                                                          03610000
000382 D501 2001 3002 00001 00002   334+         CLC   USRLEN,TILEN        COMPARE OUTLN:MAPLN                  03620000
000388 4770 C316      003B6         335+         BNE   NOMATCHR            BRANCH IF MISMATCH                   03630000
00038C 4840 3002      00002         336+         LH    R4,TILEN            GEN LENGTH                           03640000
000390 1244                         337+         LTR   R4,R4               ZERO?                                03650000
000392 4780 C320      003C0         338+         BZ    ALLDONE             YES, BRANCH                          03660000
000396 0640                         339+         BCTR  R4,R0                                                    03670000
000398 5850 3004      00004         340+         L     R5,TIFLD                                                 03680000
00039C 4440 C310      003B0         341+         EX    R4,MVCRET                                                03690000
0003A0 4124 2004      00004         342+         LA    R2,4(R4,R2)                                              03700000
0003A4 4130 3008      00008         343+         LA    R3,TINPMAPL(0,R3)                                        03710000
0003A8 4690 C2E2      00382         344+         BCT   R9,LOOPRET                                               03720000
0003AC 47F0 C320      003C0         345+         B     ALLDONE                                                  03730000
0003B0 D200 2003 5000 00003 00000   346+MVCRET   MVC   USRFLD(0),0(R5)                                          03740000
                            003B6   347+NOMATCHR EQU *                                                          03750000
                                    348+**       WTO   'MAP3270-&NAME MAP BACK ERROR',ROUTCDE=11                03760000
                                    349+**       ABEND &UCODE,,,USER                                            03770000
0003B6 D201 7004 C402 00004 004A2   350+         MVC   IOCBRC,=H'32'                                            03780000
0003BC 47F0 C35E      003FE         351+         B     LEAVE                                                    03790000
                                    352+****                                                                    03800000
                            003C0   353+ALLDONE  EQU   *                                                        03810000
0003C0 47F0 C35E      003FE         354+         B     LEAVE                                                    03870000
                                    355+**IT     STLINENO LINE=1                                                03890000
0003C4 4110 0001      00001         356+EXIT     LA    1,1                      PUT LINE NUM IN PARM REG        01400000
0003C8 1B00                         357+         SR    0,0                      PREPARE FLAG BYTE               02130000
0003CA 1610                         358+         OR    1,0                      SET MODE=OFF FLAG IN REG 1      02140000
0003CC 4100 0013      00013         359+         LA    0,19                     LOAD ENTRY CODE                 02200000
0003D0 8900 0018      00018         360+         SLL   0,24                     SHIFT TO HIGH ORDER BYTE        02250000
0003D4 0A5E                         361+         SVC   94                       TERMINAL CONTROL MACRO SVC      02300000
                                    362+**       STFSMODE OFF                                                   03910000
0003D6 1B11                         363+         SR    1,1                      CLEAR PARAMETER REGISTER        01600000
0003D8 4100 0012      00012         364+         LA    0,18                     LOAD ENTRY CODE                 01700000
0003DC 8900 0018      00018         365+         SLL   0,24                     SHIFT TO HIGH ORDER BYTE        01750000
0003E0 0A5E                         366+         SVC   94                       TERMINAL CONTROL MACRO SVC      01800000
                                    367+**       STTMPMD OFF                                                    03930000
0003E2 4110 0000      00000         368+         LA    1,0+0                    SET PARM FLAGS                  01800001
0003E6 8910 0018      00018         369+         SLL   1,24                     SHIFT TO HIGH ORDER BYTE        01850001
0003EA 4100 0014      00014         370+         LA    0,20                     LOAD ENTRY CODE                 01900001
0003EE 8900 0018      00018         371+         SLL   0,24                     SHIFT TO HIGH ORDER BYTE        01950001
0003F2 0A5E                         372+         SVC   94                       TERMINAL CONTROL MACRO SVC      02000001
0003F4 47F0 C35E      003FE         373+         B     LEAVE                                                    03950000
                            003F8   374+LOADFAIL EQU   *                                                        03960000
0003F8 D201 7004 C404 00004 004A4   375+         MVC   IOCBRC,=H'300'         INDICATE LOAD FAILED              03970000
                            003FE   376+LEAVE    EQU   *                                                        03980000
0003FE 58D0 D004      00004         377+         L     13,4(0,13)          RESET TO CALLERS SAVE AREA           00000004
000402 98EC D00C      0000C         378+         LM    14,12,12(13)                      RESTORE THE REGISTERS  00650000
000406 41F0 0000      00000         379+         LA    15,0(0,0)                         LOAD RETURN CODE       01750000
00040A 07FE                         380+         BR    14                                RETURN                 02000000
                                    381+*                                                                       04000000
00040C 4040404040404040             382+SPACES   DC    CL80' '                                                  04010000
00045C                              383+USERPARM DS    F                                                        04400000
000460                              384+PANLADDR DS    F                                                        04410000
000464                              385+MAPADDR  DS    F                                                        04420000
                                                                                                               PAGE    9


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

000468 0001                         386+ONE      DC    H'1'                                                     04430000
000470                              387+         LTORG                                                          04440000
000470 E2E3D9E3                     388                =C'STRT'
000474 C5D5C440                     389                =C'END '
000478 D7E4E340                     390                =C'PUT '
00047C C9D64040                     391                =C'IO  '
000480 D7C74040                     392                =C'PG  '
000484 00000003                     393                =F'3'
000488 0000                         394                =H'0'
00048A 0008                         395                =H'8'
00048C 000C                         396                =H'12'
00048E 0004                         397                =H'4'
000490 4040                         398                =X'4040'
000492 0000                         399                =X'0000'
000494 0010                         400                =H'16'
000496 0002                         401                =H'2'
000498 0064                         402                =H'100'
00049A 00C8                         403                =H'200'
00049C 0014                         404                =H'20'
00049E 0018                         405                =H'24'
0004A0 001C                         406                =H'28'
0004A2 0020                         407                =H'32'
0004A4 012C                         408                =H'300'
0004A6 000000                       409                =3X'00'
0004A9 5C5CE2E3C1D9E340             410+         DC    CL16'**START INBUF**'                                    04450000
0004B9                              411+INBUF    DS    CL2048                                                   04460000
                            00800   412+INBUFLN  EQU   2048                                                     04470000
                            003C0   413+MAXFLDS  EQU   960                                                      04480000
                                    414+*        T3270D                                                         04500000
000000                              415+IOCB     DSECT                                                          00300000
000000                              416+IOCBFUNC DS    CL4                     FUNCTION CODE (STRT/IO/END)      00310000
000004                              417+IOCBRC   DS    AL2                     RETURN CODE                      00320000
000006                              418+IOCBLEN  DS    AL2                     IO BUFFER LENGTH                 00330000
000008                              419+IOCBADR  DS    A                       IO BUFFER ADDRESS                00340000
00000C                              420+         DS    XL20                    RESERVED                         00350000
                            00020   421+IOCBLN   EQU   *-IOCB                                                   00360000
                                    422+*                                                                       00380000
000000                              423+USRPARM  DSECT                                                          00390000
000000                              424+USRPNAM  DS   CL8                      PANEL NAME                       00400000
000008                              425+USRPADR  DS   A                        PANEL CORE ADDR                  00410000
00000C                              426+URC      DS   H                        IO RETURN CODE                   00420000
00000E                              427+UAID     DS   X                        AID                              00430000
00000F                              428+UCUR     DS   XL2                      CURSOR                           00440000
000011                              429+         DS   X                        RESERVED                         00450000
000012                              430+USRTBL   DS   H                        FLD LENGTH                       00460000
                                    431+*                                                                       00470000
000000                              432+USRMAP   DSECT                                                          00480000
000000                              433+USRCUR   DS    C                                                        00490000
000001                              434+USRLEN   DS    AL2                                                      00500000
000003                              435+USRFLD   DS    C                                                        00510000
                                    436+*                                                                       00520000
000000                              437+TINPMAP  DSECT                                                          00530000
000000                              438+TISBA    DS    AL2                                                      00540000
000002                              439+TILEN    DS    AL2                                                      00550000
000004                              440+TIFLD    DS    AL4                                                      00560000
                                                                                                               PAGE   10


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                            00008   441+TINPMAPL EQU   *-TINPMAP                                                00570000
                                    442          END                                                            00710000
                                                  CROSS-REFERENCE                                              PAGE   11


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

ALLDONE  00001 000003C0 00353  00260 00338 00345
DEFLTSBA 00001 000001AA 00153  00151
DOGET    00001 0000026C 00218  00211 00213
DONEIN   00001 00000372 00323  00269 00301 00315
DONEOUT  00001 00000208 00182  00158 00164
ENDOK    00001 00000128 00111  00106
EXIT     00004 000003C4 00356  00114
FNDSBA   00001 000002E2 00274  00267 00279
FNDTSBA  00001 00000304 00284  00276
FUNCOK   00001 0000015E 00124  00117 00119 00121
GOTLEN   00001 00000320 00295  00290 00292
IDS0002  00001 00000044 00036  00060
ID10002  00004 00000000 00029  00036 00055
ID20002  00008 00000005 00031  00030
ID30002  00002 0000008C 00038  00030
ID40002  00001 0000008C 00055  00029
INBUF    02048 000004B9 00411  00096 00219 00220 00220 00229 00242 00255
INBUFLN  00001 00000800 00412  00098 00227
IOCB     00001 00000000 00415  00072 00112 00113 00113 00421
IOCBADR  00004 00000008 00419  00076 00097 00104
IOCBFUNC 00004 00000000 00416  00074 00102 00116 00118 00120 00199 00210 00212
IOCBLEN  00002 00000006 00418  00099
IOCBLN   00001 00000020 00421  00113
IOCBRC   00002 00000004 00417  00073 00081 00109 00122 00180 00207 00216 00239 00272 00282 00321 00350 00375
LEAVE    00001 000003FE 00376  00082 00100 00110 00123 00181 00202 00208 00217 00240 00273 00283 00322 00351 00354 00373
LENOK    00001 0000034A 00310  00307 00308
LOADFAIL 00001 000003F8 00374  00139
LOOPIN   00001 000002C4 00261  00314
LOOPOUT  00001 000001BC 00159  00175
LOOPRET  00001 00000382 00333  00344
MAPADDR  00004 00000464 00385  00155 00258 00262 00331
MAXFLDS  00001 000003C0 00413  00256 00328
MVCIN    00006 0000035C 00316  00312
MVCOUT   00006 000001F8 00176  00167
MVCRET   00006 000003B0 00346  00341
MVCSP    00006 00000362 00317  00304
NEXTFLD  00001 000001EC 00172  00169
NOMATCH  00001 000001FE 00177  00161
NOMATCHR 00001 000003B6 00347  00335
NOTEND   00001 00000136 00115  00103
NOTPUT   00001 0000024E 00209  00200
NOTSTRT  00001 0000010A 00101  00075
NXTSBA   00004 00000308 00289  00294
PANLADDR 00004 00000460 00384  00147 00183 00329
R0       00001 00000000 00039  00140 00165 00311 00339
R1       00001 00000001 00040  00069 00070 00146 00147 00148 00149 00152 00170
R10      00001 0000000A 00049  00145 00146 00148 00154 00183 00184 00193 00329
R11      00001 0000000B 00050  00129 00130
R12      00001 0000000C 00051  00063 00064
R15      00001 0000000F 00054  00197 00197 00206 00207 00234 00234 00238 00239
R2       00001 00000002 00041  00076 00077 00077 00096 00097 00098 00099 00104 00105 00105 00142 00143 00173 00173 00254
                               00330 00342 00342
R3       00001 00000003 00042  00154 00155 00156 00174 00174 00184 00185 00188 00258 00262 00277 00277 00331 00332 00343
                               00343
R4       00001 00000004 00043  00162 00163 00163 00165 00167 00173 00299 00300 00300 00302 00304 00305 00306 00309 00311
                                                  CROSS-REFERENCE                                              PAGE   12


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

                               00312 00336 00337 00337 00339 00341 00342
R5       00001 00000005 00044  00166 00176 00303 00316 00317 00340 00346
R6       00001 00000006 00045  00255 00266 00268 00275 00288 00296 00313 00313 00316
R7       00001 00000007 00046  00069 00072
R8       00001 00000008 00047  00288 00289 00291 00293 00293 00296 00297 00306 00309 00313
R9       00001 00000009 00048  00256 00314 00328 00344
SPACES   00080 0000040C 00382  00317
STRTOK   00001 000000D2 00083  00078
TGETOK   00001 000002A4 00241  00235
TIFLD    00004 00000004 00440  00166 00303 00340
TILEN    00002 00000002 00439  00160 00162 00299 00305 00334 00336
TINPMAP  00001 00000000 00437  00156 00332 00441
TINPMAPL 00001 00000008 00441  00174 00277 00343
TISBA    00002 00000000 00438  00157 00170 00259 00275 00278
TPUTERR  00001 00000242 00203  00198
UAID     00001 0000000E 00427  00201 00242
UCUR     00002 0000000F 00428  00150 00152
USERPARM 00004 0000045C 00383  00070 00071 00129
USRCUR   00001 00000000 00433  00168 00171
USRFLD   00001 00000003 00435  00176 00346
USRLEN   00002 00000001 00434  00160 00334
USRMAP   00001 00000000 00432  00143
USRPADR  00004 00000008 00425  00140 00145
USRPARM  00001 00000000 00423  00130
USRPNAM  00008 00000000 00424  00133
USRTBL   00002 00000012 00430  00142 00254 00330
                                                  LITERAL CROSS-REFERENCE                                      PAGE   13


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

=C'STRT' 00004 00000470 00388  00074
=C'END ' 00004 00000474 00389  00102
=C'PUT ' 00004 00000478 00390  00116 00199
=C'IO  ' 00004 0000047C 00391  00118 00212
=C'PG  ' 00004 00000480 00392  00120 00210
=F'3'    00004 00000484 00393  00297
=H'0'    00002 00000488 00394  00073
=H'8'    00002 0000048A 00395  00081
=H'12'   00002 0000048C 00396  00109
=H'4'    00002 0000048E 00397  00122 00216
=X'4040' 00002 00000490 00398  00149
=X'0000' 00002 00000492 00399  00150 00157 00259 00278
=H'16'   00002 00000494 00400  00180
=H'2'    00002 00000496 00401  00185
=H'100'  00002 00000498 00402  00206
=H'200'  00002 0000049A 00403  00238
=H'20'   00002 0000049C 00404  00272
=H'24'   00002 0000049E 00405  00282
=H'28'   00002 000004A0 00406  00321
=H'32'   00002 000004A2 00407  00350
=H'300'  00002 000004A4 00408  00375
=3X'00'  00001 000004A6 00409  00201
                                                  ASSEMBLER DIAGNOSTICS AND STATISTICS                         PAGE   14


                                                                                                 ASM 0201 13.22 10/02/21

NO STATEMENTS FLAGGED IN THIS ASSEMBLY
HIGHEST SEVERITY WAS    0
OPTIONS FOR THIS ASSEMBLY
  ALIGN, ALOGIC, BUFSIZE(STD), NODECK, ESD, FLAG(0), LINECOUNT(55), LIST, NOMCALL, YFLAG, WORKSIZE(2097152)
  NOMLOGIC, NONUMBER, OBJECT, NORENT, RLD, NOSTMT, NOLIBMAC, NOTERMINAL, NOTEST, XREF(SHORT)
  SYSPARM()
WORK FILE BUFFER SIZE/NUMBER = 8702/ 1
TOTAL RECORDS READ FROM SYSTEM INPUT          2
TOTAL RECORDS READ FROM SYSTEM LIBRARY     2263
TOTAL RECORDS PUNCHED                        25
TOTAL RECORDS PRINTED                       585

 F64-LEVEL LINKAGE EDITOR OPTIONS SPECIFIED XREF,LET,LIST
          DEFAULT OPTION(S) USED -  SIZE=(98304,55296)



                                                CROSS REFERENCE TABLE


  CONTROL SECTION                       ENTRY

    NAME    ORIGIN  LENGTH                NAME   LOCATION     NAME   LOCATION     NAME   LOCATION     NAME   LOCATION
  T3270IO       00     CB9


 ENTRY ADDRESS       00

 TOTAL LENGTH       CC0
****T3270IO   NOW REPLACED IN DATA SET
AUTHORIZATION CODE IS         0.
                                               EXTERNAL SYMBOL DICTIONARY                                      PAGE    1


SYMBOL   TYPE  ID   ADDR  LENGTH LDID                                                            ASM 0201 13.22 10/02/21

TTYRTN    SD  0001 000000 001121
                                                                                                               PAGE    2


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                      1 TTYRTN   TTYRTN                                                         00800000
                                      2+**********************************************************************  00030000
                                      3+**                                                                  **  00040000
                                      4+** MAP3270 V2.2.0 - SOFTWARE PACKAGE TO IMPLEMENT FULL SCREEN       **  00050000
                                      5+** IO FOR IBM 3270 CLASS TERMINALS.                                 **  00060000
                                      6+**                                                                  **  00070000
                                      7+**             COPYRIGHT (C) 2021  EDWARD G LISS                    **  00080000
                                      8+**                     EGLISS4024@GMAIL.COM                         **  00090000
                                      9+**                                                                  **  00100000
                                     10+** THIS PROGRAM IS FREE SOFTWARE: YOU CAN REDISTRIBUTE IT           **  00110000
                                     11+** AND/OR MODIFY IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC       **  00120000
                                     12+** LICENSE AS PUBLISHED BY THE FREE SOFTWARE FOUNDATION,            **  00130000
                                     13+** EITHER VERSION 3 OF THE LICENSE, OR ANY LATER VERSION.           **  00140000
                                     14+**                                                                  **  00150000
                                     15+** THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE          **  00160000
                                     16+** USEFUL, BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED       **  00170000
                                     17+** WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR          **  00180000
                                     18+** PURPOSE.  SEE THE GNU GENERAL PUBLIC LICENSE FOR MORE            **  00190000
                                     19+** DETAILS.                                                         **  00200000
                                     20+**                                                                  **  00210000
                                     21+** PLEASE SEE HTTPS://WWW.GNU.ORG/LICENSES/ FOR A COPY OF THE       **  00220000
                                     22+** GNU GENERAL PUBLIC LICENSE.                                      **  00230000
                                     23+**                                                                  **  00240000
                                     24+**********************************************************************  00260000
                                     25+**AME    ESTART TYPE=START,DESC='3270 TTY ROUTINE',VER='2.0.0',         00680000
                                     26+**             REGS=YES,BASE=R12                                        00690000
000000                               27+TTYRTN   START                                                          00000019
                                     28+*                                                                       00000027
000000 47FF 007C      0007C          29+ID10002    B     ID40002(15)           BRANCH AROUND IDENT CONSTANTS    00000039
000004 77                            30+         DC    AL1(ID30002-ID20002)                                     00000041
000005 E3E3E8D9E3D54040              31+ID20002    DC    CL8'TTYRTN'                                            00000042
00000D F24BF04BF0                    32+         DC    C'2.0.0'                                                 00000043
000012 40F1F061F0F261F2              33+         DC    C' 10/02/21 13.22 - '                                    00000044
000024 F3F2F7F040E3E3E8              34+         DC    C'3270 TTY ROUTINE'                                      00000045
000034                               35+         DS    0F                                                       00000046
                            00034    36+IDS0002    EQU   *-ID10002                                              00000047
000034                               37+         DS    18F                                                      00000048
00007C                               38+ID30002    DS    0H                                                     00000049
                            00000    39+R0       EQU   0                                                        00000007
                            00001    40+R1       EQU   1                                                        00000008
                            00002    41+R2       EQU   2                                                        00000009
                            00003    42+R3       EQU   3                                                        00000010
                            00004    43+R4       EQU   4                                                        00000011
                            00005    44+R5       EQU   5                                                        00000012
                            00006    45+R6       EQU   6                                                        00000013
                            00007    46+R7       EQU   7                                                        00000014
                            00008    47+R8       EQU   8                                                        00000015
                            00009    48+R9       EQU   9                                                        00000016
                            0000A    49+R10      EQU   10                                                       00000017
                            0000B    50+R11      EQU   11                                                       00000018
                            0000C    51+R12      EQU   12                                                       00000019
                            0000D    52+R13      EQU   13                                                       00000020
                            0000E    53+R14      EQU   14                                                       00000021
                            0000F    54+R15      EQU   15                                                       00000022
                            0007C    55+ID40002    EQU   *-ID10002                                              00000054
                                                                                                               PAGE    3


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                     56+*                                                                       00000055
00007C 90EC D00C      0000C          57+         STM   14,12,12(13)                                             00000056
                                     58+*                                                                       00000057
000080 185D                          59+         LR    5,13                COPY CALLER'S SAVEAREA ADDR          00000058
000082 41DF 0034      00034          60+         LA    13,IDS0002(15)      ESTABLISH MY SAVEAREA                00000059
000086 5050 D004      00004          61+         ST    5,4(,13)            BACK CHAIN SAVE AREAS                00000060
00008A 50D0 5008      00008          62+         ST    13,8(,5)            FORWARD CHAIN SAVE AREAS             00000061
00008E 05C0                          63+         BALR  R12,0               ESTABLISH BASE REG VALUE             00000063
                            00090    64+         USING *,R12                                                    00000064
                            0108E    65+         USING *+4094,R11                                               00730000
000090 41BC 0FFE      00FFE          66+         LA    R11,4094(R12)                                            00740000
000094 D203 C1D0 C1D8 00260 00268    67+         MVC   USERPARM,=4X'00'        CLEAR OUT USERPARM               00750000
                                     68+*                                                                       00760000
00009A 18A1                          69+         LR    R10,R1                  SAVE THE PARMADDR                00780000
                            00000    70+         USING TTYPARMS,R10                                             00790000
                                     71+*                                                                       00800000
                                     72+*    VERIFY THE PARMS - PARM LIST COULD BE ONE BLOCK OF 5 ITEMS         00810000
                                     73+*      OR 5 SEPARATE ITEMS.  IF ONE, REFORMAT TO LOOK LIKE 5 ITEMS.     00820000
                                     74+*                                                                       00830000
00009C 9180 A000      00000          75+         TM    TTYPFUNC,X'80'          ONLY 1 PARM?                     00840000
0000A0 4710 C062      000F2          76+         BO    ONEPARM                 YES, BRANCH                      00850000
0000A4 9180 A004      00004          77+         TM    TTYPLOUT,X'80'                                           00860000
0000A8 4710 C034      000C4          78+         BO    BADPARMS                                                 00870000
0000AC 9180 A008      00008          79+         TM    TTYPLINP,X'80'                                           00880000
0000B0 4710 C034      000C4          80+         BO    BADPARMS                                                 00890000
0000B4 9180 A00C      0000C          81+         TM    TTYPERR,X'80'                                            00900000
0000B8 4710 C034      000C4          82+         BO    BADPARMS                                                 00910000
0000BC 9180 A010      00010          83+         TM    TTYPAID,X'80'                                            00920000
0000C0 4710 C074      00104          84+         BO    PARMSOK                                                  00930000
                            000C4    85+BADPARMS EQU   *                                                        00940000
                                     86+**       WTO   'MAP3270-&NAME PARM ERROR',ROUTCDE=11                    00950000
0000C4                               87+         CNOP  0,4                                                      09800002
0000C4 4510 C05A      000EA          88+         BAL   1,IHB0004A                        BRANCH AROUND MESSAGE  09850002
0000C8 001D                          89+         DC    AL2(29)             TEXT LENGTH                          13200002
0000CA 8000                          90+         DC    B'1000000000000000' MCS FLAGS                            13250002
0000CC D4C1D7F3F2F7F060              91+         DC    C'MAP3270-TTYRTN PARM ERROR'                             13350002
0000E5 0000                          92+         DC    B'0000000000000000' DESCRIPTOR CODES                     13450002
0000E7 0020                          93+         DC    B'0000000000100000' ROUTING CODES                        13500002
0000EA                               94+IHB0004A DS    0H                                                       15850002
0000EA 0A23                          95+         SVC   35                                                       15950002
                                     96+**       ABEND 3270,,,USER                 OTHERWISE ABORT              00970000
0000EC                               97+         DS    0H                                                       00400002
0000EC 4110 0CC6      00CC6          98+         LA    1,3270                            LOAD PARAMETER REG 1   01900002
0000F0 0A0D                          99+         SVC   13                 LINK TO ABEND ROUTINE                 02050002
                            000F2   100+ONEPARM  EQU   *                                                        00990000
0000F2 5830 A000      00000         101+         L     R3,TTYPFUNC                                              01000000
0000F6 5030 C1D0      00260         102+         ST    R3,USERPARM               SAVE ADDRESS OF SINGLE PARM    01010000
0000FA D2F0 CFA0 3000 01030 00000   103+         MVC   VFUNC(VPARMLN),0(R3)      MOVE THE REQUEST BLOCK         01020000
000100 41A0 CF8C      0101C         104+         LA    R10,VPARMS                                               01030000
                            00104   105+PARMSOK  EQU   *                                                        01060000
                                    106+*                                                                       01070000
000104 5810 C1FC      0028C         107+         L     R1,T3270ADR                                              01080000
000108 1211                         108+         LTR   R1,R1                                                    01090000
00010A 4770 C08C      0011C         109+         BNZ   SKIPLD                                                   01100000
00010E 0700                         110+         CNOP  0,4                                                      00400002
                                                                                                               PAGE    4


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

000110 4100 C1F4      00284         111+         LA    0,T3270IO          LOAD PARAMETER INTO REG 0             00800002
000114 1B11                         112+         SR    1,1                SHOW NO DCB PRESENT                   01000002
000116 0A08                         113+         SVC   8                                                        01200002
000118 5000 C1FC      0028C         114+         ST    R0,T3270ADR                                              01120000
                            0011C   115+SKIPLD   EQU   *                                                        01130000
00011C 5830 A000      00000         116+         L     R3,TTYPFUNC             GET THE FIRST PARM - FUNCTION    01140000
000120 D503 3000 C1DC 00000 0026C   117+         CLC   0(4,R3),=C'IO  '         IO REQUEST?                     01150000
000126 4780 C108      00198         118+         BE    IORTN                   YES, BRANCH                      01160000
00012A D503 3000 C1E0 00000 00270   119+         CLC   0(4,R3),=C'PG  '         IO REQUEST?                     01170000
000130 4780 C108      00198         120+         BE    IORTN                   YES, BRANCH                      01180000
000134 D503 3000 C1E4 00000 00274   121+         CLC   0(4,R3),=C'PUT '         PUT REQUEST?                    01190000
00013A 4780 C108      00198         122+         BE    IORTN                   YES, BRANCH                      01200000
00013E D503 3000 C1E8 00000 00278   123+         CLC   0(4,R3),=C'CLR '         PUT REQUEST?                    01210000
000144 4780 C0FA      0018A         124+         BE    IOCLR                   YES, BRANCH                      01220000
000148 D503 3000 C1EC 00000 0027C   125+         CLC   0(4,R3),=C'END '         END IT?                         01230000
00014E 4780 C18A      0021A         126+         BE    EXIT                    YES, BRANCH                      01240000
000152 D503 3000 C1F0 00000 00280   127+         CLC   0(4,R3),=C'STRT'         START IT?                       01250000
000158 4780 C0D2      00162         128+         BE    STRTIT                  YES, BRANCH                      01260000
00015C                              129+         DS    0H                                                       00400002
00015C 4110 0014      00014         130+         LA    1,20                              LOAD PARAMETER REG 1   01900002
000160 0A0D                         131+         SVC   13                 LINK TO ABEND ROUTINE                 02050002
                                    132+*                                                                       01280000
                                    133+*  INITIALIZE THE IOCB AND SET IT UP FOR AN STRT                        01290000
                                    134+*                                                                       01300000
                            00162   135+STRTIT   EQU   *                                                        01310000
000162 9200 C200      00290         136+         MVI   IOCB,X'00'                                               01320000
000166 D21E C201 C200 00291 00290   137+         MVC   IOCB+1(IOCBLN-1),IOCB                                    01330000
00016C D203 C200 C1F0 00290 00280   138+         MVC   IOCBFUNC,=C'STRT'                                        01340000
000172 0700                         139+         CNOP  0,4                                                      00310000
000174 4510 C0F0      00180         140+         BAL   R1,TCAL0010             SET UP THE PARMS                 00320000
000178 00000290                     141+         DC    A(IOCB)                                                  00330000
00017C 80                           142+         DC    AL1(X'80')                                               00340000
00017D 0008FC                       143+         DC    AL3(TPARM)                                               00350000
000180 58F0 C1FC      0028C         144+TCAL0010    L  R15,T3270ADR            CRT IO IS PRELOADED, PUT ADDR    00360000
000184 05EF                         145+         BALR  R14,R15                    IN R15 AND CALL               00370000
000186 47F0 C1AC      0023C         146+         B     LEAVE                                                    01360000
                                    147+*                                                                       01370000
                            0018A   148+IOCLR    EQU   *                                                        01380000
00018A D203 C200 C1E4 00290 00274   149+         MVC   IOCBFUNC,=C'PUT '        USE THE FUNC CD                 01390000
000190 9825 C230      002C0         150+         LM    R2,R5,BUFCLR                                             01400000
000194 47F0 C112      001A2         151+         B     IOCOMM                                                   01410000
                                    152+*                                                                       01420000
                            00198   153+IORTN    EQU   *                                                        01430000
000198 D203 C200 3000 00290 00000   154+         MVC   IOCBFUNC,0(R3)          USE THE PASSED FUNC CD           01440000
00019E 9825 C220      002B0         155+         LM    R2,R5,BUFSCRL                                            01450000
                            001A2   156+IOCOMM   EQU   *                                                        01460000
0001A2 0E24                         157+         MVCL  R2,R4                                                    01470000
0001A4 5830 A004      00004         158+         L     R3,TTYPLOUT             MOVE LINEOUT PARM TO             01480000
0001A8 D24E C81D 3000 008AD 00000   159+         MVC   BUFFERL,0(R3)             LAST LINE IN BUFFER            01490000
0001AE 5830 A008      00008         160+         L     R3,TTYPLINP             MOVE LINEIN PARM TO              01500000
0001B2 D24C CEE9 3000 00F79 00000   161+         MVC   R23C01D,0(R3)             INPUT LINE                     01510000
0001B8 5830 A00C      0000C         162+         L     R3,TTYPERR              MOVE ERRMSG PARM TO              01520000
0001BC D24E CF39 3000 00FC9 00000   163+         MVC   R24C01D,0(R3)             MSG LINE                       01530000
                                    164+*                                                                       01540000
0001C2 4120 0014      00014         165+         LA    R2,20                                                    01550000
                                                                                                               PAGE    5


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

0001C6 4130 C881      00911         166+         LA    R3,R02C01D                                               01560000
0001CA 4140 C240      002D0         167+         LA    R4,BUFFER                                                01570000
                            001CE   168+MOVTXT   EQU   *                                                        01580000
0001CE D24E 3000 4000 00000 00000   169+         MVC   0(79,R3),0(R4)                                           01590000
0001D4 4130 3052      00052         170+         LA    R3,82(,R3)                                               01600000
0001D8 4140 404F      0004F         171+         LA    R4,79(,R4)                                               01610000
0001DC 4620 C13E      001CE         172+         BCT   R2,MOVTXT                                                01620000
0001E0 5830 A004      00004         173+         L     R3,TTYPLOUT                                              01630000
0001E4 D24E C81D 3000 008AD 00000   174+         MVC   BUFFERL,0(R3)                                            01640000
                                    175+*                                                                       01650000
                                    176+*  SET UP IOCB FOR AN IO                                                01660000
                                    177+*                                                                       01670000
0001EA 92E7 CEE6      00F76         178+         MVI   R23C01C,C'X'                  FORCE THE CURSOR           01680000
0001EE 0700                         179+         CNOP  0,4                                                      00310000
0001F0 4510 C16C      001FC         180+         BAL   R1,TCAL0011             SET UP THE PARMS                 00320000
0001F4 00000290                     181+         DC    A(IOCB)                                                  00330000
0001F8 80                           182+         DC    AL1(X'80')                                               00340000
0001F9 0008FC                       183+         DC    AL3(TPARM)                                               00350000
0001FC 58F0 C1FC      0028C         184+TCAL0011    L  R15,T3270ADR            CRT IO IS PRELOADED, PUT ADDR    00360000
000200 05EF                         185+         BALR  R14,R15                    IN R15 AND CALL               00370000
000202 5830 A010      00010         186+         L     R3,TTYPAID              MOVE THE AIDCODE                 01700000
000206 D200 3000 C87A 00000 0090A   187+         MVC   0(1,R3),TAID                                             01710000
                                    188+**** THIS LOGIC SHOULD BE PROVIDED BY CALLER                            01720000
                                    189+*        CLI   TAID,AIDPFK03            PF3 PRESSED?                    01730000
                                    190+*        BE    LEAVE                                                    01740000
                                    191+*        CLI   TAID,AIDPFK12            PF12 PRESSED?                   01750000
                                    192+*        BE    CLRINP                                                   01760000
                                    193+*                                                                       01770000
                                    194+*     PROCESS INPUT                                                     01780000
                                    195+***********************************************************             01790000
00020C 5830 A008      00008         196+         L     R3,TTYPLINP             MOVE THE INPUT LINE              01800000
000210 D24C 3000 CEE9 00000 00F79   197+         MVC   0(L'R23C01D,R3),R23C01D     TO THE 3RD PARM              01810000
000216 47F0 C1AC      0023C         198+         B     LEAVE                                                    01820000
                                    199+*                                                                       01830000
                                    200+*  SET UP IOCB FOR AN END                                               01840000
                                    201+*                                                                       01850000
                            0021A   202+EXIT     EQU   *                                                        01860000
00021A D203 C200 C1EC 00290 0027C   203+         MVC   IOCBFUNC,=C'END '                                        01870000
000220                              204+         CNOP  0,4                                                      00310000
000220 4510 C19C      0022C         205+         BAL   R1,TCAL0012             SET UP THE PARMS                 00320000
000224 00000290                     206+         DC    A(IOCB)                                                  00330000
000228 80                           207+         DC    AL1(X'80')                                               00340000
000229 0008FC                       208+         DC    AL3(TPARM)                                               00350000
00022C 58F0 C1FC      0028C         209+TCAL0012    L  R15,T3270ADR            CRT IO IS PRELOADED, PUT ADDR    00360000
000230 05EF                         210+         BALR  R14,R15                    IN R15 AND CALL               00370000
000232 9200 C200      00290         211+         MVI   IOCB,X'00'                                               01890000
000236 D21E C201 C200 00291 00290   212+         MVC   IOCB+1(IOCBLN-1),IOCB                                    01900000
                            0023C   213+LEAVE    EQU   *                                                        01910000
00023C D503 C1D0 C1D8 00260 00268   214+         CLC   USERPARM,=4X'00'        IS USERPARM NULL?                01920000
000242 4780 C1C0      00250         215+         BE    LEAVE2                                                   01930000
000246 5810 C1D0      00260         216+         L     R1,USERPARM                                              01940000
00024A D2F0 1000 CFA0 00000 01030   217+         MVC   0(VPARMLN,R1),VFUNC     MOVE PARM AREA BACK TO CALLER    01950000
000250 58D0 D004      00004         218+LEAVE2   L     13,4(0,13)          RESET TO CALLERS SAVE AREA           00000004
000254 98EC D00C      0000C         219+         LM    14,12,12(13)                      RESTORE THE REGISTERS  00650000
000258 41F0 0000      00000         220+         LA    15,0(0,0)                         LOAD RETURN CODE       01750000
                                                                                                               PAGE    6


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

00025C 07FE                         221+         BR    14                                RETURN                 02000000
000260                              222+USERPARM DS    F                                                        01970000
000268                              223+         LTORG                                                          01980000
000268 00000000                     224                =4X'00'
00026C C9D64040                     225                =C'IO  '
000270 D7C74040                     226                =C'PG  '
000274 D7E4E340                     227                =C'PUT '
000278 C3D3D940                     228                =C'CLR '
00027C C5D5C440                     229                =C'END '
000280 E2E3D9E3                     230                =C'STRT'
000284 E3F3F2F7F0C9D640             231+T3270IO  DC    CL8'T3270IO'                                             01990000
00028C 00000000                     232+T3270ADR DC    F'0'                                                     02000000
000290                              233+IOCB     DS    0F                                                       02010000
000290                              234+IOCBFUNC DS    CL4         FUNCTION CODE (STRT/IO/PG/PUT/CLR/END)       02020000
000294                              235+IOCBRC   DS    AL2                     RETURN CODE                      02030000
000296                              236+IOCBLEN  DS    AL2                     IO BUFFER LENGTH                 02040000
000298                              237+IOCBADR  DS    A                       IO BUFFER ADDRESS                02050000
00029C                              238+         DS    XL20                    RESERVED                         02060000
                            00020   239+IOCBLN   EQU   *-IOCB                                                   02070000
0002B0                              240+BUFSCRL  DS    0F                                                       02080000
0002B0 000002D0                     241+         DC    A(BUFFER)          BUFFER                                02090000
0002B4 0000062C                     242+         DC    A(20*79)                                                 02100000
0002B8 0000031F                     243+         DC    A(BUFFER+79)       2ND LINE                              02110000
0002BC 40                           244+         DC    X'40'                                                    02120000
0002BD 0005DD                       245+         DC    AL3(19*79)                                               02130000
0002C0                              246+BUFCLR   DS    0F                                                       02140000
0002C0 000002D0                     247+         DC    A(BUFFER)          BUFFER                                02150000
0002C4 0000062C                     248+         DC    A(20*79)                                                 02160000
0002C8 000002CC                     249+         DC    A(*+4)             SPACE                                 02170000
0002CC 40                           250+         DC    X'40'                                                    02180000
0002CD 000001                       251+         DC    AL3(1)                                                   02190000
0002D0 4040404040404040             252+BUFFER   DC    19CL79' '                                                02200000
0008AD 4040404040404040             253+BUFFERL  DC    CL79' '                                                  02210000
                                    254+*                                                                       02220000
                                    255+*                                                                       00000001
                                    256+*   AID CODES FOR MAP3270                                               00000002
                                    257+*                                                                       00000003
                            0007D   258+AIDENTER EQU   X'7D'   ,                                                00000004
                            0006D   259+AIDCLEAR EQU   X'6D'   -                                                00000005
                            000F0   260+AIDTSTRQ EQU   X'F0'   0                                                00000006
                            000F1   261+AIDPFK01 EQU   X'F1'   1                                                00000007
                            000F2   262+AIDPFK02 EQU   X'F2'   2                                                00000008
                            000F3   263+AIDPFK03 EQU   X'F3'   3                                                00000009
                            000F4   264+AIDPFK04 EQU   X'F4'   4                                                00000010
                            000F5   265+AIDPFK05 EQU   X'F5'   5                                                00000011
                            000F6   266+AIDPFK06 EQU   X'F6'   6                                                00000012
                            000F7   267+AIDPFK07 EQU   X'F7'   7                                                00000013
                            000F8   268+AIDPFK08 EQU   X'F8'   8                                                00000014
                            000F9   269+AIDPFK09 EQU   X'F9'   9                                                00000015
                            0007A   270+AIDPFK10 EQU   X'7A'   :                                                00000016
                            0007B   271+AIDPFK11 EQU   X'7B'   #                                                00000017
                            0007C   272+AIDPFK12 EQU   X'7C'   @                                                00000018
                            000C1   273+AIDPFK13 EQU   X'C1'   A                                                00000019
                            000C2   274+AIDPFK14 EQU   X'C2'   B                                                00000020
                            000C3   275+AIDPFK15 EQU   X'C3'   C                                                00000021
                                                                                                               PAGE    7


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                            000C4   276+AIDPFK16 EQU   X'C4'   D                                                00000022
                            000C5   277+AIDPFK17 EQU   X'C5'   E                                                00000023
                            000C6   278+AIDPFK18 EQU   X'C6'   F                                                00000024
                            000C7   279+AIDPFK19 EQU   X'C7'   G                                                00000025
                            000C8   280+AIDPFK20 EQU   X'C8'   H                                                00000026
                            000C9   281+AIDPFK21 EQU   X'C9'   I                                                00000027
                            0004A   282+AIDPFK22 EQU   X'4A'   CENT SIGN                                        00000028
                            0004B   283+AIDPFK23 EQU   X'4B'   .                                                00000029
                            0004C   284+AIDPFK24 EQU   X'4C'   <                                                00000030
                            0006C   285+AIDPA1   EQU   X'6C'   %                                                00000031
                            0006E   286+AIDPA2   EQU   X'6E'   >                                                00000032
                            0006B   287+AIDPA3   EQU   X'6B'   ,                                                00000033
                                    288+********************************************************************    00000034
                                    289+*                                                                       02240000
                                    290+** GENERATED BY MAP3270 V2.2.0   ON 211002 AT 132240920                 00000100
0008FC                              291+TPARM    DS    0F                                                       00000200
0008FC E3E3E8F3F2F7F040             292+TNAME    DC    CL8'TTY3270'                                             00000300
000904 00000000                     293+TADDR    DC    A(0)                                                     00000400
000908 0000                         294+TRC      DC    H'0'                                                     00000500
00090A 00                           295+TAID     DC    X'0'                                                     00000600
00090B 0000                         296+TSBA     DC    XL2'0000'                                                00000700
00090D 00                           297+         DC    X'0'                                                     00000800
00090E 40                           298+R02C01C  DC    C' '                    R02C01                           00000900
00090F 004F                         299+R02C01L  DC    AL2(79)                                                  00001000
000911 4B4B4B4B4B4B4B4B             300+R02C01D  DC    CL79'...................................................*00001100
000919 4B4B4B4B4B4B4B4B                +               ............................'                            00001200
000960 40                           301+R03C01C  DC    C' '                    R03C01                           00001300
000961 004F                         302+R03C01L  DC    AL2(79)                                                  00001400
000963 4B4B4B4B4B4B4B4B             303+R03C01D  DC    CL79'...................................................*00001500
00096B 4B4B4B4B4B4B4B4B                +               ............................'                            00001600
0009B2 40                           304+R04C01C  DC    C' '                    R04C01                           00001700
0009B3 004F                         305+R04C01L  DC    AL2(79)                                                  00001800
0009B5 4B4B4B4B4B4B4B4B             306+R04C01D  DC    CL79'...................................................*00001900
0009BD 4B4B4B4B4B4B4B4B                +               ............................'                            00002000
000A04 40                           307+R05C01C  DC    C' '                    R05C01                           00002100
000A05 004F                         308+R05C01L  DC    AL2(79)                                                  00002200
000A07 4B4B4B4B4B4B4B4B             309+R05C01D  DC    CL79'...................................................*00002300
000A0F 4B4B4B4B4B4B4B4B                +               ............................'                            00002400
000A56 40                           310+R06C01C  DC    C' '                    R06C01                           00002500
000A57 004F                         311+R06C01L  DC    AL2(79)                                                  00002600
000A59 4B4B4B4B4B4B4B4B             312+R06C01D  DC    CL79'...................................................*00002700
000A61 4B4B4B4B4B4B4B4B                +               ............................'                            00002800
000AA8 40                           313+R07C01C  DC    C' '                    R07C01                           00002900
000AA9 004F                         314+R07C01L  DC    AL2(79)                                                  00003000
000AAB 4B4B4B4B4B4B4B4B             315+R07C01D  DC    CL79'...................................................*00003100
000AB3 4B4B4B4B4B4B4B4B                +               ............................'                            00003200
000AFA 40                           316+R08C01C  DC    C' '                    R08C01                           00003300
000AFB 004F                         317+R08C01L  DC    AL2(79)                                                  00003400
000AFD 4B4B4B4B4B4B4B4B             318+R08C01D  DC    CL79'...................................................*00003500
000B05 4B4B4B4B4B4B4B4B                +               ............................'                            00003600
000B4C 40                           319+R09C01C  DC    C' '                    R09C01                           00003700
000B4D 004F                         320+R09C01L  DC    AL2(79)                                                  00003800
000B4F 4B4B4B4B4B4B4B4B             321+R09C01D  DC    CL79'...................................................*00003900
000B57 4B4B4B4B4B4B4B4B                +               ............................'                            00004000
000B9E 40                           322+R10C01C  DC    C' '                    R10C01                           00004100
                                                                                                               PAGE    8


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

000B9F 004F                         323+R10C01L  DC    AL2(79)                                                  00004200
000BA1 4B4B4B4B4B4B4B4B             324+R10C01D  DC    CL79'...................................................*00004300
000BA9 4B4B4B4B4B4B4B4B                +               ............................'                            00004400
000BF0 40                           325+R11C01C  DC    C' '                    R11C01                           00004500
000BF1 004F                         326+R11C01L  DC    AL2(79)                                                  00004600
000BF3 4B4B4B4B4B4B4B4B             327+R11C01D  DC    CL79'...................................................*00004700
000BFB 4B4B4B4B4B4B4B4B                +               ............................'                            00004800
000C42 40                           328+R12C01C  DC    C' '                    R12C01                           00004900
000C43 004F                         329+R12C01L  DC    AL2(79)                                                  00005000
000C45 4B4B4B4B4B4B4B4B             330+R12C01D  DC    CL79'...................................................*00005100
000C4D 4B4B4B4B4B4B4B4B                +               ............................'                            00005200
000C94 40                           331+R13C01C  DC    C' '                    R13C01                           00005300
000C95 004F                         332+R13C01L  DC    AL2(79)                                                  00005400
000C97 4B4B4B4B4B4B4B4B             333+R13C01D  DC    CL79'...................................................*00005500
000C9F 4B4B4B4B4B4B4B4B                +               ............................'                            00005600
000CE6 40                           334+R14C01C  DC    C' '                    R14C01                           00005700
000CE7 004F                         335+R14C01L  DC    AL2(79)                                                  00005800
000CE9 4B4B4B4B4B4B4B4B             336+R14C01D  DC    CL79'...................................................*00005900
000CF1 4B4B4B4B4B4B4B4B                +               ............................'                            00006000
000D38 40                           337+R15C01C  DC    C' '                    R15C01                           00006100
000D39 004F                         338+R15C01L  DC    AL2(79)                                                  00006200
000D3B 4B4B4B4B4B4B4B4B             339+R15C01D  DC    CL79'...................................................*00006300
000D43 4B4B4B4B4B4B4B4B                +               ............................'                            00006400
000D8A 40                           340+R16C01C  DC    C' '                    R16C01                           00006500
000D8B 004F                         341+R16C01L  DC    AL2(79)                                                  00006600
000D8D 4B4B4B4B4B4B4B4B             342+R16C01D  DC    CL79'...................................................*00006700
000D95 4B4B4B4B4B4B4B4B                +               ............................'                            00006800
000DDC 40                           343+R17C01C  DC    C' '                    R17C01                           00006900
000DDD 004F                         344+R17C01L  DC    AL2(79)                                                  00007000
000DDF 4B4B4B4B4B4B4B4B             345+R17C01D  DC    CL79'...................................................*00007100
000DE7 4B4B4B4B4B4B4B4B                +               ............................'                            00007200
000E2E 40                           346+R18C01C  DC    C' '                    R18C01                           00007300
000E2F 004F                         347+R18C01L  DC    AL2(79)                                                  00007400
000E31 4B4B4B4B4B4B4B4B             348+R18C01D  DC    CL79'...................................................*00007500
000E39 4B4B4B4B4B4B4B4B                +               ............................'                            00007600
000E80 40                           349+R19C01C  DC    C' '                    R19C01                           00007700
000E81 004F                         350+R19C01L  DC    AL2(79)                                                  00007800
000E83 4B4B4B4B4B4B4B4B             351+R19C01D  DC    CL79'...................................................*00007900
000E8B 4B4B4B4B4B4B4B4B                +               ............................'                            00008000
000ED2 40                           352+R20C01C  DC    C' '                    R20C01                           00008100
000ED3 004F                         353+R20C01L  DC    AL2(79)                                                  00008200
000ED5 4B4B4B4B4B4B4B4B             354+R20C01D  DC    CL79'...................................................*00008300
000EDD 4B4B4B4B4B4B4B4B                +               ............................'                            00008400
000F24 40                           355+R21C01C  DC    C' '                    R21C01                           00008500
000F25 004F                         356+R21C01L  DC    AL2(79)                                                  00008600
000F27 4B4B4B4B4B4B4B4B             357+R21C01D  DC    CL79'...................................................*00008700
000F2F 4B4B4B4B4B4B4B4B                +               ............................'                            00008800
000F76 40                           358+R23C01C  DC    C' '                    R23C01                           00008900
000F77 004D                         359+R23C01L  DC    AL2(77)                                                  00009000
000F79 4B4B4B4B4B4B4B4B             360+R23C01D  DC    CL77'...................................................*00009100
000F81 4B4B4B4B4B4B4B4B                +               ..........................'                              00009200
000FC6 40                           361+R24C01C  DC    C' '                    R24C01                           00009300
000FC7 004F                         362+R24C01L  DC    AL2(79)                                                  00009400
000FC9 4B4B4B4B4B4B4B4B             363+R24C01D  DC    CL79'...................................................*00009500
000FD1 4B4B4B4B4B4B4B4B                +               ............................'                            00009600
                                                                                                               PAGE    9


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

001018 40                           364+         DC    C' '                                                     00009700
001019 0000                         365+         DC    AL2(0)                                                   00009800
                                    366+** GENERATED BY MAP3270 V2.2.0   ON 211002 AT 132240920                 00009900
                                    367+*                                                                       02260000
00101C                              368+VPARMS   DS    0F                                                       02270000
00101C 00001030                     369+         DC    A(VFUNC)      FUNCTION CODE ADDR                         02280000
001020 00001034                     370+         DC    A(VOUTLN)     OUTPUT LINE ADDR                           02290000
001024 00001083                     371+         DC    A(VINLN)      INPUT LINE ADDR                            02300000
001028 000010D1                     372+         DC    A(VERRLN)     PROMPT/ERROR LINE (LINE 24) ADDR           02310000
00102C 80                           373+         DC    AL1(X'80')                                               02320000
00102D 001120                       374+         DC    AL3(VAID)     3270 AID CODE ADDR                         02330000
001030                              375+VFUNC    DS    CL4                                                      02340000
001034                              376+VOUTLN   DS    CL79                                                     02350000
001083                              377+VINLN    DS    CL78                                                     02360000
0010D1                              378+VERRLN   DS    CL79                                                     02370000
001120                              379+VAID     DS    C' '                                                     02380000
                            000F1   380+VPARMLN  EQU   *-VFUNC                                                  02390000
000000                              381+TTYPARMS DSECT                                                          02400000
000000                              382+TTYPFUNC DS    A             FUNCTION CODE ADDR                         02410000
000004                              383+TTYPLOUT DS    A             OUTPUT LINE ADDR                           02420000
000008                              384+TTYPLINP DS    A             INPUT LINE ADDR                            02430000
00000C                              385+TTYPERR  DS    A             PROMPT/ERROR LINE (LINE 24) ADDR           02440000
000010                              386+TTYPAID  DS    A             3270 AID CODE ADDR                         02450000
000000                              387          END   TTYRTN                                                   00810000
                                                  RELOCATION DICTIONARY                                        PAGE   10


POS.ID   REL.ID   FLAGS   ADDRESS                                                                ASM 0201 13.22 10/02/21

 0001     0001      0C     000178
 0001     0001      08     00017D
 0001     0001      0C     0001F4
 0001     0001      08     0001F9
 0001     0001      0C     000224
 0001     0001      08     000229
 0001     0001      0C     0002B0
 0001     0001      0C     0002B8
 0001     0001      0C     0002C0
 0001     0001      0C     0002C8
 0001     0001      0C     00101C
 0001     0001      0C     001020
 0001     0001      0C     001024
 0001     0001      0C     001028
 0001     0001      08     00102D
                                                  CROSS-REFERENCE                                              PAGE   11


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

BADPARMS 00001 000000C4 00085  00078 00080 00082
BUFCLR   00004 000002C0 00246  00150
BUFFER   00079 000002D0 00252  00167 00241 00243 00247
BUFFERL  00079 000008AD 00253  00159 00174
BUFSCRL  00004 000002B0 00240  00155
EXIT     00001 0000021A 00202  00126
IDS0002  00001 00000034 00036  00060
ID10002  00004 00000000 00029  00036 00055
ID20002  00008 00000005 00031  00030
ID30002  00002 0000007C 00038  00030
ID40002  00001 0000007C 00055  00029
IHB0004A 00002 000000EA 00094  00088
IOCB     00004 00000290 00233  00136 00137 00137 00141 00181 00206 00211 00212 00212 00239
IOCBFUNC 00004 00000290 00234  00138 00149 00154 00203
IOCBLN   00001 00000020 00239  00137 00212
IOCLR    00001 0000018A 00148  00124
IOCOMM   00001 000001A2 00156  00151
IORTN    00001 00000198 00153  00118 00120 00122
LEAVE    00001 0000023C 00213  00146 00198
LEAVE2   00004 00000250 00218  00215
MOVTXT   00001 000001CE 00168  00172
ONEPARM  00001 000000F2 00100  00076
PARMSOK  00001 00000104 00105  00084
R0       00001 00000000 00039  00114
R02C01D  00079 00000911 00300  00166
R1       00001 00000001 00040  00069 00107 00108 00108 00140 00180 00205 00216 00217
R10      00001 0000000A 00049  00069 00070 00104
R11      00001 0000000B 00050  00065 00066
R12      00001 0000000C 00051  00063 00064 00066
R14      00001 0000000E 00053  00145 00185 00210
R15      00001 0000000F 00054  00144 00145 00184 00185 00209 00210
R2       00001 00000002 00041  00150 00155 00157 00165 00172
R23C01C  00001 00000F76 00358  00178
R23C01D  00077 00000F79 00360  00161 00197 00197
R24C01D  00079 00000FC9 00363  00163
R3       00001 00000003 00042  00101 00102 00103 00116 00117 00119 00121 00123 00125 00127 00154 00158 00159 00160 00161
                               00162 00163 00166 00169 00170 00170 00173 00174 00186 00187 00196 00197
R4       00001 00000004 00043  00157 00167 00169 00171 00171
R5       00001 00000005 00044  00150 00155
SKIPLD   00001 0000011C 00115  00109
STRTIT   00001 00000162 00135  00128
TAID     00001 0000090A 00295  00187
TCAL0010 00004 00000180 00144  00140
TCAL0011 00004 000001FC 00184  00180
TCAL0012 00004 0000022C 00209  00205
TPARM    00004 000008FC 00291  00143 00183 00208
TTYPAID  00004 00000010 00386  00083 00186
TTYPARMS 00001 00000000 00381  00070
TTYPERR  00004 0000000C 00385  00081 00162
TTYPFUNC 00004 00000000 00382  00075 00101 00116
TTYPLINP 00004 00000008 00384  00079 00160 00196
TTYPLOUT 00004 00000004 00383  00077 00158 00173
TTYRTN   00001 00000000 00027  00387
T3270ADR 00004 0000028C 00232  00107 00114 00144 00184 00209
T3270IO  00008 00000284 00231  00111
                                                  CROSS-REFERENCE                                              PAGE   12


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

USERPARM 00004 00000260 00222  00067 00102 00214 00216
VAID     00001 00001120 00379  00374
VERRLN   00079 000010D1 00378  00372
VFUNC    00004 00001030 00375  00103 00217 00369 00380
VINLN    00078 00001083 00377  00371
VOUTLN   00079 00001034 00376  00370
VPARMLN  00001 000000F1 00380  00103 00217
VPARMS   00004 0000101C 00368  00104
                                                  LITERAL CROSS-REFERENCE                                      PAGE   13


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

=4X'00'  00001 00000268 00224  00067 00214
=C'IO  ' 00004 0000026C 00225  00117
=C'PG  ' 00004 00000270 00226  00119
=C'PUT ' 00004 00000274 00227  00121 00149
=C'CLR ' 00004 00000278 00228  00123
=C'END ' 00004 0000027C 00229  00125 00203
=C'STRT' 00004 00000280 00230  00127 00138
                                                  ASSEMBLER DIAGNOSTICS AND STATISTICS                         PAGE   14


                                                                                                 ASM 0201 13.22 10/02/21

NO STATEMENTS FLAGGED IN THIS ASSEMBLY
HIGHEST SEVERITY WAS    0
OPTIONS FOR THIS ASSEMBLY
  ALIGN, ALOGIC, BUFSIZE(STD), NODECK, ESD, FLAG(0), LINECOUNT(55), LIST, NOMCALL, YFLAG, WORKSIZE(2097152)
  NOMLOGIC, NONUMBER, OBJECT, NORENT, RLD, NOSTMT, NOLIBMAC, NOTERMINAL, NOTEST, XREF(SHORT)
  SYSPARM()
WORK FILE BUFFER SIZE/NUMBER = 8702/ 1
TOTAL RECORDS READ FROM SYSTEM INPUT          2
TOTAL RECORDS READ FROM SYSTEM LIBRARY     1764
TOTAL RECORDS PUNCHED                        78
TOTAL RECORDS PRINTED                       535

 F64-LEVEL LINKAGE EDITOR OPTIONS SPECIFIED XREF,LET,LIST
          DEFAULT OPTION(S) USED -  SIZE=(98304,55296)



                                                CROSS REFERENCE TABLE


  CONTROL SECTION                       ENTRY

    NAME    ORIGIN  LENGTH                NAME   LOCATION     NAME   LOCATION     NAME   LOCATION     NAME   LOCATION
  TTYRTN        00    1121




  LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION             LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION

 ENTRY ADDRESS       00

 TOTAL LENGTH      1128
****TTYRTN    NOW REPLACED IN DATA SET
AUTHORIZATION CODE IS         0.
                                               EXTERNAL SYMBOL DICTIONARY                                      PAGE    1


SYMBOL   TYPE  ID   ADDR  LENGTH LDID                                                            ASM 0201 13.22 10/02/21

T3270IOP  SD  0001 000000 000CD1
T327IOP   LD       000000        0001
                                                                                                               PAGE    2


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                      1 T3270IOP T3270 MODE=NORMAL,PLI=F,ALIAS=T327IOP                          00950000
                                      2+**********************************************************************  00060000
                                      3+**                                                                  **  00070000
                                      4+** MAP3270 V2.2.0 - SOFTWARE PACKAGE TO IMPLEMENT FULL SCREEN       **  00080000
                                      5+** IO FOR IBM 3270 CLASS TERMINALS.                                 **  00090000
                                      6+**                                                                  **  00100000
                                      7+**             COPYRIGHT (C) 2021  EDWARD G LISS                    **  00110000
                                      8+**                     EGLISS4024@GMAIL.COM                         **  00120000
                                      9+**                                                                  **  00130000
                                     10+** THIS PROGRAM IS FREE SOFTWARE: YOU CAN REDISTRIBUTE IT           **  00140000
                                     11+** AND/OR MODIFY IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC       **  00150000
                                     12+** LICENSE AS PUBLISHED BY THE FREE SOFTWARE FOUNDATION,            **  00160000
                                     13+** EITHER VERSION 3 OF THE LICENSE, OR ANY LATER VERSION.           **  00170000
                                     14+**                                                                  **  00180000
                                     15+** THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE          **  00190000
                                     16+** USEFUL, BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED       **  00200000
                                     17+** WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR          **  00210000
                                     18+** PURPOSE.  SEE THE GNU GENERAL PUBLIC LICENSE FOR MORE            **  00220000
                                     19+** DETAILS.                                                         **  00230000
                                     20+**                                                                  **  00240000
                                     21+** PLEASE SEE HTTPS://WWW.GNU.ORG/LICENSES/ FOR A COPY OF THE       **  00250000
                                     22+** GNU GENERAL PUBLIC LICENSE.                                      **  00260000
                                     23+**                                                                  **  00270000
                                     24+**********************************************************************  00350000
                                     25+         PUNCH ' ALIAS T327IOP'                                         00660000
                                     26+**NAME   ESTART TYPE=START,VER='2.0.0',REGS=YES,BASE=R12,               00710000
                                     27+**             DESC='3270 FULLSCREEN IO FOR PL/I(F) BUFLEN=&BUFLEN'     00720000
000000                               28+T3270IOP START                                                          00000019
                                     29+*                                                                       00000027
000000 47FF 0098      00098          30+ID10002    B     ID40002(15)           BRANCH AROUND IDENT CONSTANTS    00000039
000004 93                            31+         DC    AL1(ID30002-ID20002)                                     00000041
000005 E3F3F2F7F0C9D6D7              32+ID20002    DC    CL8'T3270IOP'                                          00000042
00000D F24BF04BF0                    33+         DC    C'2.0.0'                                                 00000043
000012 40F1F061F0F261F2              34+         DC    C' 10/02/21 13.22 - '                                    00000044
000024 F3F2F7F040C6E4D3              35+         DC    C'3270 FULLSCREEN IO FOR PL/I(F) BUFLEN=2048'            00000045
000050                               36+         DS    0F                                                       00000046
                            00050    37+IDS0002    EQU   *-ID10002                                              00000047
000050                               38+         DS    18F                                                      00000048
000098                               39+ID30002    DS    0H                                                     00000049
                            00000    40+R0       EQU   0                                                        00000007
                            00001    41+R1       EQU   1                                                        00000008
                            00002    42+R2       EQU   2                                                        00000009
                            00003    43+R3       EQU   3                                                        00000010
                            00004    44+R4       EQU   4                                                        00000011
                            00005    45+R5       EQU   5                                                        00000012
                            00006    46+R6       EQU   6                                                        00000013
                            00007    47+R7       EQU   7                                                        00000014
                            00008    48+R8       EQU   8                                                        00000015
                            00009    49+R9       EQU   9                                                        00000016
                            0000A    50+R10      EQU   10                                                       00000017
                            0000B    51+R11      EQU   11                                                       00000018
                            0000C    52+R12      EQU   12                                                       00000019
                            0000D    53+R13      EQU   13                                                       00000020
                            0000E    54+R14      EQU   14                                                       00000021
                            0000F    55+R15      EQU   15                                                       00000022
                                                                                                               PAGE    3


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                            00098    56+ID40002    EQU   *-ID10002                                              00000054
                                     57+*                                                                       00000055
000098 90EC D00C      0000C          58+         STM   14,12,12(13)                                             00000056
                                     59+*                                                                       00000057
00009C 185D                          60+         LR    5,13                COPY CALLER'S SAVEAREA ADDR          00000058
00009E 41DF 0050      00050          61+         LA    13,IDS0002(15)      ESTABLISH MY SAVEAREA                00000059
0000A2 5050 D004      00004          62+         ST    5,4(,13)            BACK CHAIN SAVE AREAS                00000060
0000A6 50D0 5008      00008          63+         ST    13,8(,5)            FORWARD CHAIN SAVE AREAS             00000061
0000AA 05C0                          64+         BALR  R12,0               ESTABLISH BASE REG VALUE             00000063
                            000AC    65+         USING *,R12                                                    00000064
                                     66+*                                                                       00750000
                                     67+*  GET ADDRESS OF PLI(F) PARM LIST. EACH ADDRESS POINTS TO A DATA       00760000
                                     68+*      CONTROL BLOCK.  OFFSET +0 OF EACH BLOCK HAS THE ACTUAL           00770000
                                     69+*      DATA                                                             00780000
                                     70+*                                                                       00790000
0000AC D203 C3CC 1004 00478 00004    71+         MVC   USERPARM,4(R1)          SAVE INTERFACE AREA              00800000
0000B2 947F C3CC      00478          72+         NI    USERPARM,X'7F'          TURN OF HIGH ORDER BIT           00810000
0000B6 5870 C3CC      00478          73+         L     R7,USERPARM                                              00820000
0000BA 5870 7000      00000          74+         L     R7,0(0,7)                                                00830000
0000BE 5070 C3CC      00478          75+         ST    R7,USERPARM                                              00840000
0000C2 5870 1000      00000          76+         L     R7,0(0,R1)              GET IOCB BLK ADDRESS             00850000
0000C6 5870 7000      00000          77+         L     R7,0(0,R7)              GET ACTUAL ADDRESS               00860000
                            00000    78+T327IOP  EQU   T3270IOP                                                 01020000
                                     79+         ENTRY T327IOP                                                  01030000
                            00000    80+         USING IOCB,R7                 ESTABLISH BR FOR IOCB            01050000
0000CA D201 7004 C3F4 00004 004A0    81+         MVC   IOCBRC,=H'0'            SET RETURN CODE TO ZERO          01060000
0000D0 D503 7000 C3DC 00000 00488    82+         CLC   IOCBFUNC,=C'STRT'       IS IT A STRT?                    01070000
0000D6 4770 C07A      00126          83+         BNE   NOTSTRT                                                  01080000
0000DA 5820 7008      00008          84+         L     R2,IOCBADR             IOCBADR MUST BE ZEROS FOR STRT    01090000
0000DE 1222                          85+         LTR   R2,R2                                                    01100000
0000E0 4780 C042      000EE          86+         BZ    STRTOK                                                   01110000
                                     87+**       WTO   'MAP3270-&NAME INVALID STRT',ROUTCDE=11                  01120000
                                     88+**       ABEND &UCODE,,,USER                                            01130000
0000E4 D201 7004 C3F6 00004 004A2    89+         MVC   IOCBRC,=H'8'            SET RC TO 8 AND EXIT             01140000
0000EA 47F0 C36E      0041A          90+         B     LEAVE                                                    01150000
                            000EE    91+STRTOK   EQU   *                                                        01160000
                                     92+**       STFSMODE ON,INITIAL=YES                                        01170000
0000EE 4110 00C0      000C0          93+         LA    1,128+64                 FLAGS FOR MODE/INITIAL CALL     01400000
0000F2 8910 0018      00018          94+         SLL   1,24                     SHIFT TO HIGH ORDER BYTE        01450000
0000F6 4100 0012      00012          95+         LA    0,18                     LOAD ENTRY CODE                 01700000
0000FA 8900 0018      00018          96+         SLL   0,24                     SHIFT TO HIGH ORDER BYTE        01750000
0000FE 0A5E                          97+         SVC   94                       TERMINAL CONTROL MACRO SVC      01800000
                                     98+**       STTMPMD ON,KEYS=ALL                                            01190000
000100 4110 00C0      000C0          99+         LA    1,128+64                 SET PARM FLAGS                  01800001
000104 8910 0018      00018         100+         SLL   1,24                     SHIFT TO HIGH ORDER BYTE        01850001
000108 4100 0014      00014         101+         LA    0,20                     LOAD ENTRY CODE                 01900001
00010C 8900 0018      00018         102+         SLL   0,24                     SHIFT TO HIGH ORDER BYTE        01950001
000110 0A5E                         103+         SVC   94                       TERMINAL CONTROL MACRO SVC      02000001
000112 4120 C425      004D1         104+         LA    R2,INBUF                COPY ADDRESS OF                  01210000
000116 5020 7008      00008         105+         ST    R2,IOCBADR                INBUF TO                       01220000
00011A 4120 0800      00800         106+         LA    R2,INBUFLN                   CONTROL                     01230000
00011E 4020 7006      00006         107+         STH   R2,IOCBLEN                     BLOCK                     01240000
000122 47F0 C36E      0041A         108+         B     LEAVE                                                    01250000
                            00126   109+NOTSTRT  EQU   *                                                        01260000
000126 D503 7000 C3E0 00000 0048C   110+         CLC   IOCBFUNC,=C'END '                                        01270000
                                                                                                               PAGE    4


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

00012C 4770 C0A6      00152         111+         BNE   NOTEND                                                   01280000
000130 5820 7008      00008         112+         L     R2,IOCBADR             IOCBADR MUST BE NON ZERO FOR END  01290000
000134 1222                         113+         LTR   R2,R2                                                    01300000
000136 4770 C098      00144         114+         BNZ   ENDOK                                                    01310000
                                    115+**       WTO   'MAP3270-&NAME INVALID END',ROUTCDE=11                   01320000
                                    116+**       ABEND &UCODE,,,USER                                            01330000
00013A D201 7004 C3F8 00004 004A4   117+         MVC   IOCBRC,=H'12'            SET RC TO 12 AND EXIT           01340000
000140 47F0 C36E      0041A         118+         B     LEAVE                                                    01350000
                            00144   119+ENDOK    EQU   *                                                        01360000
000144 9200 7000      00000         120+         MVI   IOCB,X'00'                                               01370000
000148 D21D 7001 7000 00001 00000   121+         MVC   IOCB+1(IOCBLN-2),IOCB                                    01380000
00014E 47F0 C334      003E0         122+         B     EXIT                                                     01390000
                            00152   123+NOTEND   EQU   *                                                        01400000
000152 D503 7000 C3E4 00000 00490   124+         CLC   IOCBFUNC,=C'PUT '                                        01410000
000158 4780 C0CE      0017A         125+         BE    FUNCOK                                                   01420000
00015C D503 7000 C3E8 00000 00494   126+         CLC   IOCBFUNC,=C'IO  '                                        01430000
000162 4780 C0CE      0017A         127+         BE    FUNCOK                                                   01440000
000166 D503 7000 C3EC 00000 00498   128+         CLC   IOCBFUNC,=C'PG  '                                        01450000
00016C 4780 C0CE      0017A         129+         BE    FUNCOK                                                   01460000
000170 D201 7004 C3FA 00004 004A6   130+         MVC   IOCBRC,=H'4'       SET RC TO 4 - INVALID FUNCTION        01470000
000176 47F0 C36E      0041A         131+         B     LEAVE                                                    01480000
                            0017A   132+FUNCOK   EQU   *                                                        01490000
                                    133+*                                                                       01500000
                                    134+*                                                                       01610000
                                    135+*   GET THE ADDRESSES OF THE USERPARM, THE PANEL AND THE MAPPING TBL    01620000
                                    136+*                                                                       01630000
00017A 58B0 C3CC      00478         137+         L     R11,USERPARM        GET ADDR OF USER PARM AREA           01640000
                            00000   138+         USING USRPARM,R11                                              01650000
                                    139+*                                                                       01660000
00017E 0700                         140+         CNOP  0,4                                                      00400002
000180 4100 B000      00000         141+         LA    0,USRPNAM          LOAD PARAMETER INTO REG 0             00800002
000184 5810 C0E0      0018C         142+         L     1,*+8              NO DCB, RETURN CODE REQUESTED         01700002
000188 47F0 C0E4      00190         143+         B     *+8                BRANCH AROUND CONSTANT                01800002
00018C 80000000                     144+         DC    X'80000000'        RETURN CODE REQUESTED                 01850002
000190 0A08                         145+         SVC   8                                                        01200002
000192 12FF                         146+         LTR   15,15              RETURN CODE TEST                      01300002
000194 4770 C368      00414         147+         BNZ   LOADFAIL         GO TO ERROR ROUTINE                     01400002
000198 5000 B008      00008         148+         ST    R0,USRPADR                                               01680000
                                    149+*                                                                       01690000
00019C 4120 B012      00012         150+         LA    R2,USRTBL           GET ADDR OF USER TABLE               01700000
                            00000   151+         USING USRMAP,R2                                                01710000
                                    152+*                                                                       01720000
0001A0 58A0 B008      00008         153+         L     R10,USRPADR         GET PANEL LOAD MODULE ADDRESS        01730000
0001A4 5810 A000      00000         154+         L     R1,0(0,R10)         GET PANEL ADDRESS                    01740000
0001A8 5010 C3D0      0047C         155+         ST    R1,PANLADDR                                              01750000
0001AC 5810 A008      00008         156+         L     R1,8(0,R10)         GET ADDR OF CURSOR                   01760000
0001B0 D201 1000 C3FC 00000 004A8   157+         MVC   0(2,R1),=X'4040'    RESET BUFFER ADDR                    01770000
0001B6 D501 B00F C3FE 0000F 004AA   158+         CLC   UCUR,=X'0000'       IF THE CURSOR IS NULL                01780000
0001BC 4780 C11A      001C6         159+         BE    DEFLTSBA              DON'T MOVE IT                      01790000
0001C0 D201 1000 B00F 00000 0000F   160+         MVC   0(2,R1),UCUR        MOVE THE PASSED BUFF ADDR            01800000
                            001C6   161+DEFLTSBA EQU   *                                                        01810000
0001C6 5830 A004      00004         162+         L     R3,4(0,R10)         GET ADDR OF OUTPUT MAPPING           01820000
0001CA 5030 C3D4      00480         163+         ST    R3,MAPADDR                                               01830000
                            00000   164+         USING TINPMAP,R3                                               01840000
0001CE D501 3000 C3FE 00000 004AA   165+         CLC   TISBA,=X'0000'      IS THE END OF TABLE FIRST ITEM?      01850000
                                                                                                               PAGE    5


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

0001D4 4780 C178      00224         166+         BZ    DONEOUT             YES, BRANCH                          01860000
                            001D8   167+LOOPOUT  EQU *                                                          01870000
0001D8 D501 2001 3002 00001 00002   168+         CLC   USRLEN,TILEN        COMPARE OUTLN:MAPLN                  01880000
0001DE 4770 C16E      0021A         169+         BNE   NOMATCH             BRANCH IF MISMATCH                   01890000
0001E2 4840 3002      00002         170+         LH    R4,TILEN            GEN LENGTH                           01900000
0001E6 1244                         171+         LTR   R4,R4               ZERO?                                01910000
0001E8 4780 C178      00224         172+         BZ    DONEOUT             YES, BRANCH                          01920000
0001EC 0640                         173+         BCTR  R4,R0                                                    01930000
0001EE 5850 3004      00004         174+         L     R5,TIFLD                                                 01940000
0001F2 4440 C168      00214         175+         EX    R4,MVCOUT                                                01950000
0001F6 9540 2000      00000         176+         CLI   USRCUR,X'40'        IS CURSOR FLAG SET?                  01960000
0001FA 47D0 C15C      00208         177+         BNH   NEXTFLD             NO, BRANCH                           01970000
0001FE D201 1000 3000 00000 00000   178+         MVC   0(2,R1),TISBA       MOVE THE PASSED BUFF ADDR            01980000
000204 9240 2000      00000         179+         MVI   USRCUR,X'40'        RESET USER CURSOR FLAG               01990000
                            00208   180+NEXTFLD  EQU   *                                                        02000000
000208 4124 2004      00004         181+         LA    R2,4(R4,R2)                                              02010000
00020C 4130 3008      00008         182+         LA    R3,TINPMAPL(0,R3)                                        02020000
000210 47F0 C12C      001D8         183+         B     LOOPOUT                                                  02030000
000214 D200 5000 2003 00000 00003   184+MVCOUT   MVC 0(0,R5),USRFLD                                             02040000
                            0021A   185+NOMATCH  EQU *                                                          02050000
                                    186+**       WTO   'MAP3270-&NAME MAP MATCH ERROR',ROUTCDE=11               02060000
                                    187+**       ABEND &UCODE,,,USER                                            02070000
00021A D201 7004 C400 00004 004AC   188+         MVC   IOCBRC,=H'16'          PHYS AND SYMB MAP DIFF LEN        02080000
000220 47F0 C36E      0041A         189+         B     LEAVE                                                    02090000
                            00224   190+DONEOUT  EQU *                                                          02100000
000224 58A0 C3D0      0047C         191+         L     R10,PANLADDR                                             02110000
000228 4830 A000      00000         192+         LH    R3,0(0,R10)                                              02120000
00022C 4B30 C402      004AE         193+         SH    R3,=H'2'                                                 02130000
                                    194+**       TPUT  2(R10),(R3),FULLSCR                                      02140000
000230                              195+         DS    0H                       TJID IS '0'                     22800003
000230 1803                         196+         LR    0,R3                     LOAD BUFFER SIZE                23450003
000232 0700                         197+         CNOP  0,4                                                      23700003
000234                              198+         CNOP  0,4                                             @OZ65329 23785636
000234 47F0 C18E      0023A         199+         B     *+6                                             @OZ65329 23828436
000238 0300                         200+         DC    AL1(3,0)                 OPTION BITS AND PAD    @OZ65329 23871236
00023A 411A 0002      00002         201+         LA    1,2(R10)                 LOAD POINTER TO BUFFER @OZ65329 23914036
00023E BF18 C18C      00238         202+         ICM   1,8,*-6                  GET OPTION BYTE        @OZ65329 23956836
000242 0A5D                         203+         SVC   93                       ISSUE TGET/TPUT SVC             21200003

000244 12FF                         205+         LTR   R15,R15                 CHECK FOR FAILURE                02160000
000246 4770 C1B2      0025E         206+         BNZ   TPUTERR                 YES, BRANCH                      02170000
00024A D503 7000 C3E4 00000 00490   207+         CLC   IOCBFUNC,=C'PUT '       IF PUT ONLY,                     02180000
000250 4770 C1BE      0026A         208+         BNE   NOTPUT                    CLEAR UAID AND CURSOR          02190000
000254 D202 B00E C412 0000E 004BE   209+         MVC   UAID(3),=3X'00'             AND RETURN                   02200000
00025A 47F0 C36E      0041A         210+         B     LEAVE                                                    02210000
                            0025E   211+TPUTERR  EQU   *                                                        02220000
                                    212+**       WTO   'MAP3270-&NAME TPUT RC XX (DEC)',ROUTCDE=11              02230000
                                    213+**       ABEND &UCODE,,,USER                                            02240000
00025E 4AF0 C404      004B0         214+         AH    R15,=H'100'             ADD 100 TO TPUT RC               02250000
000262 40F0 7004      00004         215+         STH   R15,IOCBRC                                               02260000
000266 47F0 C36E      0041A         216+         B     LEAVE                                                    02270000
                            0026A   217+NOTPUT   EQU   *                                                        02280000
00026A D503 7000 C3EC 00000 00498   218+         CLC   IOCBFUNC,=C'PG  '       IF PG OR IO                      02290000
000270 4780 C1DC      00288         219+         BE    DOGET                      CONTINUE TO TGET              02300000
000274 D503 7000 C3E8 00000 00494   220+         CLC   IOCBFUNC,=C'IO  '       OTHERWISE                        02310000
                                                                                                               PAGE    6


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

00027A 4780 C1DC      00288         221+         BE    DOGET                      ABORT                         02320000
                                    222+**       WTO   'MAP3270-&NAME INVALID FUNCTION',ROUTCDE=11              02330000
                                    223+**       ABEND &UCODE,,,USER                                            02340000
00027E D201 7004 C3FA 00004 004A6   224+         MVC   IOCBRC,=H'4'                                             02350000
000284 47F0 C36E      0041A         225+         B     LEAVE                                                    02360000
                            00288   226+DOGET    EQU   *                                                        02370000
000288 9200 C425      004D1         227+         MVI   INBUF,X'00'                                              02380000
00028C D2FE C426 C425 004D2 004D1   228+         MVC   INBUF+1(255),INBUF                                       02390000
                                    229+*                                                                       02400000
                                    230+**       TGET  INBUF,INBUFLN,ASIS                                       02410000
000292 0700                         231+         CNOP  0,4                                             @OZ46729 44885036
000294                              232+         DS    0F                                              @OZ46729 44903836
000294 47F0 C1F0      0029C         233+         B     *+8                     BRANCH AROUND CONSTANTS @OZ48875 44922636
000298 8100                         234+         DC    AL1(129,0)              OPTION BYTE AND FILLER  @OZ48875 44941436
00029A 0800                         235+         DC    AL2(INBUFLN)             BUFFER SIZE                @01P 44960403
00029C 5800 C1EC      00298         236+         L     0,*-4                    LOAD SIZE              @OZ48875 44985536
0002A0 4110 C425      004D1         237+         LA    1,INBUF                  LOAD BUFFER ADDRESS    @OZ48875 45010636
0002A4 BF18 C1EC      00298         238+         ICM   1,8,*-12                 LOAD OPTION BYTE       @OZ48875 45035736
0002A8 BF08 C1ED      00299         239+         ICM   0,8,*-15                 CLEAR HIGH ORDER BYTE  @OZ51683 45060836
0002AC 0A5D                         240+         SVC   93                       ISSUE SVC                  @01P 45086003

0002AE 12FF                         242+         LTR   R15,R15            CHECK FOR FAILURE                     02430000
0002B0 4780 C214      002C0         243+         BZ    TGETOK             NO, BRANCH                            02440000
                                    244+**       WTO   'MAP3270-&NAME TGET RC XX (DEC)',ROUTCDE=11              02450000
                                    245+**       ABEND &UCODE,,,USER                                            02460000
0002B4 4AF0 C406      004B2         246+         AH    R15,=H'200'                                              02470000
0002B8 40F0 7004      00004         247+         STH   R15,IOCBRC                                               02480000
0002BC 47F0 C36E      0041A         248+         B     LEAVE                                                    02490000
                            002C0   249+TGETOK   EQU   *                                                        02500000
0002C0 D202 B00E C425 0000E 004D1   250+         MVC   UAID(3),INBUF       MOVE THE AID AND CUR                 02510000
                                    251+**********************************************************************  02710000
                                    252+*                                                                    *  02720000
                                    253+*  THE BUFFER RETURNED BY TGET HAS EACH FIELD RETURNED WITH A 3      *  02730000
                                    254+*  BYTE PREFIX - X'11' PLUS BUFFER ADDRESS.                          *  02740000
                                    255+*                                                                    *  02750000
                                    256+*  TO MAP BACK TO THE USER AREA, THERE IS A XREF MAP GENERATED AS    *  02760000
                                    257+*  PART OF THE PANEL.  THIS XREF HAS THE BUFFER ADDR, THE ADDR OF    *  02770000
                                    258+*  THE USER FIELD AND THE MAX LENGTH OF THE FIELD.  NOTE THAT THIS   *  02780000
                                    259+*  ROUTINE DOES NOT MAP BACK TO THE PANEL BUT TO THE USER AREA.      *  02790000
                                    260+*                                                                    *  02800000
                                    261+**********************************************************************  02810000
0002C6 4120 B012      00012         262+         LA    R2,USRTBL           GET TO THE USER TABLE                02820000
0002CA 4160 C428      004D4         263+         LA    R6,INBUF+3                                               02830000
0002CE 4190 03C0      003C0         264+         LA    R9,MAXFLDS          LIMIT INPUT FIELDS TO MAX POSSIBLE   02840000
                                    265+**                                 TO PREVENT RUNAWAY LOOPS             02850000
0002D2 5830 C3D4      00480         266+         L     R3,MAPADDR                                               02860000
0002D6 D501 3000 C3FE 00000 004AA   267+         CLC   TISBA,=X'0000'      SEE IF 1ST DATA FIELD IS END OF TAB. 02870000
0002DC 4780 C330      003DC         268+         BE    ALLDONE             IF SO, BRANCH TO EXIT.               02880000
                            002E0   269+LOOPIN   EQU *                                                          02890000
0002E0 5830 C3D4      00480         270+         L     R3,MAPADDR                                               02900000
                                    271+*                                                                       02910000
                                    272+*  FIND THE BUFFER ADDRESS IN THE XREF TABLE.                           02920000
                                    273+*                                                                       02930000
0002E4 9511 6000      00000         274+         CLI   0(R6),X'11'         CHECK FOR SBA                        02940000
0002E8 4780 C252      002FE         275+         BE    FNDSBA              IF SO, CONTINUE                      02950000
                                                                                                               PAGE    7


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

0002EC 9500 6000      00000         276+         CLI   0(R6),X'00'         END OF MESSAGE FROM 3270?            02960000
0002F0 4780 C2E2      0038E         277+         BE    DONEIN                                                   02970000
                                    278+**       WTO   'MAP3270-&NAME INVALID INPUT MSG',ROUTCDE=11             02980000
                                    279+**       ABEND &UCODE,,,USER                                            02990000
0002F4 D201 7004 C408 00004 004B4   280+         MVC   IOCBRC,=H'20'                                            03000000
0002FA 47F0 C36E      0041A         281+         B     LEAVE                                                    03010000
                            002FE   282+FNDSBA   EQU   *                                                        03020000
0002FE D501 3000 6001 00000 00001   283+         CLC   TISBA,1(R6)         COMPARE THE SBA.                     03030000
000304 4780 C274      00320         284+         BE    FNDTSBA             IF SO, BRANCH                        03040000
000308 4130 3008      00008         285+         LA    R3,TINPMAPL(,R3)    TRY NEXT ENTRY                       03050000
00030C D501 3000 C3FE 00000 004AA   286+         CLC   TISBA,=X'0000'      TEST FOR END OF TABLE                03060000
000312 4770 C252      002FE         287+         BNE   FNDSBA              IF NOT END,  TRY NEXT THIS ENTRY     03070000
                                    288+**       WTO   'MAP3270-&NAME INPUT MAPPING ERROR',ROUTCDE=11           03080000
                                    289+**       ABEND &UCODE,DUMP,,USER                                        03090000
000316 D201 7004 C40A 00004 004B6   290+         MVC   IOCBRC,=H'24'                                            03100000
00031C 47F0 C36E      0041A         291+         B     LEAVE                                                    03110000
                            00320   292+FNDTSBA  EQU   *                                                        03120000
                                    293+*                                                                       03130000
                                    294+*   CALCULATE THE LENGTH OF THE DATAFIELD                               03140000
                                    295+*                                                                       03150000
000320 4180 6003      00003         296+         LA    R8,3(,R6)              GET ADDR OF 1ST BYTE              03160000
000324 9511 8000      00000         297+NXTSBA   CLI   0(R8),X'11'            IF THIS AN SBA?                   03170000
000328 4780 C290      0033C         298+         BE    GOTLEN                 YES, BRANCH                       03180000
00032C 9500 8000      00000         299+         CLI   0(R8),X'00'            IF END OF MSG?                    03190000
000330 4780 C290      0033C         300+         BE    GOTLEN                                                   03200000
000334 4180 8001      00001         301+         LA    R8,1(,R8)              BUMP UP THE CHARACTER             03210000
000338 47F0 C278      00324         302+         B     NXTSBA                                                   03220000
                            0033C   303+GOTLEN   EQU   *                                                        03230000
00033C 1B86                         304+         SR    R8,R6                  CALCULATE FLD LEN                 03240000
00033E 5B80 C3F0      0049C         305+         S     R8,=F'3'                                                 03250000
                                    306+*                                                                       03260000
000342 4840 3002      00002         307+         LH    R4,TILEN               GEN LENGTH                        03270000
000346 1244                         308+         LTR   R4,R4                  ZERO?                             03280000
000348 4780 C2E2      0038E         309+         BZ    DONEIN                 YES, BRANCH                       03290000
00034C 0640                         310+         BCTR  R4,0                                                     03300000
00034E 5850 3004      00004         311+         L     R5,TIFLD                                                 03310000
000352 4440 C2D2      0037E         312+         EX    R4,MVCSP                                                 03320000
000356 4840 3002      00002         313+         LH    R4,TILEN               GEN LENGTH                        03330000
00035A 1984                         314+         CR    R8,R4                                                    03340000
00035C 4780 C2BA      00366         315+         BE    LENOK                                                    03350000
000360 4720 C2BA      00366         316+         BH    LENOK                                                    03360000
000364 1848                         317+         LR    R4,R8                                                    03370000
                            00366   318+LENOK    EQU   *                                                        03380000
000366 0640                         319+         BCTR  R4,R0                                                    03390000
000368 4440 C2CC      00378         320+         EX    R4,MVCIN                                                 03400000
00036C 4168 6003      00003         321+         LA    R6,3(R8,R6)                                              03410000
000370 4690 C234      002E0         322+         BCT   R9,LOOPIN                                                03420000
000374 47F0 C2E2      0038E         323+         B     DONEIN                 ONLY PROCESS LIMITED FIELDS       03430000
000378 D200 5000 6003 00000 00003   324+MVCIN    MVC   0(0,R5),3(R6)                                            03440000
00037E D200 5000 C37C 00000 00428   325+MVCSP    MVC   0(0,R5),SPACES                                           03450000
                            00384   326+NOMATCHI EQU *                                                          03460000
                                    327+**       WTO   'MAP3270-&NAME MAPPING ERROR',ROUTCDE=11                 03470000
                                    328+**       ABEND &UCODE,DUMP,,USER                                        03480000
000384 D201 7004 C40C 00004 004B8   329+         MVC   IOCBRC,=H'28'                                            03490000
00038A 47F0 C36E      0041A         330+         B     LEAVE                                                    03500000
                                                                                                               PAGE    8


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                            0038E   331+DONEIN   EQU *                                                          03510000
                                    332+****     B     ALLDONE                                                  03520000
                                    333+*                                                                       03530000
                                    334+*  MAP DATA BACK TO USER AREA                                           03540000
                                    335+*                                                                       03550000
00038E 4190 03C0      003C0         336+         LA    R9,MAXFLDS     LIMIT INPUT FIELDS                        03560000
000392 58A0 C3D0      0047C         337+         L     R10,PANLADDR                                             03570000
000396 4120 B012      00012         338+         LA    R2,USRTBL           GET ADDR OF USER TABLE               03580000
00039A 5830 C3D4      00480         339+         L     R3,MAPADDR                                               03590000
                            00000   340+         USING TINPMAP,R3                                               03600000
                            0039E   341+LOOPRET  EQU *                                                          03610000
00039E D501 2001 3002 00001 00002   342+         CLC   USRLEN,TILEN        COMPARE OUTLN:MAPLN                  03620000
0003A4 4770 C326      003D2         343+         BNE   NOMATCHR            BRANCH IF MISMATCH                   03630000
0003A8 4840 3002      00002         344+         LH    R4,TILEN            GEN LENGTH                           03640000
0003AC 1244                         345+         LTR   R4,R4               ZERO?                                03650000
0003AE 4780 C330      003DC         346+         BZ    ALLDONE             YES, BRANCH                          03660000
0003B2 0640                         347+         BCTR  R4,R0                                                    03670000
0003B4 5850 3004      00004         348+         L     R5,TIFLD                                                 03680000
0003B8 4440 C320      003CC         349+         EX    R4,MVCRET                                                03690000
0003BC 4124 2004      00004         350+         LA    R2,4(R4,R2)                                              03700000
0003C0 4130 3008      00008         351+         LA    R3,TINPMAPL(0,R3)                                        03710000
0003C4 4690 C2F2      0039E         352+         BCT   R9,LOOPRET                                               03720000
0003C8 47F0 C330      003DC         353+         B     ALLDONE                                                  03730000
0003CC D200 2003 5000 00003 00000   354+MVCRET   MVC   USRFLD(0),0(R5)                                          03740000
                            003D2   355+NOMATCHR EQU *                                                          03750000
                                    356+**       WTO   'MAP3270-&NAME MAP BACK ERROR',ROUTCDE=11                03760000
                                    357+**       ABEND &UCODE,,,USER                                            03770000
0003D2 D201 7004 C40E 00004 004BA   358+         MVC   IOCBRC,=H'32'                                            03780000
0003D8 47F0 C36E      0041A         359+         B     LEAVE                                                    03790000
                                    360+****                                                                    03800000
                            003DC   361+ALLDONE  EQU   *                                                        03810000
0003DC 47F0 C36E      0041A         362+         B     LEAVE                                                    03870000
                                    363+**IT     STLINENO LINE=1                                                03890000
0003E0 4110 0001      00001         364+EXIT     LA    1,1                      PUT LINE NUM IN PARM REG        01400000
0003E4 1B00                         365+         SR    0,0                      PREPARE FLAG BYTE               02130000
0003E6 1610                         366+         OR    1,0                      SET MODE=OFF FLAG IN REG 1      02140000
0003E8 4100 0013      00013         367+         LA    0,19                     LOAD ENTRY CODE                 02200000
0003EC 8900 0018      00018         368+         SLL   0,24                     SHIFT TO HIGH ORDER BYTE        02250000
0003F0 0A5E                         369+         SVC   94                       TERMINAL CONTROL MACRO SVC      02300000
                                    370+**       STFSMODE OFF                                                   03910000
0003F2 1B11                         371+         SR    1,1                      CLEAR PARAMETER REGISTER        01600000
0003F4 4100 0012      00012         372+         LA    0,18                     LOAD ENTRY CODE                 01700000
0003F8 8900 0018      00018         373+         SLL   0,24                     SHIFT TO HIGH ORDER BYTE        01750000
0003FC 0A5E                         374+         SVC   94                       TERMINAL CONTROL MACRO SVC      01800000
                                    375+**       STTMPMD OFF                                                    03930000
0003FE 4110 0000      00000         376+         LA    1,0+0                    SET PARM FLAGS                  01800001
000402 8910 0018      00018         377+         SLL   1,24                     SHIFT TO HIGH ORDER BYTE        01850001
000406 4100 0014      00014         378+         LA    0,20                     LOAD ENTRY CODE                 01900001
00040A 8900 0018      00018         379+         SLL   0,24                     SHIFT TO HIGH ORDER BYTE        01950001
00040E 0A5E                         380+         SVC   94                       TERMINAL CONTROL MACRO SVC      02000001
000410 47F0 C36E      0041A         381+         B     LEAVE                                                    03950000
                            00414   382+LOADFAIL EQU   *                                                        03960000
000414 D201 7004 C410 00004 004BC   383+         MVC   IOCBRC,=H'300'         INDICATE LOAD FAILED              03970000
                            0041A   384+LEAVE    EQU   *                                                        03980000
00041A 58D0 D004      00004         385+         L     13,4(0,13)          RESET TO CALLERS SAVE AREA           00000004
                                                                                                               PAGE    9


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

00041E 98EC D00C      0000C         386+         LM    14,12,12(13)                      RESTORE THE REGISTERS  00650000
000422 41F0 0000      00000         387+         LA    15,0(0,0)                         LOAD RETURN CODE       01750000
000426 07FE                         388+         BR    14                                RETURN                 02000000
                                    389+*                                                                       04000000
000428 4040404040404040             390+SPACES   DC    CL80' '                                                  04010000
000478                              391+USERPARM DS    F                                                        04400000
00047C                              392+PANLADDR DS    F                                                        04410000
000480                              393+MAPADDR  DS    F                                                        04420000
000484 0001                         394+ONE      DC    H'1'                                                     04430000
000488                              395+         LTORG                                                          04440000
000488 E2E3D9E3                     396                =C'STRT'
00048C C5D5C440                     397                =C'END '
000490 D7E4E340                     398                =C'PUT '
000494 C9D64040                     399                =C'IO  '
000498 D7C74040                     400                =C'PG  '
00049C 00000003                     401                =F'3'
0004A0 0000                         402                =H'0'
0004A2 0008                         403                =H'8'
0004A4 000C                         404                =H'12'
0004A6 0004                         405                =H'4'
0004A8 4040                         406                =X'4040'
0004AA 0000                         407                =X'0000'
0004AC 0010                         408                =H'16'
0004AE 0002                         409                =H'2'
0004B0 0064                         410                =H'100'
0004B2 00C8                         411                =H'200'
0004B4 0014                         412                =H'20'
0004B6 0018                         413                =H'24'
0004B8 001C                         414                =H'28'
0004BA 0020                         415                =H'32'
0004BC 012C                         416                =H'300'
0004BE 000000                       417                =3X'00'
0004C1 5C5CE2E3C1D9E340             418+         DC    CL16'**START INBUF**'                                    04450000
0004D1                              419+INBUF    DS    CL2048                                                   04460000
                            00800   420+INBUFLN  EQU   2048                                                     04470000
                            003C0   421+MAXFLDS  EQU   960                                                      04480000
                                    422+*        T3270D                                                         04500000
000000                              423+IOCB     DSECT                                                          00300000
000000                              424+IOCBFUNC DS    CL4                     FUNCTION CODE (STRT/IO/END)      00310000
000004                              425+IOCBRC   DS    AL2                     RETURN CODE                      00320000
000006                              426+IOCBLEN  DS    AL2                     IO BUFFER LENGTH                 00330000
000008                              427+IOCBADR  DS    A                       IO BUFFER ADDRESS                00340000
00000C                              428+         DS    XL20                    RESERVED                         00350000
                            00020   429+IOCBLN   EQU   *-IOCB                                                   00360000
                                    430+*                                                                       00380000
000000                              431+USRPARM  DSECT                                                          00390000
000000                              432+USRPNAM  DS   CL8                      PANEL NAME                       00400000
000008                              433+USRPADR  DS   A                        PANEL CORE ADDR                  00410000
00000C                              434+URC      DS   H                        IO RETURN CODE                   00420000
00000E                              435+UAID     DS   X                        AID                              00430000
00000F                              436+UCUR     DS   XL2                      CURSOR                           00440000
000011                              437+         DS   X                        RESERVED                         00450000
000012                              438+USRTBL   DS   H                        FLD LENGTH                       00460000
                                    439+*                                                                       00470000
000000                              440+USRMAP   DSECT                                                          00480000
                                                                                                               PAGE   10


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

000000                              441+USRCUR   DS    C                                                        00490000
000001                              442+USRLEN   DS    AL2                                                      00500000
000003                              443+USRFLD   DS    C                                                        00510000
                                    444+*                                                                       00520000
000000                              445+TINPMAP  DSECT                                                          00530000
000000                              446+TISBA    DS    AL2                                                      00540000
000002                              447+TILEN    DS    AL2                                                      00550000
000004                              448+TIFLD    DS    AL4                                                      00560000
                            00008   449+TINPMAPL EQU   *-TINPMAP                                                00570000
                                    450          END                                                            00960000
                                                  CROSS-REFERENCE                                              PAGE   11


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

ALLDONE  00001 000003DC 00361  00268 00346 00353
DEFLTSBA 00001 000001C6 00161  00159
DOGET    00001 00000288 00226  00219 00221
DONEIN   00001 0000038E 00331  00277 00309 00323
DONEOUT  00001 00000224 00190  00166 00172
ENDOK    00001 00000144 00119  00114
EXIT     00004 000003E0 00364  00122
FNDSBA   00001 000002FE 00282  00275 00287
FNDTSBA  00001 00000320 00292  00284
FUNCOK   00001 0000017A 00132  00125 00127 00129
GOTLEN   00001 0000033C 00303  00298 00300
IDS0002  00001 00000050 00037  00061
ID10002  00004 00000000 00030  00037 00056
ID20002  00008 00000005 00032  00031
ID30002  00002 00000098 00039  00031
ID40002  00001 00000098 00056  00030
INBUF    02048 000004D1 00419  00104 00227 00228 00228 00237 00250 00263
INBUFLN  00001 00000800 00420  00106 00235
IOCB     00001 00000000 00423  00080 00120 00121 00121 00429
IOCBADR  00004 00000008 00427  00084 00105 00112
IOCBFUNC 00004 00000000 00424  00082 00110 00124 00126 00128 00207 00218 00220
IOCBLEN  00002 00000006 00426  00107
IOCBLN   00001 00000020 00429  00121
IOCBRC   00002 00000004 00425  00081 00089 00117 00130 00188 00215 00224 00247 00280 00290 00329 00358 00383
LEAVE    00001 0000041A 00384  00090 00108 00118 00131 00189 00210 00216 00225 00248 00281 00291 00330 00359 00362 00381
LENOK    00001 00000366 00318  00315 00316
LOADFAIL 00001 00000414 00382  00147
LOOPIN   00001 000002E0 00269  00322
LOOPOUT  00001 000001D8 00167  00183
LOOPRET  00001 0000039E 00341  00352
MAPADDR  00004 00000480 00393  00163 00266 00270 00339
MAXFLDS  00001 000003C0 00421  00264 00336
MVCIN    00006 00000378 00324  00320
MVCOUT   00006 00000214 00184  00175
MVCRET   00006 000003CC 00354  00349
MVCSP    00006 0000037E 00325  00312
NEXTFLD  00001 00000208 00180  00177
NOMATCH  00001 0000021A 00185  00169
NOMATCHR 00001 000003D2 00355  00343
NOTEND   00001 00000152 00123  00111
NOTPUT   00001 0000026A 00217  00208
NOTSTRT  00001 00000126 00109  00083
NXTSBA   00004 00000324 00297  00302
PANLADDR 00004 0000047C 00392  00155 00191 00337
R0       00001 00000000 00040  00148 00173 00319 00347
R1       00001 00000001 00041  00071 00076 00154 00155 00156 00157 00160 00178
R10      00001 0000000A 00050  00153 00154 00156 00162 00191 00192 00201 00337
R11      00001 0000000B 00051  00137 00138
R12      00001 0000000C 00052  00064 00065
R15      00001 0000000F 00055  00205 00205 00214 00215 00242 00242 00246 00247
R2       00001 00000002 00042  00084 00085 00085 00104 00105 00106 00107 00112 00113 00113 00150 00151 00181 00181 00262
                               00338 00350 00350
R3       00001 00000003 00043  00162 00163 00164 00182 00182 00192 00193 00196 00266 00270 00285 00285 00339 00340 00351
                               00351
R4       00001 00000004 00044  00170 00171 00171 00173 00175 00181 00307 00308 00308 00310 00312 00313 00314 00317 00319
                                                  CROSS-REFERENCE                                              PAGE   12


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

                               00320 00344 00345 00345 00347 00349 00350
R5       00001 00000005 00045  00174 00184 00311 00324 00325 00348 00354
R6       00001 00000006 00046  00263 00274 00276 00283 00296 00304 00321 00321 00324
R7       00001 00000007 00047  00073 00074 00075 00076 00077 00077 00080
R8       00001 00000008 00048  00296 00297 00299 00301 00301 00304 00305 00314 00317 00321
R9       00001 00000009 00049  00264 00322 00336 00352
SPACES   00080 00000428 00390  00325
STRTOK   00001 000000EE 00091  00086
TGETOK   00001 000002C0 00249  00243
TIFLD    00004 00000004 00448  00174 00311 00348
TILEN    00002 00000002 00447  00168 00170 00307 00313 00342 00344
TINPMAP  00001 00000000 00445  00164 00340 00449
TINPMAPL 00001 00000008 00449  00182 00285 00351
TISBA    00002 00000000 00446  00165 00178 00267 00283 00286
TPUTERR  00001 0000025E 00211  00206
T327IOP  00001 00000000 00078  00079
T3270IOP 00001 00000000 00028  00078
UAID     00001 0000000E 00435  00209 00250
UCUR     00002 0000000F 00436  00158 00160
USERPARM 00004 00000478 00391  00071 00072 00073 00075 00137
USRCUR   00001 00000000 00441  00176 00179
USRFLD   00001 00000003 00443  00184 00354
USRLEN   00002 00000001 00442  00168 00342
USRMAP   00001 00000000 00440  00151
USRPADR  00004 00000008 00433  00148 00153
USRPARM  00001 00000000 00431  00138
USRPNAM  00008 00000000 00432  00141
USRTBL   00002 00000012 00438  00150 00262 00338
                                                  LITERAL CROSS-REFERENCE                                      PAGE   13


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

=C'STRT' 00004 00000488 00396  00082
=C'END ' 00004 0000048C 00397  00110
=C'PUT ' 00004 00000490 00398  00124 00207
=C'IO  ' 00004 00000494 00399  00126 00220
=C'PG  ' 00004 00000498 00400  00128 00218
=F'3'    00004 0000049C 00401  00305
=H'0'    00002 000004A0 00402  00081
=H'8'    00002 000004A2 00403  00089
=H'12'   00002 000004A4 00404  00117
=H'4'    00002 000004A6 00405  00130 00224
=X'4040' 00002 000004A8 00406  00157
=X'0000' 00002 000004AA 00407  00158 00165 00267 00286
=H'16'   00002 000004AC 00408  00188
=H'2'    00002 000004AE 00409  00193
=H'100'  00002 000004B0 00410  00214
=H'200'  00002 000004B2 00411  00246
=H'20'   00002 000004B4 00412  00280
=H'24'   00002 000004B6 00413  00290
=H'28'   00002 000004B8 00414  00329
=H'32'   00002 000004BA 00415  00358
=H'300'  00002 000004BC 00416  00383
=3X'00'  00001 000004BE 00417  00209
                                                  ASSEMBLER DIAGNOSTICS AND STATISTICS                         PAGE   14


                                                                                                 ASM 0201 13.22 10/02/21

NO STATEMENTS FLAGGED IN THIS ASSEMBLY
HIGHEST SEVERITY WAS    0
OPTIONS FOR THIS ASSEMBLY
  ALIGN, ALOGIC, BUFSIZE(STD), NODECK, ESD, FLAG(0), LINECOUNT(55), LIST, NOMCALL, YFLAG, WORKSIZE(2097152)
  NOMLOGIC, NONUMBER, OBJECT, NORENT, RLD, NOSTMT, NOLIBMAC, NOTERMINAL, NOTEST, XREF(SHORT)
  SYSPARM()
WORK FILE BUFFER SIZE/NUMBER = 8702/ 1
TOTAL RECORDS READ FROM SYSTEM INPUT          2
TOTAL RECORDS READ FROM SYSTEM LIBRARY     2263
TOTAL RECORDS PUNCHED                        26
TOTAL RECORDS PRINTED                       596

 F64-LEVEL LINKAGE EDITOR OPTIONS SPECIFIED XREF,LET,LIST
          DEFAULT OPTION(S) USED -  SIZE=(98304,55296)
IEW0000     ALIAS T327IOP



                                                CROSS REFERENCE TABLE


  CONTROL SECTION                       ENTRY

    NAME    ORIGIN  LENGTH                NAME   LOCATION     NAME   LOCATION     NAME   LOCATION     NAME   LOCATION
  T3270IOP      00     CD1
                                        T327IOP       00

 ENTRY ADDRESS       00

 TOTAL LENGTH       CD8
****T3270IOP  NOW REPLACED IN DATA SET
****T327IOP   IS AN ALIAS FOR THIS MEMBER
AUTHORIZATION CODE IS         0.
                                               EXTERNAL SYMBOL DICTIONARY                                      PAGE    1


SYMBOL   TYPE  ID   ADDR  LENGTH LDID                                                            ASM 0201 13.22 10/02/21

TTYRTNP   SD  0001 000000 001111
                                                                                                               PAGE    2


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                      1 TTYRTNP  TTYRTN PLI=F                                                   01050000
                                      2+**********************************************************************  00030000
                                      3+**                                                                  **  00040000
                                      4+** MAP3270 V2.2.0 - SOFTWARE PACKAGE TO IMPLEMENT FULL SCREEN       **  00050000
                                      5+** IO FOR IBM 3270 CLASS TERMINALS.                                 **  00060000
                                      6+**                                                                  **  00070000
                                      7+**             COPYRIGHT (C) 2021  EDWARD G LISS                    **  00080000
                                      8+**                     EGLISS4024@GMAIL.COM                         **  00090000
                                      9+**                                                                  **  00100000
                                     10+** THIS PROGRAM IS FREE SOFTWARE: YOU CAN REDISTRIBUTE IT           **  00110000
                                     11+** AND/OR MODIFY IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC       **  00120000
                                     12+** LICENSE AS PUBLISHED BY THE FREE SOFTWARE FOUNDATION,            **  00130000
                                     13+** EITHER VERSION 3 OF THE LICENSE, OR ANY LATER VERSION.           **  00140000
                                     14+**                                                                  **  00150000
                                     15+** THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE          **  00160000
                                     16+** USEFUL, BUT WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED       **  00170000
                                     17+** WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR          **  00180000
                                     18+** PURPOSE.  SEE THE GNU GENERAL PUBLIC LICENSE FOR MORE            **  00190000
                                     19+** DETAILS.                                                         **  00200000
                                     20+**                                                                  **  00210000
                                     21+** PLEASE SEE HTTPS://WWW.GNU.ORG/LICENSES/ FOR A COPY OF THE       **  00220000
                                     22+** GNU GENERAL PUBLIC LICENSE.                                      **  00230000
                                     23+**                                                                  **  00240000
                                     24+**********************************************************************  00260000
                                     25+**AME    ESTART TYPE=START,DESC='3270 TTY ROUTINE FOR PL/I(F)',         00340000
                                     26+**             VER='2.0.0',REGS=YES,BASE=R12                            00350000
000000                               27+TTYRTNP  START                                                          00000019
                                     28+*                                                                       00000027
000000 47FF 0088      00088          29+ID10002    B     ID40002(15)           BRANCH AROUND IDENT CONSTANTS    00000039
000004 83                            30+         DC    AL1(ID30002-ID20002)                                     00000041
000005 E3E3E8D9E3D5D740              31+ID20002    DC    CL8'TTYRTNP'                                           00000042
00000D F24BF04BF0                    32+         DC    C'2.0.0'                                                 00000043
000012 40F1F061F0F261F2              33+         DC    C' 10/02/21 13.22 - '                                    00000044
000024 F3F2F7F040E3E3E8              34+         DC    C'3270 TTY ROUTINE FOR PL/I(F)'                          00000045
000040                               35+         DS    0F                                                       00000046
                            00040    36+IDS0002    EQU   *-ID10002                                              00000047
000040                               37+         DS    18F                                                      00000048
000088                               38+ID30002    DS    0H                                                     00000049
                            00000    39+R0       EQU   0                                                        00000007
                            00001    40+R1       EQU   1                                                        00000008
                            00002    41+R2       EQU   2                                                        00000009
                            00003    42+R3       EQU   3                                                        00000010
                            00004    43+R4       EQU   4                                                        00000011
                            00005    44+R5       EQU   5                                                        00000012
                            00006    45+R6       EQU   6                                                        00000013
                            00007    46+R7       EQU   7                                                        00000014
                            00008    47+R8       EQU   8                                                        00000015
                            00009    48+R9       EQU   9                                                        00000016
                            0000A    49+R10      EQU   10                                                       00000017
                            0000B    50+R11      EQU   11                                                       00000018
                            0000C    51+R12      EQU   12                                                       00000019
                            0000D    52+R13      EQU   13                                                       00000020
                            0000E    53+R14      EQU   14                                                       00000021
                            0000F    54+R15      EQU   15                                                       00000022
                            00088    55+ID40002    EQU   *-ID10002                                              00000054
                                                                                                               PAGE    3


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                     56+*                                                                       00000055
000088 90EC D00C      0000C          57+         STM   14,12,12(13)                                             00000056
                                     58+*                                                                       00000057
00008C 185D                          59+         LR    5,13                COPY CALLER'S SAVEAREA ADDR          00000058
00008E 41DF 0040      00040          60+         LA    13,IDS0002(15)      ESTABLISH MY SAVEAREA                00000059
000092 5050 D004      00004          61+         ST    5,4(,13)            BACK CHAIN SAVE AREAS                00000060
000096 50D0 5008      00008          62+         ST    13,8(,5)            FORWARD CHAIN SAVE AREAS             00000061
00009A 05C0                          63+         BALR  R12,0               ESTABLISH BASE REG VALUE             00000063
                            0009C    64+         USING *,R12                                                    00000064
                            0109A    65+         USING *+4094,R11                                               00380000
00009C 41BC 0FFE      00FFE          66+         LA    R11,4094(R12)                                            00390000
0000A0 18A1                          67+         LR    R10,R1                  SAVE THE PARMADDR                00400000
                            00000    68+         USING TTYPARMS,R10                                             00410000
                                     69+*                                                                       00420000
                                     70+*    VERIFY THE PARM - PARM LIST MUST BE ONE BLOCK OF 5 ITEMS.          00430000
                                     71+*      IF ONE, REFORMAT TO LOOK LIKE 5 ITEMS.                           00440000
                                     72+*                                                                       00450000
0000A2 9180 A000      00000          73+         TM    TTYPFUNC,X'80'          ONLY 1 PARM?                     00460000
0000A6 4710 C03E      000DA          74+         BO    ONEPARM                 YES, BRANCH                      00470000
                            000AA    75+BADPARMS EQU   *                                                        00480000
                                     76+**       WTO   'MAP3270-&NAME PARM ERROR',ROUTCDE=11                    00490000
0000AA 0700                          77+         CNOP  0,4                                                      09800002
0000AC 4510 C036      000D2          78+         BAL   1,IHB0004A                        BRANCH AROUND MESSAGE  09850002
0000B0 001E                          79+         DC    AL2(30)             TEXT LENGTH                          13200002
0000B2 8000                          80+         DC    B'1000000000000000' MCS FLAGS                            13250002
0000B4 D4C1D7F3F2F7F060              81+         DC    C'MAP3270-TTYRTNP PARM ERROR'                            13350002
0000CE 0000                          82+         DC    B'0000000000000000' DESCRIPTOR CODES                     13450002
0000D0 0020                          83+         DC    B'0000000000100000' ROUTING CODES                        13500002
0000D2                               84+IHB0004A DS    0H                                                       15850002
0000D2 0A23                          85+         SVC   35                                                       15950002
                                     86+**       ABEND 3270,,,USER                 OTHERWISE ABORT              00510000
0000D4                               87+         DS    0H                                                       00400002
0000D4 4110 0CC6      00CC6          88+         LA    1,3270                            LOAD PARAMETER REG 1   01900002
0000D8 0A0D                          89+         SVC   13                 LINK TO ABEND ROUTINE                 02050002
                            000DA    90+ONEPARM  EQU   *                                                        00530000
                                     91+*                                                                       00540000
                                     92+*  GET ADDRESS OF PLI(F) PARM LIST. EACH ADDRESS POINTS TO A DATA       00550000
                                     93+*      CONTROL BLOCK.  OFFSET +0 OF EACH BLOCK HAS THE ACTUAL           00560000
                                     94+*      DATA                                                             00570000
                                     95+*                                                                       00580000
0000DA D203 C1B8 1000 00254 00000    96+         MVC   USERPARM,0(R1)          SAVE INTERFACE AREA              00590000
0000E0 947F C1B8      00254          97+         NI    USERPARM,X'7F'          TURN OF HIGH ORDER BIT           00600000
0000E4 58A0 C1B8      00254          98+         L     R10,USERPARM                                             00610000
0000E8 58A0 A000      00000          99+         L     R10,0(0,R10)                                             00620000
0000EC 50A0 C1B8      00254         100+         ST    R10,USERPARM                                             00630000
0000F0 D2F0 CF84 A000 01020 00000   101+         MVC   VFUNC(VPARMLN),0(R10)     MOVE THE REQUEST BLOCK         00640000
0000F6 41A0 CF70      0100C         102+         LA    R10,VPARMS                                               00650000
                            000FA   103+PARMSOK  EQU   *                                                        01060000
                                    104+*                                                                       01070000
0000FA 5810 C1E0      0027C         105+         L     R1,T3270ADR                                              01080000
0000FE 1211                         106+         LTR   R1,R1                                                    01090000
000100 4770 C074      00110         107+         BNZ   SKIPLD                                                   01100000
000104                              108+         CNOP  0,4                                                      00400002
000104 4100 C1D8      00274         109+         LA    0,T3270IO          LOAD PARAMETER INTO REG 0             00800002
000108 1B11                         110+         SR    1,1                SHOW NO DCB PRESENT                   01000002
                                                                                                               PAGE    4


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

00010A 0A08                         111+         SVC   8                                                        01200002
00010C 5000 C1E0      0027C         112+         ST    R0,T3270ADR                                              01120000
                            00110   113+SKIPLD   EQU   *                                                        01130000
000110 5830 A000      00000         114+         L     R3,TTYPFUNC             GET THE FIRST PARM - FUNCTION    01140000
000114 D503 3000 C1BC 00000 00258   115+         CLC   0(4,R3),=C'IO  '         IO REQUEST?                     01150000
00011A 4780 C0F0      0018C         116+         BE    IORTN                   YES, BRANCH                      01160000
00011E D503 3000 C1C0 00000 0025C   117+         CLC   0(4,R3),=C'PG  '         IO REQUEST?                     01170000
000124 4780 C0F0      0018C         118+         BE    IORTN                   YES, BRANCH                      01180000
000128 D503 3000 C1C4 00000 00260   119+         CLC   0(4,R3),=C'PUT '         PUT REQUEST?                    01190000
00012E 4780 C0F0      0018C         120+         BE    IORTN                   YES, BRANCH                      01200000
000132 D503 3000 C1C8 00000 00264   121+         CLC   0(4,R3),=C'CLR '         PUT REQUEST?                    01210000
000138 4780 C0E2      0017E         122+         BE    IOCLR                   YES, BRANCH                      01220000
00013C D503 3000 C1CC 00000 00268   123+         CLC   0(4,R3),=C'END '         END IT?                         01230000
000142 4780 C172      0020E         124+         BE    EXIT                    YES, BRANCH                      01240000
000146 D503 3000 C1D0 00000 0026C   125+         CLC   0(4,R3),=C'STRT'         START IT?                       01250000
00014C 4780 C0BA      00156         126+         BE    STRTIT                  YES, BRANCH                      01260000
000150                              127+         DS    0H                                                       00400002
000150 4110 0014      00014         128+         LA    1,20                              LOAD PARAMETER REG 1   01900002
000154 0A0D                         129+         SVC   13                 LINK TO ABEND ROUTINE                 02050002
                                    130+*                                                                       01280000
                                    131+*  INITIALIZE THE IOCB AND SET IT UP FOR AN STRT                        01290000
                                    132+*                                                                       01300000
                            00156   133+STRTIT   EQU   *                                                        01310000
000156 9200 C1E4      00280         134+         MVI   IOCB,X'00'                                               01320000
00015A D21E C1E5 C1E4 00281 00280   135+         MVC   IOCB+1(IOCBLN-1),IOCB                                    01330000
000160 D203 C1E4 C1D0 00280 0026C   136+         MVC   IOCBFUNC,=C'STRT'                                        01340000
000166 0700                         137+         CNOP  0,4                                                      00310000
000168 4510 C0D8      00174         138+         BAL   R1,TCAL0010             SET UP THE PARMS                 00320000
00016C 00000280                     139+         DC    A(IOCB)                                                  00330000
000170 80                           140+         DC    AL1(X'80')                                               00340000
000171 0008EC                       141+         DC    AL3(TPARM)                                               00350000
000174 58F0 C1E0      0027C         142+TCAL0010    L  R15,T3270ADR            CRT IO IS PRELOADED, PUT ADDR    00360000
000178 05EF                         143+         BALR  R14,R15                    IN R15 AND CALL               00370000
00017A 47F0 C194      00230         144+         B     LEAVE                                                    01360000
                                    145+*                                                                       01370000
                            0017E   146+IOCLR    EQU   *                                                        01380000
00017E D203 C1E4 C1C4 00280 00260   147+         MVC   IOCBFUNC,=C'PUT '        USE THE FUNC CD                 01390000
000184 9825 C214      002B0         148+         LM    R2,R5,BUFCLR                                             01400000
000188 47F0 C0FA      00196         149+         B     IOCOMM                                                   01410000
                                    150+*                                                                       01420000
                            0018C   151+IORTN    EQU   *                                                        01430000
00018C D203 C1E4 3000 00280 00000   152+         MVC   IOCBFUNC,0(R3)          USE THE PASSED FUNC CD           01440000
000192 9825 C204      002A0         153+         LM    R2,R5,BUFSCRL                                            01450000
                            00196   154+IOCOMM   EQU   *                                                        01460000
000196 0E24                         155+         MVCL  R2,R4                                                    01470000
000198 5830 A004      00004         156+         L     R3,TTYPLOUT             MOVE LINEOUT PARM TO             01480000
00019C D24E C801 3000 0089D 00000   157+         MVC   BUFFERL,0(R3)             LAST LINE IN BUFFER            01490000
0001A2 5830 A008      00008         158+         L     R3,TTYPLINP             MOVE LINEIN PARM TO              01500000
0001A6 D24C CECD 3000 00F69 00000   159+         MVC   R23C01D,0(R3)             INPUT LINE                     01510000
0001AC 5830 A00C      0000C         160+         L     R3,TTYPERR              MOVE ERRMSG PARM TO              01520000
0001B0 D24E CF1D 3000 00FB9 00000   161+         MVC   R24C01D,0(R3)             MSG LINE                       01530000
                                    162+*                                                                       01540000
0001B6 4120 0014      00014         163+         LA    R2,20                                                    01550000
0001BA 4130 C865      00901         164+         LA    R3,R02C01D                                               01560000
0001BE 4140 C224      002C0         165+         LA    R4,BUFFER                                                01570000
                                                                                                               PAGE    5


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                            001C2   166+MOVTXT   EQU   *                                                        01580000
0001C2 D24E 3000 4000 00000 00000   167+         MVC   0(79,R3),0(R4)                                           01590000
0001C8 4130 3052      00052         168+         LA    R3,82(,R3)                                               01600000
0001CC 4140 404F      0004F         169+         LA    R4,79(,R4)                                               01610000
0001D0 4620 C126      001C2         170+         BCT   R2,MOVTXT                                                01620000
0001D4 5830 A004      00004         171+         L     R3,TTYPLOUT                                              01630000
0001D8 D24E C801 3000 0089D 00000   172+         MVC   BUFFERL,0(R3)                                            01640000
                                    173+*                                                                       01650000
                                    174+*  SET UP IOCB FOR AN IO                                                01660000
                                    175+*                                                                       01670000
0001DE 92E7 CECA      00F66         176+         MVI   R23C01C,C'X'                  FORCE THE CURSOR           01680000
0001E2 0700                         177+         CNOP  0,4                                                      00310000
0001E4 4510 C154      001F0         178+         BAL   R1,TCAL0011             SET UP THE PARMS                 00320000
0001E8 00000280                     179+         DC    A(IOCB)                                                  00330000
0001EC 80                           180+         DC    AL1(X'80')                                               00340000
0001ED 0008EC                       181+         DC    AL3(TPARM)                                               00350000
0001F0 58F0 C1E0      0027C         182+TCAL0011    L  R15,T3270ADR            CRT IO IS PRELOADED, PUT ADDR    00360000
0001F4 05EF                         183+         BALR  R14,R15                    IN R15 AND CALL               00370000
0001F6 5830 A010      00010         184+         L     R3,TTYPAID              MOVE THE AIDCODE                 01700000
0001FA D200 3000 C85E 00000 008FA   185+         MVC   0(1,R3),TAID                                             01710000
                                    186+**** THIS LOGIC SHOULD BE PROVIDED BY CALLER                            01720000
                                    187+*        CLI   TAID,AIDPFK03            PF3 PRESSED?                    01730000
                                    188+*        BE    LEAVE                                                    01740000
                                    189+*        CLI   TAID,AIDPFK12            PF12 PRESSED?                   01750000
                                    190+*        BE    CLRINP                                                   01760000
                                    191+*                                                                       01770000
                                    192+*     PROCESS INPUT                                                     01780000
                                    193+***********************************************************             01790000
000200 5830 A008      00008         194+         L     R3,TTYPLINP             MOVE THE INPUT LINE              01800000
000204 D24C 3000 CECD 00000 00F69   195+         MVC   0(L'R23C01D,R3),R23C01D     TO THE 3RD PARM              01810000
00020A 47F0 C194      00230         196+         B     LEAVE                                                    01820000
                                    197+*                                                                       01830000
                                    198+*  SET UP IOCB FOR AN END                                               01840000
                                    199+*                                                                       01850000
                            0020E   200+EXIT     EQU   *                                                        01860000
00020E D203 C1E4 C1CC 00280 00268   201+         MVC   IOCBFUNC,=C'END '                                        01870000
000214                              202+         CNOP  0,4                                                      00310000
000214 4510 C184      00220         203+         BAL   R1,TCAL0012             SET UP THE PARMS                 00320000
000218 00000280                     204+         DC    A(IOCB)                                                  00330000
00021C 80                           205+         DC    AL1(X'80')                                               00340000
00021D 0008EC                       206+         DC    AL3(TPARM)                                               00350000
000220 58F0 C1E0      0027C         207+TCAL0012    L  R15,T3270ADR            CRT IO IS PRELOADED, PUT ADDR    00360000
000224 05EF                         208+         BALR  R14,R15                    IN R15 AND CALL               00370000
000226 9200 C1E4      00280         209+         MVI   IOCB,X'00'                                               01890000
00022A D21E C1E5 C1E4 00281 00280   210+         MVC   IOCB+1(IOCBLN-1),IOCB                                    01900000
                            00230   211+LEAVE    EQU   *                                                        01910000
000230 D503 C1B8 C1D4 00254 00270   212+         CLC   USERPARM,=4X'00'        IS USERPARM NULL?                01920000
000236 4780 C1A8      00244         213+         BE    LEAVE2                                                   01930000
00023A 5810 C1B8      00254         214+         L     R1,USERPARM                                              01940000
00023E D2F0 1000 CF84 00000 01020   215+         MVC   0(VPARMLN,R1),VFUNC     MOVE PARM AREA BACK TO CALLER    01950000
000244 58D0 D004      00004         216+LEAVE2   L     13,4(0,13)          RESET TO CALLERS SAVE AREA           00000004
000248 98EC D00C      0000C         217+         LM    14,12,12(13)                      RESTORE THE REGISTERS  00650000
00024C 41F0 0000      00000         218+         LA    15,0(0,0)                         LOAD RETURN CODE       01750000
000250 07FE                         219+         BR    14                                RETURN                 02000000
000254                              220+USERPARM DS    F                                                        01970000
                                                                                                               PAGE    6


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

000258                              221+         LTORG                                                          01980000
000258 C9D64040                     222                =C'IO  '
00025C D7C74040                     223                =C'PG  '
000260 D7E4E340                     224                =C'PUT '
000264 C3D3D940                     225                =C'CLR '
000268 C5D5C440                     226                =C'END '
00026C E2E3D9E3                     227                =C'STRT'
000270 00000000                     228                =4X'00'
000274 E3F3F2F7F0C9D640             229+T3270IO  DC    CL8'T3270IO'                                             01990000
00027C 00000000                     230+T3270ADR DC    F'0'                                                     02000000
000280                              231+IOCB     DS    0F                                                       02010000
000280                              232+IOCBFUNC DS    CL4         FUNCTION CODE (STRT/IO/PG/PUT/CLR/END)       02020000
000284                              233+IOCBRC   DS    AL2                     RETURN CODE                      02030000
000286                              234+IOCBLEN  DS    AL2                     IO BUFFER LENGTH                 02040000
000288                              235+IOCBADR  DS    A                       IO BUFFER ADDRESS                02050000
00028C                              236+         DS    XL20                    RESERVED                         02060000
                            00020   237+IOCBLN   EQU   *-IOCB                                                   02070000
0002A0                              238+BUFSCRL  DS    0F                                                       02080000
0002A0 000002C0                     239+         DC    A(BUFFER)          BUFFER                                02090000
0002A4 0000062C                     240+         DC    A(20*79)                                                 02100000
0002A8 0000030F                     241+         DC    A(BUFFER+79)       2ND LINE                              02110000
0002AC 40                           242+         DC    X'40'                                                    02120000
0002AD 0005DD                       243+         DC    AL3(19*79)                                               02130000
0002B0                              244+BUFCLR   DS    0F                                                       02140000
0002B0 000002C0                     245+         DC    A(BUFFER)          BUFFER                                02150000
0002B4 0000062C                     246+         DC    A(20*79)                                                 02160000
0002B8 000002BC                     247+         DC    A(*+4)             SPACE                                 02170000
0002BC 40                           248+         DC    X'40'                                                    02180000
0002BD 000001                       249+         DC    AL3(1)                                                   02190000
0002C0 4040404040404040             250+BUFFER   DC    19CL79' '                                                02200000
00089D 4040404040404040             251+BUFFERL  DC    CL79' '                                                  02210000
                                    252+*                                                                       02220000
                                    253+*                                                                       00000001
                                    254+*   AID CODES FOR MAP3270                                               00000002
                                    255+*                                                                       00000003
                            0007D   256+AIDENTER EQU   X'7D'   ,                                                00000004
                            0006D   257+AIDCLEAR EQU   X'6D'   -                                                00000005
                            000F0   258+AIDTSTRQ EQU   X'F0'   0                                                00000006
                            000F1   259+AIDPFK01 EQU   X'F1'   1                                                00000007
                            000F2   260+AIDPFK02 EQU   X'F2'   2                                                00000008
                            000F3   261+AIDPFK03 EQU   X'F3'   3                                                00000009
                            000F4   262+AIDPFK04 EQU   X'F4'   4                                                00000010
                            000F5   263+AIDPFK05 EQU   X'F5'   5                                                00000011
                            000F6   264+AIDPFK06 EQU   X'F6'   6                                                00000012
                            000F7   265+AIDPFK07 EQU   X'F7'   7                                                00000013
                            000F8   266+AIDPFK08 EQU   X'F8'   8                                                00000014
                            000F9   267+AIDPFK09 EQU   X'F9'   9                                                00000015
                            0007A   268+AIDPFK10 EQU   X'7A'   :                                                00000016
                            0007B   269+AIDPFK11 EQU   X'7B'   #                                                00000017
                            0007C   270+AIDPFK12 EQU   X'7C'   @                                                00000018
                            000C1   271+AIDPFK13 EQU   X'C1'   A                                                00000019
                            000C2   272+AIDPFK14 EQU   X'C2'   B                                                00000020
                            000C3   273+AIDPFK15 EQU   X'C3'   C                                                00000021
                            000C4   274+AIDPFK16 EQU   X'C4'   D                                                00000022
                            000C5   275+AIDPFK17 EQU   X'C5'   E                                                00000023
                                                                                                               PAGE    7


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                            000C6   276+AIDPFK18 EQU   X'C6'   F                                                00000024
                            000C7   277+AIDPFK19 EQU   X'C7'   G                                                00000025
                            000C8   278+AIDPFK20 EQU   X'C8'   H                                                00000026
                            000C9   279+AIDPFK21 EQU   X'C9'   I                                                00000027
                            0004A   280+AIDPFK22 EQU   X'4A'   CENT SIGN                                        00000028
                            0004B   281+AIDPFK23 EQU   X'4B'   .                                                00000029
                            0004C   282+AIDPFK24 EQU   X'4C'   <                                                00000030
                            0006C   283+AIDPA1   EQU   X'6C'   %                                                00000031
                            0006E   284+AIDPA2   EQU   X'6E'   >                                                00000032
                            0006B   285+AIDPA3   EQU   X'6B'   ,                                                00000033
                                    286+********************************************************************    00000034
                                    287+*                                                                       02240000
                                    288+** GENERATED BY MAP3270 V2.2.0   ON 211002 AT 132240920                 00000100
0008EC                              289+TPARM    DS    0F                                                       00000200
0008EC E3E3E8F3F2F7F040             290+TNAME    DC    CL8'TTY3270'                                             00000300
0008F4 00000000                     291+TADDR    DC    A(0)                                                     00000400
0008F8 0000                         292+TRC      DC    H'0'                                                     00000500
0008FA 00                           293+TAID     DC    X'0'                                                     00000600
0008FB 0000                         294+TSBA     DC    XL2'0000'                                                00000700
0008FD 00                           295+         DC    X'0'                                                     00000800
0008FE 40                           296+R02C01C  DC    C' '                    R02C01                           00000900
0008FF 004F                         297+R02C01L  DC    AL2(79)                                                  00001000
000901 4B4B4B4B4B4B4B4B             298+R02C01D  DC    CL79'...................................................*00001100
000909 4B4B4B4B4B4B4B4B                +               ............................'                            00001200
000950 40                           299+R03C01C  DC    C' '                    R03C01                           00001300
000951 004F                         300+R03C01L  DC    AL2(79)                                                  00001400
000953 4B4B4B4B4B4B4B4B             301+R03C01D  DC    CL79'...................................................*00001500
00095B 4B4B4B4B4B4B4B4B                +               ............................'                            00001600
0009A2 40                           302+R04C01C  DC    C' '                    R04C01                           00001700
0009A3 004F                         303+R04C01L  DC    AL2(79)                                                  00001800
0009A5 4B4B4B4B4B4B4B4B             304+R04C01D  DC    CL79'...................................................*00001900
0009AD 4B4B4B4B4B4B4B4B                +               ............................'                            00002000
0009F4 40                           305+R05C01C  DC    C' '                    R05C01                           00002100
0009F5 004F                         306+R05C01L  DC    AL2(79)                                                  00002200
0009F7 4B4B4B4B4B4B4B4B             307+R05C01D  DC    CL79'...................................................*00002300
0009FF 4B4B4B4B4B4B4B4B                +               ............................'                            00002400
000A46 40                           308+R06C01C  DC    C' '                    R06C01                           00002500
000A47 004F                         309+R06C01L  DC    AL2(79)                                                  00002600
000A49 4B4B4B4B4B4B4B4B             310+R06C01D  DC    CL79'...................................................*00002700
000A51 4B4B4B4B4B4B4B4B                +               ............................'                            00002800
000A98 40                           311+R07C01C  DC    C' '                    R07C01                           00002900
000A99 004F                         312+R07C01L  DC    AL2(79)                                                  00003000
000A9B 4B4B4B4B4B4B4B4B             313+R07C01D  DC    CL79'...................................................*00003100
000AA3 4B4B4B4B4B4B4B4B                +               ............................'                            00003200
000AEA 40                           314+R08C01C  DC    C' '                    R08C01                           00003300
000AEB 004F                         315+R08C01L  DC    AL2(79)                                                  00003400
000AED 4B4B4B4B4B4B4B4B             316+R08C01D  DC    CL79'...................................................*00003500
000AF5 4B4B4B4B4B4B4B4B                +               ............................'                            00003600
000B3C 40                           317+R09C01C  DC    C' '                    R09C01                           00003700
000B3D 004F                         318+R09C01L  DC    AL2(79)                                                  00003800
000B3F 4B4B4B4B4B4B4B4B             319+R09C01D  DC    CL79'...................................................*00003900
000B47 4B4B4B4B4B4B4B4B                +               ............................'                            00004000
000B8E 40                           320+R10C01C  DC    C' '                    R10C01                           00004100
000B8F 004F                         321+R10C01L  DC    AL2(79)                                                  00004200
000B91 4B4B4B4B4B4B4B4B             322+R10C01D  DC    CL79'...................................................*00004300
                                                                                                               PAGE    8


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

000B99 4B4B4B4B4B4B4B4B                +               ............................'                            00004400
000BE0 40                           323+R11C01C  DC    C' '                    R11C01                           00004500
000BE1 004F                         324+R11C01L  DC    AL2(79)                                                  00004600
000BE3 4B4B4B4B4B4B4B4B             325+R11C01D  DC    CL79'...................................................*00004700
000BEB 4B4B4B4B4B4B4B4B                +               ............................'                            00004800
000C32 40                           326+R12C01C  DC    C' '                    R12C01                           00004900
000C33 004F                         327+R12C01L  DC    AL2(79)                                                  00005000
000C35 4B4B4B4B4B4B4B4B             328+R12C01D  DC    CL79'...................................................*00005100
000C3D 4B4B4B4B4B4B4B4B                +               ............................'                            00005200
000C84 40                           329+R13C01C  DC    C' '                    R13C01                           00005300
000C85 004F                         330+R13C01L  DC    AL2(79)                                                  00005400
000C87 4B4B4B4B4B4B4B4B             331+R13C01D  DC    CL79'...................................................*00005500
000C8F 4B4B4B4B4B4B4B4B                +               ............................'                            00005600
000CD6 40                           332+R14C01C  DC    C' '                    R14C01                           00005700
000CD7 004F                         333+R14C01L  DC    AL2(79)                                                  00005800
000CD9 4B4B4B4B4B4B4B4B             334+R14C01D  DC    CL79'...................................................*00005900
000CE1 4B4B4B4B4B4B4B4B                +               ............................'                            00006000
000D28 40                           335+R15C01C  DC    C' '                    R15C01                           00006100
000D29 004F                         336+R15C01L  DC    AL2(79)                                                  00006200
000D2B 4B4B4B4B4B4B4B4B             337+R15C01D  DC    CL79'...................................................*00006300
000D33 4B4B4B4B4B4B4B4B                +               ............................'                            00006400
000D7A 40                           338+R16C01C  DC    C' '                    R16C01                           00006500
000D7B 004F                         339+R16C01L  DC    AL2(79)                                                  00006600
000D7D 4B4B4B4B4B4B4B4B             340+R16C01D  DC    CL79'...................................................*00006700
000D85 4B4B4B4B4B4B4B4B                +               ............................'                            00006800
000DCC 40                           341+R17C01C  DC    C' '                    R17C01                           00006900
000DCD 004F                         342+R17C01L  DC    AL2(79)                                                  00007000
000DCF 4B4B4B4B4B4B4B4B             343+R17C01D  DC    CL79'...................................................*00007100
000DD7 4B4B4B4B4B4B4B4B                +               ............................'                            00007200
000E1E 40                           344+R18C01C  DC    C' '                    R18C01                           00007300
000E1F 004F                         345+R18C01L  DC    AL2(79)                                                  00007400
000E21 4B4B4B4B4B4B4B4B             346+R18C01D  DC    CL79'...................................................*00007500
000E29 4B4B4B4B4B4B4B4B                +               ............................'                            00007600
000E70 40                           347+R19C01C  DC    C' '                    R19C01                           00007700
000E71 004F                         348+R19C01L  DC    AL2(79)                                                  00007800
000E73 4B4B4B4B4B4B4B4B             349+R19C01D  DC    CL79'...................................................*00007900
000E7B 4B4B4B4B4B4B4B4B                +               ............................'                            00008000
000EC2 40                           350+R20C01C  DC    C' '                    R20C01                           00008100
000EC3 004F                         351+R20C01L  DC    AL2(79)                                                  00008200
000EC5 4B4B4B4B4B4B4B4B             352+R20C01D  DC    CL79'...................................................*00008300
000ECD 4B4B4B4B4B4B4B4B                +               ............................'                            00008400
000F14 40                           353+R21C01C  DC    C' '                    R21C01                           00008500
000F15 004F                         354+R21C01L  DC    AL2(79)                                                  00008600
000F17 4B4B4B4B4B4B4B4B             355+R21C01D  DC    CL79'...................................................*00008700
000F1F 4B4B4B4B4B4B4B4B                +               ............................'                            00008800
000F66 40                           356+R23C01C  DC    C' '                    R23C01                           00008900
000F67 004D                         357+R23C01L  DC    AL2(77)                                                  00009000
000F69 4B4B4B4B4B4B4B4B             358+R23C01D  DC    CL77'...................................................*00009100
000F71 4B4B4B4B4B4B4B4B                +               ..........................'                              00009200
000FB6 40                           359+R24C01C  DC    C' '                    R24C01                           00009300
000FB7 004F                         360+R24C01L  DC    AL2(79)                                                  00009400
000FB9 4B4B4B4B4B4B4B4B             361+R24C01D  DC    CL79'...................................................*00009500
000FC1 4B4B4B4B4B4B4B4B                +               ............................'                            00009600
001008 40                           362+         DC    C' '                                                     00009700
001009 0000                         363+         DC    AL2(0)                                                   00009800
                                                                                                               PAGE    9


  LOC  OBJECT CODE    ADDR1 ADDR2  STMT   SOURCE STATEMENT                                       ASM 0201 13.22 10/02/21

                                    364+** GENERATED BY MAP3270 V2.2.0   ON 211002 AT 132240920                 00009900
                                    365+*                                                                       02260000
00100C                              366+VPARMS   DS    0F                                                       02270000
00100C 00001020                     367+         DC    A(VFUNC)      FUNCTION CODE ADDR                         02280000
001010 00001024                     368+         DC    A(VOUTLN)     OUTPUT LINE ADDR                           02290000
001014 00001073                     369+         DC    A(VINLN)      INPUT LINE ADDR                            02300000
001018 000010C1                     370+         DC    A(VERRLN)     PROMPT/ERROR LINE (LINE 24) ADDR           02310000
00101C 80                           371+         DC    AL1(X'80')                                               02320000
00101D 001110                       372+         DC    AL3(VAID)     3270 AID CODE ADDR                         02330000
001020                              373+VFUNC    DS    CL4                                                      02340000
001024                              374+VOUTLN   DS    CL79                                                     02350000
001073                              375+VINLN    DS    CL78                                                     02360000
0010C1                              376+VERRLN   DS    CL79                                                     02370000
001110                              377+VAID     DS    C' '                                                     02380000
                            000F1   378+VPARMLN  EQU   *-VFUNC                                                  02390000
000000                              379+TTYPARMS DSECT                                                          02400000
000000                              380+TTYPFUNC DS    A             FUNCTION CODE ADDR                         02410000
000004                              381+TTYPLOUT DS    A             OUTPUT LINE ADDR                           02420000
000008                              382+TTYPLINP DS    A             INPUT LINE ADDR                            02430000
00000C                              383+TTYPERR  DS    A             PROMPT/ERROR LINE (LINE 24) ADDR           02440000
000010                              384+TTYPAID  DS    A             3270 AID CODE ADDR                         02450000
000000                              385          END   TTYRTNP                                                  01060000
                                                  RELOCATION DICTIONARY                                        PAGE   10


POS.ID   REL.ID   FLAGS   ADDRESS                                                                ASM 0201 13.22 10/02/21

 0001     0001      0C     00016C
 0001     0001      08     000171
 0001     0001      0C     0001E8
 0001     0001      08     0001ED
 0001     0001      0C     000218
 0001     0001      08     00021D
 0001     0001      0C     0002A0
 0001     0001      0C     0002A8
 0001     0001      0C     0002B0
 0001     0001      0C     0002B8
 0001     0001      0C     00100C
 0001     0001      0C     001010
 0001     0001      0C     001014
 0001     0001      0C     001018
 0001     0001      08     00101D
                                                  CROSS-REFERENCE                                              PAGE   11


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

BUFCLR   00004 000002B0 00244  00148
BUFFER   00079 000002C0 00250  00165 00239 00241 00245
BUFFERL  00079 0000089D 00251  00157 00172
BUFSCRL  00004 000002A0 00238  00153
EXIT     00001 0000020E 00200  00124
IDS0002  00001 00000040 00036  00060
ID10002  00004 00000000 00029  00036 00055
ID20002  00008 00000005 00031  00030
ID30002  00002 00000088 00038  00030
ID40002  00001 00000088 00055  00029
IHB0004A 00002 000000D2 00084  00078
IOCB     00004 00000280 00231  00134 00135 00135 00139 00179 00204 00209 00210 00210 00237
IOCBFUNC 00004 00000280 00232  00136 00147 00152 00201
IOCBLN   00001 00000020 00237  00135 00210
IOCLR    00001 0000017E 00146  00122
IOCOMM   00001 00000196 00154  00149
IORTN    00001 0000018C 00151  00116 00118 00120
LEAVE    00001 00000230 00211  00144 00196
LEAVE2   00004 00000244 00216  00213
MOVTXT   00001 000001C2 00166  00170
ONEPARM  00001 000000DA 00090  00074
R0       00001 00000000 00039  00112
R02C01D  00079 00000901 00298  00164
R1       00001 00000001 00040  00067 00096 00105 00106 00106 00138 00178 00203 00214 00215
R10      00001 0000000A 00049  00067 00068 00098 00099 00099 00100 00101 00102
R11      00001 0000000B 00050  00065 00066
R12      00001 0000000C 00051  00063 00064 00066
R14      00001 0000000E 00053  00143 00183 00208
R15      00001 0000000F 00054  00142 00143 00182 00183 00207 00208
R2       00001 00000002 00041  00148 00153 00155 00163 00170
R23C01C  00001 00000F66 00356  00176
R23C01D  00077 00000F69 00358  00159 00195 00195
R24C01D  00079 00000FB9 00361  00161
R3       00001 00000003 00042  00114 00115 00117 00119 00121 00123 00125 00152 00156 00157 00158 00159 00160 00161 00164
                               00167 00168 00168 00171 00172 00184 00185 00194 00195
R4       00001 00000004 00043  00155 00165 00167 00169 00169
R5       00001 00000005 00044  00148 00153
SKIPLD   00001 00000110 00113  00107
STRTIT   00001 00000156 00133  00126
TAID     00001 000008FA 00293  00185
TCAL0010 00004 00000174 00142  00138
TCAL0011 00004 000001F0 00182  00178
TCAL0012 00004 00000220 00207  00203
TPARM    00004 000008EC 00289  00141 00181 00206
TTYPAID  00004 00000010 00384  00184
TTYPARMS 00001 00000000 00379  00068
TTYPERR  00004 0000000C 00383  00160
TTYPFUNC 00004 00000000 00380  00073 00114
TTYPLINP 00004 00000008 00382  00158 00194
TTYPLOUT 00004 00000004 00381  00156 00171
TTYRTNP  00001 00000000 00027  00385
T3270ADR 00004 0000027C 00230  00105 00112 00142 00182 00207
T3270IO  00008 00000274 00229  00109
USERPARM 00004 00000254 00220  00096 00097 00098 00100 00212 00214
VAID     00001 00001110 00377  00372
                                                  CROSS-REFERENCE                                              PAGE   12


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

VERRLN   00079 000010C1 00376  00370
VFUNC    00004 00001020 00373  00101 00215 00367 00378
VINLN    00078 00001073 00375  00369
VOUTLN   00079 00001024 00374  00368
VPARMLN  00001 000000F1 00378  00101 00215
VPARMS   00004 0000100C 00366  00102
                                                  LITERAL CROSS-REFERENCE                                      PAGE   13


SYMBOL    LEN   VALUE   DEFN    REFERENCES                                                       ASM 0201 13.22 10/02/21

=C'IO  ' 00004 00000258 00222  00115
=C'PG  ' 00004 0000025C 00223  00117
=C'PUT ' 00004 00000260 00224  00119 00147
=C'CLR ' 00004 00000264 00225  00121
=C'END ' 00004 00000268 00226  00123 00201
=C'STRT' 00004 0000026C 00227  00125 00136
=4X'00'  00001 00000270 00228  00212
                                                  ASSEMBLER DIAGNOSTICS AND STATISTICS                         PAGE   14


                                                                                                 ASM 0201 13.22 10/02/21

NO STATEMENTS FLAGGED IN THIS ASSEMBLY
HIGHEST SEVERITY WAS    0
OPTIONS FOR THIS ASSEMBLY
  ALIGN, ALOGIC, BUFSIZE(STD), NODECK, ESD, FLAG(0), LINECOUNT(55), LIST, NOMCALL, YFLAG, WORKSIZE(2097152)
  NOMLOGIC, NONUMBER, OBJECT, NORENT, RLD, NOSTMT, NOLIBMAC, NOTERMINAL, NOTEST, XREF(SHORT)
  SYSPARM()
WORK FILE BUFFER SIZE/NUMBER = 8702/ 1
TOTAL RECORDS READ FROM SYSTEM INPUT          2
TOTAL RECORDS READ FROM SYSTEM LIBRARY     1764
TOTAL RECORDS PUNCHED                        79
TOTAL RECORDS PRINTED                       531

 F64-LEVEL LINKAGE EDITOR OPTIONS SPECIFIED XREF,LET,LIST
          DEFAULT OPTION(S) USED -  SIZE=(98304,55296)



                                                CROSS REFERENCE TABLE


  CONTROL SECTION                       ENTRY

    NAME    ORIGIN  LENGTH                NAME   LOCATION     NAME   LOCATION     NAME   LOCATION     NAME   LOCATION
  TTYRTNP       00    1111




  LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION             LOCATION  REFERS TO SYMBOL  IN CONTROL SECTION

 ENTRY ADDRESS       00

 TOTAL LENGTH      1118
****TTYRTNP   NOW REPLACED IN DATA SET
AUTHORIZATION CODE IS         0.
                  CCCCCCCCCC   OOOOOOOOOOOO  MM        MM  PPPPPPPPPPP    IIIIIIIIII   LL            EEEEEEEEEEEE       11
                CCCCCCCCCCCC  OOOOOOOOOOOO  MMM      MMM  PPPPPPPPPPPP   IIIIIIIIII   LL            EEEEEEEEEEEE      111
               CC        CC  OO        OO  MMMM    MMMM  PP        PP       II       LL            EE               1111
              CC            OO        OO  MM MM  MM MM  PP        PP       II       LL            EE                 11
             CC            OO        OO  MM  MMMM  MM  PP        PP       II       LL            EE                 11
            CC            OO        OO  MM   MM   MM  PPPPPPPPPPPP       II       LL            EEEEEEEE           11
           CC            OO        OO  MM        MM  PPPPPPPPPPP        II       LL            EEEEEEEE           11
          CC            OO        OO  MM        MM  PP                 II       LL            EE                 11
         CC            OO        OO  MM        MM  PP                 II       LL            EE                 11
        CC        CC  OO        OO  MM        MM  PP                 II       LL            EE                 11
       CCCCCCCCCCCC  OOOOOOOOOOOO  MM        MM  PP             IIIIIIIIII   LLLLLLLLLLLL  EEEEEEEEEEEE   1111111111
       CCCCCCCCCC   OOOOOOOOOOOO  MM        MM  PP             IIIIIIIIII   LLLLLLLLLLLL  EEEEEEEEEEEE   1111111111



                    JJJJJJJJJJ  555555555555    00000000     8888888888   555555555555                 AAAAAAAAAA
                    JJJJJJJJJJ  555555555555   0000000000   888888888888  555555555555                AAAAAAAAAAAA
                        JJ      55            00      0000  88        88  55                          AA        AA
                        JJ      55            00     00 00  88        88  55                          AA        AA
                        JJ      55            00    00  00   88      88   55                          AA        AA
                        JJ      555555555     00   00   00    88888888    555555555                   AAAAAAAAAAAA
                        JJ      5555555555    00  00    00    88888888    5555555555                  AAAAAAAAAAAA
                        JJ               55   00 00     00   88      88            55                 AA        AA
                  JJ    JJ                55  0000      00  88        88            55                AA        AA
                  JJ    JJ                55  000       00  88        88            55                AA        AA
                  JJJJJJJJ      555555555555   0000000000   888888888888  555555555555                AA        AA
                   JJJJJJ       55555555555     00000000     8888888888   55555555555                 AA        AA


****A   END   JOB 5085  COMPILE1                        ROOM        1.22.51 PM 02 OCT 21  PRINTER1  SYS BSP1  JOB 5085   END   A****
****A   END   JOB 5085  COMPILE1                        ROOM        1.22.51 PM 02 OCT 21  PRINTER1  SYS BSP1  JOB 5085   END   A****
****A   END   JOB 5085  COMPILE1                        ROOM        1.22.51 PM 02 OCT 21  PRINTER1  SYS BSP1  JOB 5085   END   A****
****A   END   JOB 5085  COMPILE1                        ROOM        1.22.51 PM 02 OCT 21  PRINTER1  SYS BSP1  JOB 5085   END   A****
